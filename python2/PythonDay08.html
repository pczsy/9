<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修PythonDay08' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>PythonDay08</center></div><div class='banquan'>原文出处:本文由博客园博主徐佳成提供。<br/>
原文连接:https://www.cnblogs.com/xuyuwei/p/11342285.html</div><br>
    <h2 class="md-end-block md-heading"><span class="md-plain md-expand">第八章</span></h2>
<h3 class="md-end-block md-heading"><span class="md-plain">今日内容</span></h3>
<p class="md-end-block md-p"><span class="md-plain">文件操作</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item md-focus-container">
<p class="md-end-block md-p md-focus"><span class="md-plain md-expand">读操作</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">写操作</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">+操作</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">其他操作</span></p>
</li>
</ul>
<h4 class="md-end-block md-heading"><span class="md-plain">读操作</span></h4>
<pre><code><span>r模式<br /><span>f = open('test.txt', mode='r', encoding='utf-8')<br /><span>print(f.read())<br /><span>f.close()<br /><span><span>​<br /><span>with open('test.txt', 'r', encoding='utf-8')as f:<br /><span><span class="cm-tab">    print(f.read())<br /><span class="cm-tab-wrap-hack"><span class="cm-tab">    <br /><span># 两种方式获得文件句柄，推荐with，运行完之后自动关闭文件</span></span></span></span></span></span></span></span></span></span></span></span></pre>
<pre><code><span>rb模式<br /><span>with open('test.txt', 'rb', encoding='utf-8')as f:<br /><span><span class="cm-tab">    print(f.read())<br /><span># 读出来的是字节</span></span></span></span></span></pre>
<p class="md-end-block md-p"><span class="md-plain">建议使用相对路径</span></p>
<p class="md-end-block md-p"><span class="md-plain">读操作</span></p>
<pre><code><span>f.read()<span class="cm-tab">    <span class="cm-tab">    <span class="cm-tab">    <span class="cm-tab">    # 不建议用<br /><span>f.read(读取的字符数)<br /><span>f.readline()<span class="cm-tab">    # 每次读取一行，每行最后有一个\n<br /><span>f.readlines()  # 将每一行形成一个元素，并添加到一个列表中，当文件过大时，内存会崩<br /><span>推荐使用，先拿到文件句柄<br /><span>with open('1','r',encoding='utf-8')as f:<br /><span><span class="cm-tab">    for i in f:<br /><span><span class="cm-tab">    <span class="cm-tab">    print(i)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<h4 class="md-end-block md-heading"><span class="md-plain">写操作</span></h4>
<pre><code><span>使用w模式的时候,在打开文件的时候就就会把文件中的所有内容都清空,然后在操作<br /><span>如果文件不存在使用w模式会创建文件,文件存在w模式是覆盖写,在打开文件时会把文件中所有的内容清空.<br /><span>f.write()<br /><span><span>​<br /><span>wb模式下,不可以指定打开文件的编辑,但是写文件的时候必须将字符串转换成utf-8的bytes数据</span></span></span></span></span></span></pre>
<h4 class="md-end-block md-heading"><span class="md-plain">追加</span></h4>
<pre><code><span>只要是a或者ab,a+都是在文件的末尾写入,不论光标在任何位置.<br /><span>在追加模式下,我们写入的内容后追加在文件的末尾<br /><span>a模式如果文件不存在就会创建一个新文件<br /><span>ab模式和上面一样，没有太大区别</span></span></span></span></pre>
<pre><code><span># 面试题:<br /><span># 当文件较大时,使用for循环进行读取<br /><span># f = open('t1',mode="r",encoding="utf-8")<br /><span># for i in f:<br /><span># &nbsp; &nbsp; print(i.strip())</span></span></span></span></span></pre>
<h4 class="md-end-block md-heading"><span class="md-plain">r+模式</span></h4>
<p class="md-end-block md-p"><span class="md-plain">r+模式一定要记住是先读后写</span></p>
<pre><code><span>f1 = open('test.txt',mode='r+',encoding='utf-8')<br /><span>msg = f1.read()<br /><span>f1.write('千山鸟飞绝，万径人踪灭')<br /><span>f1.flush()<br /><span>f1.close()<br /><span>print(msg)<br /><span>结果:<br /><span>正常的读取之后,写在结尾</span></span></span></span></span></span></span></span></pre>
<p class="md-end-block md-p"><span><code>深坑请注意: 在r+模式下. 如果读取了内容. 不论读取内容多少. 光标显示的是多少. 再写入 或者操作文件的时候都是在结尾进行的操作.</code></span></p>
<h4 class="md-end-block md-heading"><span class="md-plain">w+模式</span></h4>
<p class="md-end-block md-p"><span><code>先将所有的内容清空,然后写入.最后读取.但是读取的内容是空的,不常用</code></span></p>
<h4 class="md-end-block md-heading"><span class="md-plain">a+模式</span></h4>
<pre><code><span>a+模式下,不论是先读还是后读,都是读不到数据的</span></pre>
<h4 class="md-end-block md-heading"><span class="md-plain">其他操作</span></h4>
<pre class="md-fences mock-cm md-end-block">seek()
seek(n)光标移动到n位置,注意: 移动单位是byte,所有如果是utf-8的中文部分要是3的倍数
通常我们使用seek都是移动到开头或者结尾
移动到开头:seek(0,0) 可以看做成seek(0)
seek(6)这种如果是单数并且不是0的就是按照字节来移动光标
移动到结尾:seek(0,2) seek的第二个参数表示的是从哪个位置进行偏移,默认是0,表示开头,1表示当前位置,2表示结尾
</pre>
<pre class="md-fences mock-cm md-end-block">tell()
使用tell()可以帮我们获取当前光标在什么位置
</pre>
<h4 class="md-end-block md-heading"><span class="md-plain">文件修改</span></h4>
<p class="md-end-block md-p"><span><code>文件修改: 只能将文件中的内容读取到内存中, 将信息修改完毕, 然后将源文件删除, 将新文件的名字改成老文件的名字</code></span></p>
<pre class="md-fences mock-cm md-end-block">错误示范，使用read，当文件内容过大，会导致内存溢出
import os
with open("../path1/小娃娃", mode="r", encoding="utf-8") as f1,\
open("../path1/小娃娃_new", mode="w", encoding="UTF-8") as f2:
    content = f1.read()
    new_content = content.replace("冰糖葫芦", "⼤白梨")
    f2.write(new_content)
os.remove("../path1/小娃娃") # 删除源文件
os.rename("../path1/小娃娃_new", "小娃娃") # 重命名新文件
弊端: ⼀次将所有内容进行读取. 内存溢出. 解决方案: 一行一行的读取和操作

正确代码：
import os
with open("小娃娃", mode="r", encoding="utf-8") as f1,\
open("小娃娃_new", mode="w", encoding="UTF-8") as f2:
    for line in f1:
        new_line = line.replace("大白梨", "冰糖葫芦")
        f2.write(new_line)
os.remove("小娃娃") # 删除源⽂文件
os.rename("小娃娃_new", "小娃娃") # 重命名新文件
</pre>
<p>&nbsp;</p>
<p class="md-end-block md-p">&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>