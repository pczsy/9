<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修python pywin32学习笔记' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>python pywin32学习笔记</center></div><div class='banquan'>原文出处:本文由博客园博主零度热冰提供。<br/>
原文连接:https://www.cnblogs.com/lingdurebing/p/11602461.html</div><br>
    <p><span style="font-size: 18px;">参考博客链接</span></p>
<p><a href="https://blog.csdn.net/polyhedronx/article/details/81988948">https://blog.csdn.net/polyhedronx/article/details/81988948</a></p>
<p><span style="font-size: 18px;">参考博客链接</span></p>
<p><a href="https://www.cnblogs.com/zhaobl/p/3326332.html">https://www.cnblogs.com/zhaobl/p/3326332.html</a></p>
<p>&nbsp;</p>
<div class="cnblogs_Highlighter">
<pre><code>pyhandle=win32gui.FindWindow(classname,text)</pre>
</div>
<pre><code><span style="font-size: 16px;">　　pyhandle windows窗体句柄，int 类型</span><br /><span style="font-size: 16px;">　　className 窗体类名</span><br /><span style="font-size: 16px;">　　text 窗体标题</span><br /><br /></pre>
<div class="cnblogs_Highlighter">
<pre><code>win32gui.SetForegroundWindow(pyhandle)
win32gui.ShowWindow(pyhandle, win32con.SW_MAXIMIZE)</pre>
</div>
<pre><code>　　<span style="font-family: 宋体;">窗体置顶</span><br /><span style="font-family: 宋体;">　　窗体最大化</span><br /><br /></pre>
<div class="cnblogs_Highlighter">
<pre><code>handle=win32gui.FindWindowEx(pyhandle,None,'Edit',None)</pre>
</div>
<p><span style="font-size: 16px;">　<span style="font-family: 宋体;">　通过父pyhandle窗体句柄找到第一个子窗体或控件</span></span></p>
<p><span style="font-size: 16px; font-family: 宋体;">　　函数原型</span></p>
<p><span style="font-size: 16px; font-family: 宋体;">　　pyHandle=FindWindowEx(<em>Parent</em><em>, ChildAfter</em> <em>, ClassName</em> <em>, WindowName</em>)</span></p>
<p><span style="font-size: 16px; font-family: 宋体;">　　ChildAfer int类型，为0表示搜索所有</span></p>
<p>&nbsp;</p>
<div class="cnblogs_Highlighter">
<pre><code>win32gui.SendMessage(handle, win32con.WM_GETTEXTLENGTH) #向句柄为handle的窗体发送消息得到文本内容大小，阻塞式</pre>
</div>
<p><span style="font-size: 16px;">　　<span style="font-family: 宋体;">函数原型</span></span></p>
<p><span style="font-size: 16px; font-family: 宋体;">　　int = SendMessage(hwnd, message , wparam , lparam )</span></p>
<p><span style="font-size: 16px; font-family: 宋体;">　　具体内容请查看windows api</span></p>
<p>&nbsp;</p>
<div class="cnblogs_Highlighter">
<pre><code>buffer = win32gui.PyMakeBuffer(len)　</pre>
</div>
<pre><code><span style="font-size: 16px;">　　<span style="font-family: 宋体;">得到长度为len的缓冲区类型</span></span><br /><br /></pre>
<div class="cnblogs_Highlighter">
<pre><code>win32gui.SendMessage(edit_handle, win32con.WM_GETTEXT, len, buffer)  # 读取文本
</pre>
</div>
<p><span style="font-size: 16px;">　　<span style="font-family: 宋体;">　读取控件的文本内容</span></span></p>
<p>&nbsp;</p>
<div class="cnblogs_Highlighter">
<pre><code>address, length = win32gui.PyGetBufferAddressAndLen(buffer)
</pre>
</div>
<p><span style="font-size: 16px;">　　　<span style="font-family: 宋体;">通过buffer得到地址和字符串长度</span></span></p>
<p>&nbsp;</p>
<div class="cnblogs_Highlighter">
<pre><code>text = win32gui.PyGetString(address, length)
</pre>
</div>
<p><span style="font-size: 16px;">　　　<span style="font-family: 宋体;">通过地址和字符串长度得到文本内容</span></span></p>
<p>&nbsp;</p>
<div class="cnblogs_Highlighter">
<pre><code>left,top,right,bottom=win32gui.GetClientRect(pyhandle)
</pre>
</div>
<p>　　　<span style="font-size: 16px; font-family: 宋体;">得到窗体的左，顶，右 ，底的坐标</span></p>
<p>&nbsp;</p>
<div class="cnblogs_Highlighter">
<pre><code>import win32gui<br />win32api.keybd_event(key, 0, 0, 0)
</pre>
</div>
<p>　　　<span style="font-size: 16px; font-family: 宋体;">发送键盘消息，key为键值</span></p>
<p>&nbsp;</p>
<div class="cnblogs_Highlighter">
<pre><code>import win32api<br /> win32api.SetCursorPos([width, height])
</pre>
</div>
<p>　　　<span style="font-size: 16px; font-family: 宋体;">设置鼠标在屏幕中的坐标</span></p>
<p>&nbsp;</p>
<div class="cnblogs_Highlighter">
<pre><code>import win32api,win32con<br />win32api.mouse_event(win32con.MOUSEEVENTF_LEFTUP | win32con.MOUSEEVENTF_LEFTDOWN, 0, 0, 0, 0)
</pre>
</div>
<p>　　　<span style="font-size: 16px; font-family: 宋体;">鼠标左键单击</span></p>
<p>&nbsp;</p>
<div class="cnblogs_Highlighter">
<pre><code>import win32api,win32con<br />win32api.mouse_event(win32con.MOUSEEVENTF_LEFTUP | win32con.MOUSEEVENTF_LEFTDOWN, 0, 0, 0, 0)
</pre>
</div>
<p><span style="font-size: 16px;">　　　<span style="font-family: 宋体;">鼠标右键单击</span></span></p>
<p>&nbsp;</p>
<div class="cnblogs_Highlighter">
<pre><code>import win32gui<br />hwndChildList = []
win32gui.EnumChildWindows(parent, lambda hwnd, param: param.append(hwnd),  hwndChildList)　　</pre>
</div>
<p>&nbsp; &nbsp;　　<span style="font-size: 16px; font-family: 宋体;"> 得到parent窗体下所有的窗体和控件句柄</span></p>
<p>&nbsp;</p>
<div class="cnblogs_Highlighter">
<pre><code>import win32api,win32con<br />win32api.keybd_event(key, 0, win32con.KEYEVENTF_KEYUP, 0)
</pre>
</div>
<p><span style="font-size: 16px;">　　　<span style="font-family: 宋体;">key int类型，让按下的键抬起来</span></span></p>
<p>&nbsp;</p>
<div class="cnblogs_Highlighter">
<pre><code> import win32gui,win32con<br /> win32gui.SendMessage(handle,win32con.WM_SETTEXT,0,text)
            
</pre>
</div>
<p>　　　<span style="font-size: 16px; font-family: 宋体;">设置控件文本内容</span></p>
<p>&nbsp;</p>
<div class="cnblogs_Highlighter">
<pre><code>import win32gui<br />win32gui.GetDlgItemText(pyhandle,dlgItemId)
</pre>
</div>
<p><span style="font-size: 16px;">　　　<span style="font-family: 宋体;">通过窗体句柄和控件id得到控件的text</span></span></p>
<p><span style="font-size: 16px; font-family: 宋体;">&nbsp; 　 控件的id可以通过spy++或者AutoIt windows info获取</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<div class="cnblogs_Highlighter">
<pre><code>import win32console,win32gui<br />cmd_win=win32console.GetConsoleWindow()
if cmd_win&gt;0:
    win32gui.ShowWindow(cmd_win,0) #windows下隐藏python程序运行的黑窗口，cmd命令行窗口
</pre>
</div>
<p>&nbsp;</p>
<p>　　</p>
<p><span style="font-family: 宋体;"><span style="font-size: 16px;">&nbsp;</span></span></p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>