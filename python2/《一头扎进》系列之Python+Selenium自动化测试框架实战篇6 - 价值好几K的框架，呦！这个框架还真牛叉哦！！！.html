<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修《一头扎进》系列之Python+Selenium自动化测试框架实战篇6 - 价值好几K的框架，呦！这个框架还真牛叉哦！！！' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>《一头扎进》系列之Python+Selenium自动化测试框架实战篇6 - 价值好几K的框架，呦！这个框架还真牛叉哦！！！</center></div><div class='banquan'>原文出处:本文由博客园博主北京-宏哥提供。<br/>
原文连接:https://www.cnblogs.com/du-hong/p/12089570.html</div><br>
    <h3>1. 简介</h3>
<p>　　本文开始介绍如何通过unittest来管理和执行测试用例，这一篇主要是介绍unittest下addTest()方法来加载测试用例到测试套件中去、用addTest()方法来加载我们测试用例到suite中去和利用discover（）方法去加载一个路径下所有的测试用例。</p>
<h3>2.&nbsp;addTest()方法</h3>
<p>　　这里首先介绍unittest下addTest()方法来加载测试用例到测试套件中去。为了演示效果，我在前面文章的脚本基础上，新建了一个测试脚本，这个测试脚本有一个测试用例，加上前面的测试脚本，一共就是三个测试用例，前面那个测试类里面包括两个测试用例。</p>
<p>新建的测试脚本，test_get_page_title.py代码如下：</p>
<h4>2.1 代码实现：</h4>
<p><img src="./images/《一头扎进》系列之Python+Selenium自动化测试框架实战篇6 - 价值好几K的框架，呦！这个框架还真牛叉哦！！！0.png" alt="" /></p>
<h4>2.2 参考代码：</h4>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> -*- coding:utf-8 -*-</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 1.先设置编码，utf-8可支持中英文，如上，一般放在第一行</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 2.注释：包括记录创建时间，创建人，项目名称。</span>
<span style="color: #800000;">'''</span><span style="color: #800000;">
Created on 2019-12-24
@author: 北京-宏哥   QQ交流群：705269076
Project: 《《一头扎进》系列之Python+Selenium框架设计篇5- 价值好几K的框架，呦！这个框架还真牛叉哦！！！
</span><span style="color: #800000;">'''</span>
<span style="color: #008000;">#</span><span style="color: #008000;"> 3.导入模块</span>
<span style="color: #0000ff;">import</span><span style="color: #000000;"> unittest

</span><span style="color: #0000ff;">from</span> automation_framework_demo.framework.browser_engine <span style="color: #0000ff;">import</span><span style="color: #000000;"> BrowserEngine
</span><span style="color: #0000ff;">from</span> automation_framework_demo.pageobjects.baidu_homepage <span style="color: #0000ff;">import</span><span style="color: #000000;"> HomePage


</span><span style="color: #0000ff;">class</span><span style="color: #000000;"> GetPageTitle(unittest.TestCase):

    @classmethod
    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> setUpClass(cls):
        browser </span>=<span style="color: #000000;"> BrowserEngine(cls)
        cls.driver </span>=<span style="color: #000000;"> browser.open_browser(cls)

    @classmethod
    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> tearDownClass(cls):
        cls.driver.quit()

    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> test_get_title(self):
        homepage </span>=<span style="color: #000000;"> HomePage(self.driver)
        </span><span style="color: #0000ff;">print</span>(homepage.get_page_title())</pre>
</div>
<h4>2.3 运行结果：</h4>
<p>运行代码后，控制台打印如下图的结果</p>
<p><img src="./images/《一头扎进》系列之Python+Selenium自动化测试框架实战篇6 - 价值好几K的框架，呦！这个框架还真牛叉哦！！！1.png" alt="" /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 今天来学习下，如果加载这两个测试类文件里面的3个测试脚本。在unittest下有一个管理测试套件的叫TestSuit(),我们要使用这个测试套件，需要先初始化一个suite实例，然后这个实例有一个addTest()的方法，可以加载不同类里面的不同测试函数，格式这样的 addTest(测试类的类名（&lsquo;测试函数名称，就是test开头的函数&rsquo;）)，我们在testsuites这个包下新建一个TestRunner.py文件用来管理我们的用例启动方式。<br />来看看这个TestRunner.py的内容</p>
<h4>2.4 代码实现：</h4>
<p><img src="./images/《一头扎进》系列之Python+Selenium自动化测试框架实战篇6 - 价值好几K的框架，呦！这个框架还真牛叉哦！！！2.png" alt="" /></p>
<h4>2.5 参考代码：</h4>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> -*- coding:utf-8 -*-</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 1.先设置编码，utf-8可支持中英文，如上，一般放在第一行</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 2.注释：包括记录创建时间，创建人，项目名称。</span>
<span style="color: #800000;">'''</span><span style="color: #800000;">
Created on 2019-12-24
@author: 北京-宏哥   QQ交流群：705269076
Project: 《《一头扎进》系列之Python+Selenium框架设计篇5- 价值好几K的框架，呦！这个框架还真牛叉哦！！！
</span><span style="color: #800000;">'''</span>
<span style="color: #008000;">#</span><span style="color: #008000;"> 3.导入模块</span>
<span style="color: #0000ff;">import</span><span style="color: #000000;"> unittest
</span><span style="color: #008000;">#</span><span style="color: #008000;">from automation_framework_demo.testsuits import testsuits</span>
<span style="color: #0000ff;">from</span> automation_framework_demo.testsuits.baidu_search2 <span style="color: #0000ff;">import</span><span style="color: #000000;"> BaiduSearch
</span><span style="color: #0000ff;">from</span> automation_framework_demo.testsuits.test_get_page_title <span style="color: #0000ff;">import</span><span style="color: #000000;"> GetPageTitle

suite </span>=<span style="color: #000000;"> unittest.TestSuite()
suite.addTest(BaiduSearch(</span><span style="color: #800000;">'</span><span style="color: #800000;">test_baidu_search</span><span style="color: #800000;">'</span><span style="color: #000000;">))
suite.addTest(BaiduSearch(</span><span style="color: #800000;">'</span><span style="color: #800000;">test_search2</span><span style="color: #800000;">'</span><span style="color: #000000;">))
suite.addTest(GetPageTitle(</span><span style="color: #800000;">'</span><span style="color: #800000;">test_get_title</span><span style="color: #800000;">'</span><span style="color: #000000;">))

</span><span style="color: #0000ff;">if</span> <span style="color: #800080;">__name__</span> == <span style="color: #800000;">'</span><span style="color: #800000;">__main__</span><span style="color: #800000;">'</span><span style="color: #000000;">:
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 执行用例</span>
    runner =<span style="color: #000000;"> unittest.TextTestRunner()
    runner.run(suite)</span></pre>
</div>
<h4>2.6 运行结果：</h4>
<p>运行代码后，控制台打印如下图的结果</p>
<p><img src="./images/《一头扎进》系列之Python+Selenium自动化测试框架实战篇6 - 价值好几K的框架，呦！这个框架还真牛叉哦！！！3.png" alt="" /></p>
<p>这个方法有没有局限性呢？当然有，加入你有几百个测试类，你是不是也一直这样手动去添加？有没有其他更好的方法去加载我们的测试脚本，关于这个问题，请紧跟宏哥的脚步继续往下看、往下走。</p>
<h3 class="title-article">3. makeSuite()方法</h3>
<p>前面文章介绍了如何用addTest()方法来加载我们测试用例到suite中去，本文介绍利用makeSuite()方法，一次性加载一个类文件下所有测试用例到suite中去。还是利用前面一篇文章中的测试脚本，来看看TestRunner.py如何写。</p>
<h4>3.1 代码实现：</h4>
<p><img src="./images/《一头扎进》系列之Python+Selenium自动化测试框架实战篇6 - 价值好几K的框架，呦！这个框架还真牛叉哦！！！4.png" alt="" /></p>
<h4>3.2 参考代码：</h4>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> -*- coding:utf-8 -*-</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 1.先设置编码，utf-8可支持中英文，如上，一般放在第一行</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 2.注释：包括记录创建时间，创建人，项目名称。</span>
<span style="color: #800000;">'''</span><span style="color: #800000;">
Created on 2019-12-24
@author: 北京-宏哥   QQ交流群：705269076
Project: 《《一头扎进》系列之Python+Selenium框架设计篇5- 价值好几K的框架，呦！这个框架还真牛叉哦！！！
</span><span style="color: #800000;">'''</span>
<span style="color: #008000;">#</span><span style="color: #008000;"> 3.导入模块</span>
<span style="color: #0000ff;">import</span><span style="color: #000000;"> unittest
</span><span style="color: #008000;">#</span><span style="color: #008000;">from automation_framework_demo.testsuits import testsuits</span>
<span style="color: #0000ff;">from</span> automation_framework_demo.testsuits.baidu_search2 <span style="color: #0000ff;">import</span><span style="color: #000000;"> BaiduSearch
</span><span style="color: #0000ff;">from</span> automation_framework_demo.testsuits.test_get_page_title <span style="color: #0000ff;">import</span><span style="color: #000000;"> GetPageTitle

</span><span style="color: #800000;">'''</span><span style="color: #800000;">
suite = unittest.TestSuite()
suite.addTest(BaiduSearch('test_baidu_search'))
suite.addTest(BaiduSearch('test_search2'))
suite.addTest(GetPageTitle('test_get_title'))
</span><span style="color: #800000;">'''</span><span style="color: #000000;">
suite </span>=<span style="color: #000000;">unittest.TestSuite(unittest.makeSuite(BaiduSearch))

</span><span style="color: #0000ff;">if</span> <span style="color: #800080;">__name__</span> == <span style="color: #800000;">'</span><span style="color: #800000;">__main__</span><span style="color: #800000;">'</span><span style="color: #000000;">:
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 执行用例</span>
    runner =<span style="color: #000000;"> unittest.TextTestRunner()
    runner.run(suite)</span></pre>
</div>
<h4>3.3 运行结果：</h4>
<p>运行代码后，控制台打印如下图的结果</p>
<p><img src="./images/《一头扎进》系列之Python+Selenium自动化测试框架实战篇6 - 价值好几K的框架，呦！这个框架还真牛叉哦！！！5.png" alt="" /></p>
<p>缺陷: makeSuite()方法虽然比前面文章的addTest()方法有了一定的效率提升，在添加测试用例到测试套件过程。但是这个方法也有很多缺点，我不可能把所有项目脚本都放一个测试类文件吧。在unittest中还是有很多方法可以用来添加测试用例到suite中，makeSuite（类名称），只是一种，你可以多看看unittest的文档介绍。接下来我们介绍如何一次性加载一个文件目录下所有测试用例。</p>
<h3 class="title-article">4. discover()方法</h3>
<p>　　继续接着介绍，如何利用unittest管理和执行测试用例的问题，这里我们还是利用之前已经有的三条测试用例，如果你跳过了前面文章，请回到框架设计篇的第八篇和第七篇，里面有相关测试类的文件。本文来介绍，如果利用discover（）方法去加载一个路径下所有的测试用例。这个方法是不是太适合我们现在的需求，例如我只需要跑testsuite包下所有测试用例，不管在里面有多少个包和多少个测试类，只需要用discover()搞定，来看看这个场景下TestRunner.py如何写。</p>
<h4>4.1 代码实现：</h4>
<p><img src="./images/《一头扎进》系列之Python+Selenium自动化测试框架实战篇6 - 价值好几K的框架，呦！这个框架还真牛叉哦！！！6.png" alt="" /></p>
<h4>4.2 参考代码：</h4>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> -*- coding:utf-8 -*-</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 1.先设置编码，utf-8可支持中英文，如上，一般放在第一行</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 2.注释：包括记录创建时间，创建人，项目名称。</span>
<span style="color: #800000;">'''</span><span style="color: #800000;">
Created on 2019-12-24
@author: 北京-宏哥   QQ交流群：705269076
Project: 《《一头扎进》系列之Python+Selenium框架设计篇5- 价值好几K的框架，呦！这个框架还真牛叉哦！！！
</span><span style="color: #800000;">'''</span>
<span style="color: #008000;">#</span><span style="color: #008000;"> 3.导入模块</span>
<span style="color: #0000ff;">import</span><span style="color: #000000;"> unittest

suite </span>= unittest.TestLoader().discover(<span style="color: #800000;">"</span><span style="color: #800000;">testsuits</span><span style="color: #800000;">"</span><span style="color: #000000;">)


</span><span style="color: #0000ff;">if</span> <span style="color: #800080;">__name__</span> == <span style="color: #800000;">'</span><span style="color: #800000;">__main__</span><span style="color: #800000;">'</span><span style="color: #000000;">:
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 执行用例</span>
    runner =<span style="color: #000000;"> unittest.TextTestRunner()
    runner.run(suite)</span></pre>
</div>
<h4>4.3 运行结果：</h4>
<p>运行代码后，控制台打印如下图的结果</p>
<p><img src="./images/《一头扎进》系列之Python+Selenium自动化测试框架实战篇6 - 价值好几K的框架，呦！这个框架还真牛叉哦！！！5.png" alt="" /></p>
<p>上面的testsuits是可以包名，也可以是一个文件夹名称，在实际脚本开发过程中，最后都采用这个方法来批量管理和执行几百上千的测试用例。下一篇内容，大概会介绍如何利用HTMLTestRunner.py这个开源的插件，生成测试报告，这个测试报告是一个HTML的格式。介绍完了生成报告文章，框架设计系列教程就会结束，不打算过多介绍其他技能点。</p>
<h3>5. 小结</h3>
<h4 class="postTitle">5.1 报错提示：ImportError: Start directory is not importable: 'D:\\PyCharm-Workspace\\testcases'</h4>
<div class="postBody">
<div id="cnblogs_post_body" class="blogpost-body ">
<p><img src="./images/《一头扎进》系列之Python+Selenium自动化测试框架实战篇6 - 价值好几K的框架，呦！这个框架还真牛叉哦！！！8.png" alt="" width="478" height="192" /></p>
<p>以下两种路径实现代码存放在path.py中，查看区别：</p>
<div class="cnblogs_code">
<pre><code>base_dir = os.path.dirname(os.getcwd())       # 第一种，当前目录<br /># os.getcwd()  定位路径为common<br /># os.path.dirname(os.getcwd())   定位路径为API_work</pre>
</div>
<div class="cnblogs_code">
<pre><code>base_dir = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))    # 第二种，该代码存放的根目录<br /># os.path.abspath(__file__)   定位路径为path.py<br /># os.path.dirname(os.path.abspath(__file__))    定位路径为common<br /># os.path.dirname(os.path.dirname(os.path.abspath(__file__)))  定位路径为API_work</pre>
</div>
<p>&nbsp;以上两种方式，在path.py中执行，print输出均为：</p>
<p><img src="./images/《一头扎进》系列之Python+Selenium自动化测试框架实战篇6 - 价值好几K的框架，呦！这个框架还真牛叉哦！！！9.png" alt="" width="702" height="121" /></p>
<p>&nbsp;但第一种方式，在run.py中调用path.py中的base_dir属性，查找 "test_*.py"&nbsp;的根目录就会出现下以报错：</p>
<p><img src="./images/《一头扎进》系列之Python+Selenium自动化测试框架实战篇6 - 价值好几K的框架，呦！这个框架还真牛叉哦！！！10.png" alt="" width="706" height="187" /></p>
<p><strong>&nbsp;原因：</strong></p>
<p>1、在run.py中调用path.py&nbsp;中的&nbsp;os.getcwd()&nbsp;代码&nbsp;，就是定位 run.py&nbsp;的根目录；</p>
<p>即：</p>
<p>&nbsp; &nbsp; &nbsp; os.getcwd()&nbsp; &nbsp;定位路径为API_work</p>
<p>&nbsp; &nbsp; &nbsp; os.path.dirname(os.getcwd())&nbsp; &nbsp;定位路径为API_work的上一层目录，因找不到上一层目录，所以报错；</p>
<p>2、在run.py中调用第二种方式，是查找path.py的根目录，所以可执行正常；</p>
<p><strong>总结：</strong></p>
<p><strong>　　其他模块会调用固定路径时，不要使用&nbsp;os.getcwd()&nbsp;当前定位方式来实现；使用&nbsp;os.path.abspath(__file__)&nbsp;实现。</strong></p>
</div>
</div>
<p>好了，今天的分享就到这里吧！！！谢谢各位的耐心阅读。有问题加群交流讨论</p>
<p>&nbsp;</p>
<p style="text-align: center;"><span style="font-size: 14pt;">您的肯定就是我进步的动力。如果你感觉还不错，就请鼓励一下吧！记得随手点波<strong>&nbsp;<span style="color: #ff0000;">&nbsp;<span style="font-size: 18pt;">推荐</span></span>&nbsp;&nbsp;</strong>不要忘记哦！！！</span></p>
<p style="text-align: center;"><span style="font-size: 14pt;">别忘了点&nbsp;<strong><span style="font-size: 18pt; color: #99cc00;">推荐</span>&nbsp;</strong>留下您来过的痕迹</span></p>
<p style="text-align: center;"><span style="font-size: 14pt;">&nbsp;</span></p>
<p><span style="font-size: 14pt;"><img style="display: block; margin-left: auto; margin-right: auto;" src="./images/《一头扎进》系列之Python+Selenium自动化测试框架实战篇6 - 价值好几K的框架，呦！这个框架还真牛叉哦！！！11.png" alt="" /></span></p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>