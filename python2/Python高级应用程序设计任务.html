<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修Python高级应用程序设计任务' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>Python高级应用程序设计任务</center></div><div class='banquan'>原文出处:本文由博客园博主wangjiaping提供。<br/>
原文连接:https://www.cnblogs.com/wangjiaping/p/12076949.html</div><br>
    <h1>Python高级应用程序设计任务要求</h1>
<h3><br />用Python实现一个面向主题的网络爬虫程序，并完成以下内容：<br />（注：每人一题，主题内容自选，所有设计内容与源代码需提交到博客园平台）</h3>
<div>一、主题式网络爬虫设计方案（15分）</div>
<div>1.主题式网络爬虫名称</div>
<div>&nbsp;</div>
<div>名称：爬取携程网站泉州地区酒店信息</div>
<div><br />2.主题式网络爬虫爬取的内容与数据特征分析</div>
<div>&nbsp;</div>
<div>本次爬虫主要爬取携程网站泉州地区酒店名称与地址和酒店评分</div>
<div><br />3.主题式网络爬虫设计方案概述（包括实现思路与技术难点）</div>
<div>&nbsp;</div>
<div>实现思路：本次设计方案主要使用request库爬取网页信息和beautifulSoup库来提取泉州地区酒店信息</div>
<div>技术难点：主要包括对携程网站泉州地区酒店部分的页面进行分析采集</div>
<div>&nbsp;</div>
<div>二、主题页面的结构特征分析（15分）</div>
<div><em id="__mceDel">1.主题页面的结构特征</em></div>
<div><em><em><em><img src="./images/Python高级应用程序设计任务0.png" alt="" /></em></em></em>
<p>&nbsp;</p>
<p>&nbsp;</p>

<em id="__mceDel"><br />2.Htmls页面解析</em></div>
<div>
<p>&nbsp;通过F12，对页面进行检查，查看我们所需要爬取内容的相关代码<img src="./images/Python高级应用程序设计任务1.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>

</div>
<div><em><em><em><img src="./images/Python高级应用程序设计任务2.png" alt="" /></em></em></em>
<p>&nbsp;</p>
<p>&nbsp;<img src="./images/Python高级应用程序设计任务3.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>

<em id="__mceDel"><br />3.节点（标签）查找方法与遍历方法<br />（必要时画出节点树结构）<br />&nbsp;查找方法：find</em></div>
<div><em>遍历方法：for循环</em></div>
<div><em id="__mceDel"><br />三、网络爬虫程序设计（60分）<br />爬虫程序主体要包括以下各部分，要附源代码及较详细注释，并在每部分程序后面提供输出结果的截图。</em></div>
<div><em id="__mceDel">1.数据爬取与采集</em></div>
<div><em><em><em><img src="./images/Python高级应用程序设计任务4.png" alt="" /></em></em></em>
<p>&nbsp;</p>
<p>&nbsp;</p>

<em id="__mceDel"><br />2.对数据进行清洗和处理</em></div>
<div>&nbsp;</div>
<div><br />
<p>&nbsp;<img src="./images/Python高级应用程序设计任务5.png" alt="" /></p>
<p>&nbsp;<img src="./images/Python高级应用程序设计任务6.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;<img src="./images/Python高级应用程序设计任务7.png" alt="" /></p>
<p><img src="./images/Python高级应用程序设计任务8.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;<img src="./images/Python高级应用程序设计任务9.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;<img src="./images/Python高级应用程序设计任务10.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>

<em id="__mceDel">3.文本分析（可选）：jieba分词、wordcloud可视化<br />4.数据分析与可视化<br />（例如：数据柱形图、直方图、散点图、盒图、分布图、数据回归分析等）</em></div>
<div><em><em><em><img src="./images/Python高级应用程序设计任务11.png" alt="" /></em></em></em>
<p>&nbsp;</p>
<p>&nbsp;<img src="./images/Python高级应用程序设计任务12.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;<img src="./images/Python高级应用程序设计任务13.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<em id="__mceDel"><br />&nbsp;5.数据持久化</em></div>
<div><em><em><em><img src="./images/Python高级应用程序设计任务14.png" alt="" /></em></em></em>
<p>&nbsp;<img src="./images/Python高级应用程序设计任务15.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>

</div>
<div>&nbsp;6.附完整程序代码</div>
<div>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> 导入相关模块</span>
<span style="color: #0000ff;">import</span><span style="color: #000000;"> requests
</span><span style="color: #0000ff;">from</span> bs4 <span style="color: #0000ff;">import</span><span style="color: #000000;"> BeautifulSoup
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> pandas as pd


</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> getHtml(url):
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 判断爬取 是否出错</span>
    <span style="color: #0000ff;">try</span><span style="color: #000000;">:
        </span><span style="color: #008000;">#</span><span style="color: #008000;"> 使用get方式爬取页面,添加头部伪装浏览器</span>
        r = requests.get(url, headers={<span style="color: #800000;">'</span><span style="color: #800000;">user-agent</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">Mozilla/5.0</span><span style="color: #800000;">'</span><span style="color: #000000;">})

        r.raise_for_status()
        </span><span style="color: #008000;">#</span><span style="color: #008000;"> 设置编码格式</span>
        r.encoding =<span style="color: #000000;"> r.apparent_encoding
        </span><span style="color: #008000;">#</span><span style="color: #008000;"> 返回源码</span>
        <span style="color: #0000ff;">return</span><span style="color: #000000;"> r.text
    </span><span style="color: #0000ff;">except</span><span style="color: #000000;">:
        </span><span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">页面爬取Error</span><span style="color: #800000;">"</span>

<span style="color: #0000ff;">def</span><span style="color: #000000;"> HotelList(text,hotellist):

    soup </span>= BeautifulSoup(text, <span style="color: #800000;">"</span><span style="color: #800000;">html.parser</span><span style="color: #800000;">"</span><span style="color: #000000;">)
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 爬取酒店列表</span>
    hotel_list = soup.select(<span style="color: #800000;">"</span><span style="color: #800000;">div#hotel_list&gt;div</span><span style="color: #800000;">"</span><span style="color: #000000;">)
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 循环</span>
    <span style="color: #0000ff;">for</span> hotel <span style="color: #0000ff;">in</span><span style="color: #000000;"> hotel_list:
        </span><span style="color: #008000;">#</span><span style="color: #008000;"> 将可能出现错误的地方进行跳过</span>
        <span style="color: #0000ff;">try</span><span style="color: #000000;">:
            </span><span style="color: #008000;">#</span><span style="color: #008000;"> 酒店名称</span>
            hotel_name = hotel.select(<span style="color: #800000;">"</span><span style="color: #800000;">h2</span><span style="color: #800000;">"</span><span style="color: #000000;">)[0].text
            </span><span style="color: #008000;">#</span><span style="color: #008000;"> 酒店链接</span>
            href = hotel.select(<span style="color: #800000;">"</span><span style="color: #800000;">h2&gt;a</span><span style="color: #800000;">"</span>)[0].attrs[<span style="color: #800000;">"</span><span style="color: #800000;">href</span><span style="color: #800000;">"</span><span style="color: #000000;">]
            </span><span style="color: #008000;">#</span><span style="color: #008000;"> 服务贫家</span>
            recommend = hotel.select(<span style="color: #800000;">"</span><span style="color: #800000;">span.recommend</span><span style="color: #800000;">"</span><span style="color: #000000;">)[0].text
            p </span>= hotel.select(<span style="color: #800000;">"</span><span style="color: #800000;">p.hotel_item_htladdress</span><span style="color: #800000;">"</span><span style="color: #000000;">)
            </span><span style="color: #008000;">#</span><span style="color: #008000;"> 酒店地址</span>
            dizhi =<span style="color: #000000;"> p[0].text
            </span><span style="color: #008000;">#</span><span style="color: #008000;"> 最新预定时间</span>
            newtime = hotel.select(<span style="color: #800000;">"</span><span style="color: #800000;">p.hotel_item_last_book</span><span style="color: #800000;">"</span><span style="color: #000000;">)[0].text
            </span><span style="color: #008000;">#</span><span style="color: #008000;"> 评分</span>
            hotel_score = hotel.find_all(<span style="color: #800000;">"</span><span style="color: #800000;">span</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">hotel_value</span><span style="color: #800000;">"</span><span style="color: #000000;">)[0].text
            </span><span style="color: #008000;">#</span><span style="color: #008000;"> 点评人数</span>
            people_number = hotel.select(<span style="color: #800000;">"</span><span style="color: #800000;">span.hotel_judgement&gt;span</span><span style="color: #800000;">"</span><span style="color: #000000;">)[0].text
            </span><span style="color: #008000;">#</span><span style="color: #008000;"> 酒店评分</span>
            level = hotel.find_all(<span style="color: #800000;">"</span><span style="color: #800000;">span</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">hotel_level</span><span style="color: #800000;">"</span><span style="color: #000000;">)[0].text
            </span><span style="color: #008000;">#</span><span style="color: #008000;"> 质量保证</span>
            ico_quality_gold = hotel.select(<span style="color: #800000;">"</span><span style="color: #800000;">span.ico_quality_gold</span><span style="color: #800000;">"</span><span style="color: #000000;">)[0].text
            </span><span style="color: #008000;">#</span><span style="color: #008000;"> 所属地区</span>
            diqu =<span style="color: #000000;"> p[0].find_all(
                </span><span style="color: #800000;">"</span><span style="color: #800000;">a</span><span style="color: #800000;">"</span>, attrs={<span style="color: #800000;">"</span><span style="color: #800000;">tracekey</span><span style="color: #800000;">"</span>: <span style="color: #800000;">"</span><span style="color: #800000;">nhtllistroomclick</span><span style="color: #800000;">"</span><span style="color: #000000;">})[0].text
            </span><span style="color: #008000;">#</span><span style="color: #008000;"> price = hotel.find_all("span", "J_price_lowList ")[0].text</span>
<span style="color: #000000;">            
            hotellist.append([hotel_name, href, recommend, dizhi, newtime, 
                              hotel_score, people_number, level, ico_quality_gold, diqu])
            </span><span style="color: #0000ff;">print</span><span style="color: #000000;">([hotel_name, href, recommend, dizhi, newtime,
                   hotel_score, people_number, level, ico_quality_gold, diqu])

        </span><span style="color: #0000ff;">except</span><span style="color: #000000;">:
            </span><span style="color: #800000;">"</span><span style="color: #800000;">一个数据爬取出错</span><span style="color: #800000;">"</span><span style="color: #000000;">
            hotellist.append([hotel_name, href, recommend, dizhi, newtime, 
                              hotel_score, people_number, level, ico_quality_gold, diqu])


</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> savedata(hotellist):

    wri </span>= pd.ExcelWriter(<span style="color: #800000;">"</span><span style="color: #800000;">HotelList.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">)

    col </span>= [<span style="color: #800000;">"</span><span style="color: #800000;">hotel_name</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">href</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">recommend</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">dizhi</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">newtime</span><span style="color: #800000;">"</span><span style="color: #000000;">,
           </span><span style="color: #800000;">"</span><span style="color: #800000;">hotel_score</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">people_number</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">level</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">ico_quality_gold</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">diqu</span><span style="color: #800000;">"</span><span style="color: #000000;">]

    pf </span>= pd.DataFrame(hotellist,columns=<span style="color: #000000;">col)
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 写入excel</span>
<span style="color: #000000;">    pf.to_excel(wri)

    wri.save()

</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> main():
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 存放数据的数组</span>
    hotellist =<span style="color: #000000;"> []
    text </span>=<span style="color: #000000;"> getHtml(
        </span><span style="color: #800000;">"</span><span style="color: #800000;">https://hotels.ctrip.com/hotel/quanzhou406#ctm_ref=hod_hp_sb_lst</span><span style="color: #800000;">"</span><span style="color: #000000;">)

    HotelList(text, hotellist)
    </span><span style="color: #008000;">#</span><span style="color: #008000;">打印结果信息</span>
    <span style="color: #0000ff;">print</span><span style="color: #000000;">(hotellist)
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 数据保存</span>
    savedata(hotellist)</pre>
</div>
<p><img src="./images/Python高级应用程序设计任务16.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</div>
<div>四、结论（10分）<br />1.经过对主题数据的分析与可视化，可以得到哪些结论？</div>
<div>通过对泉州地区酒店的爬取，可以知道每个酒店的具体名称和地址还有酒店评分，由此可知泉州华侨大厦和希岸酒店，泉州钱隆酒店的评分最高；泉州泉兴精品酒店评分最低。</div>
<div>泉州酒店点评人数最多，泉州钱隆酒店点评人数最少。<br />2.对本次程序设计任务完成的情况做一个简单的小结。</div>
<div>我觉得这次爬虫的内容还挺有意思的，也让我学到了很多书本以外的知识，一步一步自己探索出来，遇到不懂的问题及时问同学答疑解惑。这一次任务按照老师的要求一步一步来实现，虽然有一些没有完全实现出来，还存在在很多问题，但是发现问题多了也就能及时查缺补漏，让我们对Python这门语言有了更深的理解，也让我增加了更多的兴趣对于这个课程，能够让自己能更好地进步。</div>
<div>
<p>&nbsp;</p>

</div>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>