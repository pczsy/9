<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修小白学Python（6）——python-pptx 添加图表' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>小白学Python（6）——python-pptx 添加图表</center></div><div class='banquan'>原文出处:本文由博客园博主徐海建提供。<br/>
原文连接:https://www.cnblogs.com/adam012019/p/11348938.html</div><br>
    <p>&nbsp;</p>
<p>添加图表</p>
<p>以下代码在新演示文稿中添加单系列柱形图</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">from</span> pptx <span style="color: #0000ff;">import</span><span style="color: #000000;"> Presentation
</span><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">from</span> pptx.chart.data <span style="color: #0000ff;">import</span><span style="color: #000000;"> CategoryChartData
</span><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">from</span> pptx.enum.chart <span style="color: #0000ff;">import</span><span style="color: #000000;"> XL_CHART_TYPE
</span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">from</span> pptx.util <span style="color: #0000ff;">import</span><span style="color: #000000;"> Inches
</span><span style="color: #008080;"> 5</span> 
<span style="color: #008080;"> 6</span> <span style="color: #008000;">#</span><span style="color: #008000;"> create presentation with 1 slide ------</span>
<span style="color: #008080;"> 7</span> prs =<span style="color: #000000;"> Presentation()
</span><span style="color: #008080;"> 8</span> slide = prs.slides.add_slide(prs.slide_layouts[5<span style="color: #000000;">])
</span><span style="color: #008080;"> 9</span> 
<span style="color: #008080;">10</span> <span style="color: #008000;">#</span><span style="color: #008000;"> define chart data ---------------------</span>
<span style="color: #008080;">11</span> chart_data =<span style="color: #000000;"> CategoryChartData()
</span><span style="color: #008080;">12</span> chart_data.categories = [<span style="color: #800000;">'</span><span style="color: #800000;">East</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">West</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">Midwest</span><span style="color: #800000;">'</span><span style="color: #000000;">]
</span><span style="color: #008080;">13</span> chart_data.add_series(<span style="color: #800000;">'</span><span style="color: #800000;">Series 1</span><span style="color: #800000;">'</span>, (19.2, 21.4, 16.7<span style="color: #000000;">))
</span><span style="color: #008080;">14</span> 
<span style="color: #008080;">15</span> <span style="color: #008000;">#</span><span style="color: #008000;"> add chart to slide --------------------</span>
<span style="color: #008080;">16</span> x, y, cx, cy = Inches(2), Inches(2), Inches(6), Inches(4.5<span style="color: #000000;">)
</span><span style="color: #008080;">17</span> <span style="color: #000000;">slide.shapes.add_chart(
</span><span style="color: #008080;">18</span> <span style="color: #000000;">    XL_CHART_TYPE.COLUMN_CLUSTERED, x, y, cx, cy, chart_data
</span><span style="color: #008080;">19</span> <span style="color: #000000;">)
</span><span style="color: #008080;">20</span> 
<span style="color: #008080;">21</span> prs.save(<span style="color: #800000;">'</span><span style="color: #800000;">chart-01.pptx</span><span style="color: #800000;">'</span>)</pre>
</div>
<p><strong><img src="./images/小白学Python（6）——python-pptx 添加图表0.png" alt="" /></strong></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">from</span> pptx <span style="color: #0000ff;">import</span><span style="color: #000000;"> Presentation
</span><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">from</span> pptx.chart.data <span style="color: #0000ff;">import</span><span style="color: #000000;"> CategoryChartData
</span><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">from</span> pptx.enum.chart <span style="color: #0000ff;">import</span><span style="color: #000000;"> XL_CHART_TYPE
</span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">from</span> pptx.util <span style="color: #0000ff;">import</span><span style="color: #000000;"> Inches
</span><span style="color: #008080;"> 5</span> 
<span style="color: #008080;"> 6</span> <span style="color: #008000;">#</span><span style="color: #008000;"> create presentation with 1 slide ------</span>
<span style="color: #008080;"> 7</span> prs =<span style="color: #000000;"> Presentation()
</span><span style="color: #008080;"> 8</span> slide = prs.slides.add_slide(prs.slide_layouts[5<span style="color: #000000;">])
</span><span style="color: #008080;"> 9</span> 
<span style="color: #008080;">10</span> <span style="color: #008000;">#</span><span style="color: #008000;"> define chart data ---------------------</span>
<span style="color: #008080;">11</span> chart_data =<span style="color: #000000;"> CategoryChartData()
</span><span style="color: #008080;">12</span> chart_data.categories = [<span style="color: #800000;">'</span><span style="color: #800000;">East</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">West</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">Midwest</span><span style="color: #800000;">'</span><span style="color: #000000;">]
</span><span style="color: #008080;">13</span> chart_data.add_series(<span style="color: #800000;">'</span><span style="color: #800000;">Q1 Sales</span><span style="color: #800000;">'</span>, (19.2, 21.4, 16.7<span style="color: #000000;">))
</span><span style="color: #008080;">14</span> chart_data.add_series(<span style="color: #800000;">'</span><span style="color: #800000;">Q2 Sales</span><span style="color: #800000;">'</span>, (22.3, 28.6, 15.2<span style="color: #000000;">))
</span><span style="color: #008080;">15</span> chart_data.add_series(<span style="color: #800000;">'</span><span style="color: #800000;">Q3 Sales</span><span style="color: #800000;">'</span>, (20.4, 26.3, 14.2<span style="color: #000000;">))
</span><span style="color: #008080;">16</span> 
<span style="color: #008080;">17</span> 
<span style="color: #008080;">18</span> <span style="color: #008000;">#</span><span style="color: #008000;"> add chart to slide --------------------</span>
<span style="color: #008080;">19</span> x, y, cx, cy = Inches(2), Inches(2), Inches(6), Inches(4.5<span style="color: #000000;">)
</span><span style="color: #008080;">20</span> <span style="color: #000000;">slide.shapes.add_chart(
</span><span style="color: #008080;">21</span> <span style="color: #000000;">    XL_CHART_TYPE.COLUMN_CLUSTERED, x, y, cx, cy, chart_data
</span><span style="color: #008080;">22</span> <span style="color: #000000;">)
</span><span style="color: #008080;">23</span> 
<span style="color: #008080;">24</span> graphic_frame =<span style="color: #000000;"> slide.shapes.add_chart(
</span><span style="color: #008080;">25</span> <span style="color: #000000;">    XL_CHART_TYPE.COLUMN_CLUSTERED, x, y, cx, cy, chart_data
</span><span style="color: #008080;">26</span> <span style="color: #000000;">)
</span><span style="color: #008080;">27</span> 
<span style="color: #008080;">28</span> chart =<span style="color: #000000;"> graphic_frame.chart
</span><span style="color: #008080;">29</span> 
<span style="color: #008080;">30</span> prs.save(<span style="color: #800000;">'</span><span style="color: #800000;">chart-01.pptx</span><span style="color: #800000;">'</span>)</pre>
</div>
<p><img src="./images/小白学Python（6）——python-pptx 添加图表1.png" alt="" /></p>
<p><span><span>请注意，我们捕获了</span></span><code><span class="pre">add_chart()</span></code><span><span>调用</span><span>返回的形状引用&nbsp;</span></span><code class="docutils literal notranslate"><span class="pre">graphic_frame</span></code><span><span>，然后使用其</span></span><code class="xref py py-attr docutils literal notranslate"><span class="pre">chart</span></code><span><span>属性</span><span>从图形框架中提取图表对象&nbsp;</span><span>。</span><span>我们需要图表参考来获取我们在接下来的步骤中需要的属性。</span><span>该&nbsp;</span></span><code><span class="pre">add_chart()</span></code><span><span>方法不直接返回图表对象。</span><span>那是因为图表本身并不是一种形状。</span><span>相反，它是</span><span>图形框架形状中</span></span><em><span><span>包含</span></span></em><span><span>的图形（DrawingML）对象</span><span>。</span><span>表也​​以这种方式工作，也包含在图形框架形状中。</span></span></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">from</span> pptx <span style="color: #0000ff;">import</span><span style="color: #000000;"> Presentation
</span><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">from</span> pptx.chart.data <span style="color: #0000ff;">import</span><span style="color: #000000;"> CategoryChartData
</span><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">from</span> pptx.enum.chart <span style="color: #0000ff;">import</span><span style="color: #000000;"> XL_CHART_TYPE
</span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">from</span> pptx.util <span style="color: #0000ff;">import</span><span style="color: #000000;"> Inches
</span><span style="color: #008080;"> 5</span> 
<span style="color: #008080;"> 6</span> <span style="color: #008000;">#</span><span style="color: #008000;"> create presentation with 1 slide ------</span>
<span style="color: #008080;"> 7</span> prs =<span style="color: #000000;"> Presentation()
</span><span style="color: #008080;"> 8</span> slide = prs.slides.add_slide(prs.slide_layouts[5<span style="color: #000000;">])
</span><span style="color: #008080;"> 9</span> 
<span style="color: #008080;">10</span> <span style="color: #008000;">#</span><span style="color: #008000;"> define chart data ---------------------</span>
<span style="color: #008080;">11</span> chart_data =<span style="color: #000000;"> CategoryChartData()
</span><span style="color: #008080;">12</span> chart_data.categories = [<span style="color: #800000;">'</span><span style="color: #800000;">East</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">West</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">Midwest</span><span style="color: #800000;">'</span><span style="color: #000000;">]
</span><span style="color: #008080;">13</span> chart_data.add_series(<span style="color: #800000;">'</span><span style="color: #800000;">Q1 Sales</span><span style="color: #800000;">'</span>, (19.2, 21.4, 16.7<span style="color: #000000;">))
</span><span style="color: #008080;">14</span> chart_data.add_series(<span style="color: #800000;">'</span><span style="color: #800000;">Q2 Sales</span><span style="color: #800000;">'</span>, (22.3, 28.6, 15.2<span style="color: #000000;">))
</span><span style="color: #008080;">15</span> chart_data.add_series(<span style="color: #800000;">'</span><span style="color: #800000;">Q3 Sales</span><span style="color: #800000;">'</span>, (20.4, 26.3, 14.2<span style="color: #000000;">))
</span><span style="color: #008080;">16</span> 
<span style="color: #008080;">17</span> 
<span style="color: #008080;">18</span> <span style="color: #008000;">#</span><span style="color: #008000;"> add chart to slide --------------------</span>
<span style="color: #008080;">19</span> 
<span style="color: #008080;">20</span> x, y, cx, cy = Inches(2), Inches(2), Inches(6), Inches(4.5<span style="color: #000000;">)
</span><span style="color: #008080;">21</span> 
<span style="color: #008080;">22</span> <span style="color: #000000;">slide.shapes.add_chart(
</span><span style="color: #008080;">23</span> <span style="color: #000000;">    XL_CHART_TYPE.COLUMN_CLUSTERED, x, y, cx, cy, chart_data
</span><span style="color: #008080;">24</span> <span style="color: #000000;">)
</span><span style="color: #008080;">25</span> 
<span style="color: #008080;">26</span> graphic_frame =<span style="color: #000000;"> slide.shapes.add_chart(
</span><span style="color: #008080;">27</span> <span style="color: #000000;">    XL_CHART_TYPE.COLUMN_CLUSTERED, x, y, cx, cy, chart_data
</span><span style="color: #008080;">28</span> <span style="color: #000000;">)
</span><span style="color: #008080;">29</span> 
<span style="color: #008080;">30</span> chart =<span style="color: #000000;"> graphic_frame.chart
</span><span style="color: #008080;">31</span> 
<span style="color: #008080;">32</span> <span style="color: #0000ff;">from</span> pptx.dml.color <span style="color: #0000ff;">import</span><span style="color: #000000;"> RGBColor
</span><span style="color: #008080;">33</span> <span style="color: #0000ff;">from</span> pptx.enum.chart <span style="color: #0000ff;">import</span><span style="color: #000000;"> XL_LABEL_POSITION
</span><span style="color: #008080;">34</span> 
<span style="color: #008080;">35</span> plot =<span style="color: #000000;"> chart.plots[0]
</span><span style="color: #008080;">36</span> plot.has_data_labels =<span style="color: #000000;"> True
</span><span style="color: #008080;">37</span> data_labels =<span style="color: #000000;"> plot.data_labels
</span><span style="color: #008080;">38</span> 
<span style="color: #008080;">39</span> 
<span style="color: #008080;">40</span> data_labels.font.color.rgb = RGBColor(0x0A, 0x42, 0x80<span style="color: #000000;">)
</span><span style="color: #008080;">41</span> data_labels.position =<span style="color: #000000;"> XL_LABEL_POSITION.INSIDE_END
</span><span style="color: #008080;">42</span> 
<span style="color: #008080;">43</span> prs.save(<span style="color: #800000;">'</span><span style="color: #800000;">chart-01.pptx</span><span style="color: #800000;">'</span>)</pre>
</div>
<p><img src="./images/小白学Python（6）——python-pptx 添加图表2.png" alt="" /></p>
<p>后面加上</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;">1</span> <span style="color: #0000ff;">from</span> pptx.enum.chart <span style="color: #0000ff;">import</span><span style="color: #000000;"> XL_LEGEND_POSITION
</span><span style="color: #008080;">2</span> 
<span style="color: #008080;">3</span> chart.has_legend =<span style="color: #000000;"> True
</span><span style="color: #008080;">4</span> chart.legend.position =<span style="color: #000000;"> XL_LEGEND_POSITION.RIGHT
</span><span style="color: #008080;">5</span> chart.legend.include_in_layout = False</pre>
</div>
<p><img src="./images/小白学Python（6）——python-pptx 添加图表3.png" alt="" /></p>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">from</span> pptx <span style="color: #0000ff;">import</span><span style="color: #000000;"> Presentation
</span><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">from</span> pptx.chart.data <span style="color: #0000ff;">import</span><span style="color: #000000;"> CategoryChartData
</span><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">from</span> pptx.enum.chart <span style="color: #0000ff;">import</span><span style="color: #000000;"> XL_CHART_TYPE
</span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">from</span> pptx.util <span style="color: #0000ff;">import</span><span style="color: #000000;"> Inches
</span><span style="color: #008080;"> 5</span> 
<span style="color: #008080;"> 6</span> <span style="color: #008000;">#</span><span style="color: #008000;"> create presentation with 1 slide ------</span>
<span style="color: #008080;"> 7</span> prs =<span style="color: #000000;"> Presentation()
</span><span style="color: #008080;"> 8</span> slide = prs.slides.add_slide(prs.slide_layouts[5<span style="color: #000000;">])
</span><span style="color: #008080;"> 9</span> 
<span style="color: #008080;">10</span> <span style="color: #008000;">#</span><span style="color: #008000;"> define chart data ---------------------</span>
<span style="color: #008080;">11</span> chart_data =<span style="color: #000000;"> CategoryChartData()
</span><span style="color: #008080;">12</span> 
<span style="color: #008080;">13</span> chart_data.categories = [<span style="color: #800000;">'</span><span style="color: #800000;">Q1 Sales</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">Q2 Sales</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">Q3 Sales</span><span style="color: #800000;">'</span><span style="color: #000000;">]
</span><span style="color: #008080;">14</span> chart_data.add_series(<span style="color: #800000;">'</span><span style="color: #800000;">West</span><span style="color: #800000;">'</span>,    (32.2, 28.4, 34.7<span style="color: #000000;">))
</span><span style="color: #008080;">15</span> chart_data.add_series(<span style="color: #800000;">'</span><span style="color: #800000;">East</span><span style="color: #800000;">'</span>,    (24.3, 30.6, 20.2<span style="color: #000000;">))
</span><span style="color: #008080;">16</span> chart_data.add_series(<span style="color: #800000;">'</span><span style="color: #800000;">Midwest</span><span style="color: #800000;">'</span>, (20.4, 18.3, 26.2<span style="color: #000000;">))
</span><span style="color: #008080;">17</span> 
<span style="color: #008080;">18</span> x, y, cx, cy = Inches(2), Inches(2), Inches(6), Inches(4.5<span style="color: #000000;">)
</span><span style="color: #008080;">19</span> 
<span style="color: #008080;">20</span> chart =<span style="color: #000000;"> slide.shapes.add_chart(
</span><span style="color: #008080;">21</span> <span style="color: #000000;">    XL_CHART_TYPE.LINE, x, y, cx, cy, chart_data
</span><span style="color: #008080;">22</span> <span style="color: #000000;">).chart
</span><span style="color: #008080;">23</span> 
<span style="color: #008080;">24</span> prs.save(<span style="color: #800000;">'</span><span style="color: #800000;">chart-01.pptx</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;<img src="./images/小白学Python（6）——python-pptx 添加图表4.png" alt="" /></p>
<p>折线图的方式与条形图或柱形图几乎相同，主要区别在于<code>add_chart()</code>调用中提供的图表类型。</p>
<p>&nbsp;</p>
<p><span>XY和气泡图一直出现错误，暂时没有完成，正在研究&hellip;&hellip;</span></p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>