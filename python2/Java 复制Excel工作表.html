<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修Java 复制Excel工作表' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>Java 复制Excel工作表</center></div><div class='banquan'>原文出处:本文由博客园博主E-iceblue提供。<br/>
原文连接:https://www.cnblogs.com/Yesi/p/12068923.html</div><br>
    <p><span style="font-size: 15px;">本文归纳了关于Java如何复制Excel工作表的方法，按不同复制需求，可分为：</span></p>
<p><span style="font-size: 15px;">1. 复制工作表</span></p>
<p><span style="font-size: 15px;">&nbsp; &nbsp;1.1 在同一个工作簿内复制工作表</span></p>
<p><span style="font-size: 15px;">&nbsp; &nbsp;1.2 在不同工作簿间复制工作表</span></p>
<p><span style="font-size: 15px;">2. 复制指定单元格数据</span></p>
<p><span style="font-size: 15px;">对于复制方法copy()，这里简单整理了一个表格，其中包含了对数据复制的不同应用需求，可参考使用：</span></p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="311">
<p><span style="font-size: 15px;"><strong>方法</strong></span></p>
</td>
<td valign="top" width="311">
<p><span style="font-size: 15px;"><strong>解释</strong></span></p>
</td>
</tr>
<tr>
<td valign="top" width="311">
<p><span style="font-size: 15px;"><strong>copyFrom(</strong>Worksheet worksheet<strong>)</strong></span></p>
</td>
<td valign="top" width="311">
<p><span style="font-size: 15px;">复制自源工作表的数据</span></p>
</td>
</tr>
<tr>
<td valign="top" width="311">
<p style="text-align: left;"><span style="font-size: 15px;"><strong>copy(</strong>CellRange sourceRange, CellRange destRange<strong>)</strong></span></p>
</td>
<td valign="top" width="311">
<p><span style="font-size: 15px;">复制源数据到目标数据范围</span></p>
</td>
</tr>
<tr>
<td valign="top" width="311">
<p><span style="font-size: 15px;"><strong>copy(</strong>CellRange sourceRange, CellRange destRange, Boolean copyStyle<strong>)</strong></span></p>
</td>
<td valign="top" width="311">
<p><span style="font-size: 15px;">复制源数据到目标数据范围时，是否复制源数据样式</span></p>
</td>
</tr>
<tr>
<td valign="top" width="311">
<p><span style="font-size: 15px;"><strong>copy(</strong>CellRange sourceRange, Worksheet worksheet, int destRow, int destColumn<strong>)</strong></span></p>
</td>
<td valign="top" width="311">
<p><span style="font-size: 15px;">复制源数据到目标工作表中的指定行和列</span></p>
</td>
</tr>
<tr>
<td valign="top" width="311">
<p><span style="font-size: 15px;"><strong>copy(</strong>CellRange sourceRange, Worksheet worksheet, int destRow, int destColumn, Boolean copyStyle<strong>)</strong></span></p>
</td>
<td valign="top" width="311">
<p><span style="font-size: 15px;">复制源数据到目标工作表中的指定行和列时，是否复制源数据样式</span></p>
</td>
</tr>
<tr>
<td valign="top" width="311">
<p><span style="font-size: 15px;"><strong>copy(</strong>CellRange sourceRange, CellRange destRange, Boolean copyStyle, Boolean updateReference, Boolean ignoreSize<strong>)</strong></span></p>
</td>
<td valign="top" width="311">
<p><span style="font-size: 15px;">复制源数据到目标数据范围时，是否复制源数据样式，是否更新引用，是否忽略大小</span></p>
</td>
</tr>
<tr>
<td valign="top" width="311">
<p><span style="font-size: 15px;"><strong>copy(</strong>CellRange sourceRange, Worksheet worksheet, int destRow, int destColumn, boolean copyStyle, boolean undateReference<strong>)</strong></span></p>
</td>
<td valign="top" width="311">
<p><span style="font-size: 15px;">复制源数据到目标工作表中的指定行和列时，是否复制源数据样式，是否更新引用</span></p>
</td>
</tr>
<tr>
<td valign="top" width="311">
<p><span style="font-size: 15px;"><strong>copy(</strong>CellRange sourceRange, CellRange destRange, boolean copyStyle, boolean updateReference, boolean ignoreSize, boolean copyShape<strong>)</strong></span></p>
</td>
<td valign="top" width="311">
<p><span style="font-size: 15px;">复制源数据到目标数据范围时，是否复制源数据样式，是否更新引用，是否忽略大小，是否复制形状</span></p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>文中的方法使用了免费Java Excel类库（Free Spire.XLS for Java），可在官网<span style="color: #0000ff;"><a href="https://www.e-iceblue.cn/Downloads/Free-Spire-XLS-JAVA.html" target="_blank"><span style="color: #0000ff;">下载包</span></a></span>，解压后，将lib文件夹中的jar文件导入Java程序；或者通过maven仓库下载导入jar，maven仓库路径配置及依赖添加可以参考<span style="color: #0000ff;"><a href="https://www.e-iceblue.cn/licensing/install-spirepdf-for-java-from-maven-repository.html" target="_blank"><span style="color: #0000ff;">教程</span></a></span>。导入效果如下图：</p>
<p><img src="./images/Java 复制Excel工作表0.png" alt="" /></p>
<p>&nbsp;</p>
<h1><strong>Java</strong><strong>代码示例</strong></h1>
<h2><strong>【示例</strong><strong>1</strong><strong>】在同一工作簿内复制</strong></h2>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">import</span> com.spire.xls.*<span style="color: #000000;">;

</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Copy1 {
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
        </span><span style="color: #008000;">//</span><span style="color: #008000;">加载文档</span>
        Workbook wb = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Workbook();
        wb.loadFromFile(</span>"test.xlsx"<span style="color: #000000;">);

        </span><span style="color: #008000;">//</span><span style="color: #008000;">获取第一张工作表</span>
        Worksheet sheet0 = wb.getWorksheets().get(0<span style="color: #000000;">);

        </span><span style="color: #008000;">//</span><span style="color: #008000;">获取第三张工作表，命名，并将第一张工作表内容复制到该工作表</span>
        Worksheet sheet2 = wb.getWorksheets().get(2<span style="color: #000000;">);
        sheet2.setName(</span>"Copiedsheet"<span style="color: #000000;">);
        sheet2.copyFrom(sheet0);

        </span><span style="color: #008000;">//</span><span style="color: #008000;">保存文档</span>
        wb.saveToFile("Copy1.xlsx"<span style="color: #000000;">,FileFormat.Version2013);
    }
}</span></pre>
</div>
<p>复制效果：</p>
<p><img src="./images/Java 复制Excel工作表1.png" alt="" /></p>
<p>&nbsp;</p>
<h2><strong>【示例</strong><strong>2</strong><strong>】在不同工作簿间复制</strong></h2>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">import</span> com.spire.xls.*<span style="color: #000000;">;

</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Copy2 {
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
        </span><span style="color: #008000;">//</span><span style="color: #008000;">加载文档1，并获取第一张幻灯片</span>
        Workbook wb1 = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Workbook();
        wb1.loadFromFile(</span>"test1.xlsx"<span style="color: #000000;">);
        Worksheet sheet1 </span>= wb1.getWorksheets().get(0<span style="color: #000000;">);

        </span><span style="color: #008000;">//</span><span style="color: #008000;">加载文档2，获取第三张幻灯片，并将文档1中的工作表内容复制到该工作表</span>
        Workbook wb2 = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Workbook();
        wb2.loadFromFile(</span>"test2.xlsx"<span style="color: #000000;">);
        Worksheet sheet2 </span>= wb2.getWorksheets().get(2<span style="color: #000000;">);
        sheet2.setName(</span>"Copied"<span style="color: #000000;">);
        sheet2.copyFrom(sheet1);

        </span><span style="color: #008000;">//</span><span style="color: #008000;">保存文档</span>
        wb2.saveToFile("Copy2.xlsx"<span style="color: #000000;">,FileFormat.Version2013);
    }
}</span></pre>
</div>
<p>复制效果：</p>
<p><img src="./images/Java 复制Excel工作表2.png" alt="" /></p>
<p>&nbsp;</p>
<h2><strong>【示例</strong><strong>3</strong><strong>】复制单元格数据范围</strong></h2>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">import</span> com.spire.xls.*<span style="color: #000000;">;

</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> CopyRange {
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
        </span><span style="color: #008000;">//</span><span style="color: #008000;">加载文档</span>
        Workbook wb = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Workbook();
        wb.loadFromFile(</span>"test.xlsx"<span style="color: #000000;">);

        </span><span style="color: #008000;">//</span><span style="color: #008000;">获取第一个工作表</span>
        Worksheet sheet = wb.getWorksheets().get(0<span style="color: #000000;">);

        </span><span style="color: #008000;">//</span><span style="color: #008000;">复制指定单元格范围中的数据</span>
        CellRange range1 = sheet.getCellRange(8,1,8,7<span style="color: #000000;">);
        CellRange range2 </span>= sheet.getCellRange(11,1,11,7<span style="color: #000000;">);
        sheet.copy(range1,range2,</span><span style="color: #0000ff;">true</span><span style="color: #000000;">);

        </span><span style="color: #008000;">//</span><span style="color: #008000;">保存文档</span>
        wb.saveToFile("CopyRange.xlsx"<span style="color: #000000;">,FileFormat.Version2013);
    }
}</span></pre>
</div>
<p>复制结果：</p>
<p><img src="./images/Java 复制Excel工作表3.png" alt="" /></p>
<p>&nbsp;</p>
<p>（本文完）</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>