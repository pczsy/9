<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='ç”µè„‘,ç”µè„‘è®²è§£,ç”µè„‘æŠ€æœ¯,ç¼–ç¨‹,ç”µè„‘æ•…éšœç»´ä¿®ã€Pythonè¿˜èƒ½å¹²å˜›ã€‘çˆ¬å–å¾®ä¿¡å¥½å‹å¤´åƒå®Œæˆé©¬èµ›å…‹æ‹¼å›¾ï¼ˆåƒå›¾æˆåƒï¼‰ï½' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>é¦–é¡µ</a></li>
</div><div onclick='hidden1()' >åˆ†äº«</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>ã€Pythonè¿˜èƒ½å¹²å˜›ã€‘çˆ¬å–å¾®ä¿¡å¥½å‹å¤´åƒå®Œæˆé©¬èµ›å…‹æ‹¼å›¾ï¼ˆåƒå›¾æˆåƒï¼‰ï½</center></div><div class='banquan'>åŸæ–‡å‡ºå¤„:æœ¬æ–‡ç”±åšå®¢å›­åšä¸»AwesomeTangæä¾›ã€‚<br/>
åŸæ–‡è¿æ¥:https://www.cnblogs.com/awesometang/p/12013595.html</div><br>
    <h3 id="é©¬èµ›å…‹æ‹¼å›¾">é©¬èµ›å…‹æ‹¼å›¾</h3>
<p>ä½•è°“é©¬èµ›å…‹æ‹¼å›¾ï¼ˆåƒå›¾æˆåƒï¼‰ï¼Œç®€å•æ¥è¯´å°±æ˜¯å°†è‹¥å¹²å°å›¾ç‰‡å¹³å‡‘æˆä¸ºä¸€å¼ å¤§å›¾ï¼Œå¦‚ä¸‹å›¾è·¯é£ä¸€æ ·ï¼Œå¦‚æœæ”¾å¤§çœ‹ä½ ä¼šå‘ç°é‡Œé¢éƒ½æ˜¯ä¸€äº›æµ·è´¼ç‹é‡Œé¢çš„å›¾ç‰‡ã€‚<br />
<img src="./images/ã€Pythonè¿˜èƒ½å¹²å˜›ã€‘çˆ¬å–å¾®ä¿¡å¥½å‹å¤´åƒå®Œæˆé©¬èµ›å…‹æ‹¼å›¾ï¼ˆåƒå›¾æˆåƒï¼‰ï½0.png" alt="LUFFY" /></p>
<h3 id="our-tragets"><em>Our Tragets</em></h3>
<ul>
<li>çˆ¬å–æ‰€æœ‰å¾®ä¿¡å¥½å‹çš„å¤´åƒğŸ•ºğŸ»ğŸ•ºğŸ»ğŸ•ºğŸ»</li>
<li>å°†æ‰€æœ‰å¾®ä¿¡å¥½å‹å¤´åƒæ‹¼å‡‘æˆä¸€å¼ å›¾ç‰‡ğŸ™ğŸ™ğŸ™</li>
<li>ç„¶åå°±å¯ä»¥å»æœ‹å‹åœˆæ„‰å¿«çš„è£…é€¼äº†ğŸ¤ªğŸ¤ªğŸ¤ª</li>
</ul>
<h3 id="requirements"><em>Requirements</em></h3>
<p>å…¶å®æ•´ä¸ªé¡¹ç›®å¾ˆå°ï¼Œé¡¹ç›®æ€»å…±ä»£ç é‡ä¸è¿‡100è¡Œå·¦å³ã€‚</p>
<ul>
<li>çˆ¬å–å¾®ä¿¡å¤´åƒä¾èµ–ç¬¬ä¸‰æ–¹åº“<code>itchat</code>ï¼›</li>
<li>é©¬èµ›å…‹æ‹¼å›¾ä¾èµ–ä¾èµ–<code>numpy</code>å’Œ<code>PIL</code>åº“ã€‚</li>
</ul>
<h3 id="content"><em>Content</em></h3>
<h4 id="çˆ¬å–å¾®ä¿¡å¥½å‹å¤´åƒ">çˆ¬å–å¾®ä¿¡å¥½å‹å¤´åƒ</h4>
<p>æˆ‘è¿™è¾¹æ˜¯ç”¨çš„æ‰€æœ‰å¾®ä¿¡å¥½å‹å¤´åƒä½œä¸ºçš„æ•°æ®æºï¼Œä½ ä»¬å¦‚æœæœ‰å…¶ä»–çš„æ•°æ®æºä¹Ÿå¯ä»¥çš„ï¼Œå¯ä»¥ç›´æ¥è·³è¿‡è¿™æ­¥ã€‚<br />
çˆ¬å–å¾®ä¿¡å¥½å‹å¤´åƒæˆ‘ä½¿ç”¨çš„æ˜¯<code>itchat</code>ï¼Œé‡Œé¢å·²ç»æœ‰å°è£…å¥½äº†çš„APIï¼Œç›´æ¥è°ƒç”¨å°±å¯ä»¥ï¼Œå°†æ‰€æœ‰çš„å¥½å‹å¤´åƒä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ä¾›åæœŸä½¿ç”¨ã€‚</p>
<ul>
<li>ä»£ç éƒ¨åˆ†</li>
</ul>
<pre><code><code>#!/usr/bin/env python
# -*- coding: utf-8 -*-
# @Author  : AwesomeTang
# @File    : Wechat_Icon.py
# @Version : Python 3.7
# @Time    : 2019-06-29 23:35

import os
import itchat

itchat.login()

friends = itchat.get_friends(update=True)

base_folder = &#39;wechat&#39;
if os.path.isdir(base_folder):
    pass
else:
    os.mkdir(base_folder)

for item in friends:
    img = itchat.get_head_img(item[&#39;UserName&#39;])

    # ä½¿ç”¨ç”¨æˆ·æ˜µç§°ä½œä¸ºæ–‡ä»¶å
    path = os.path.join(base_folder, &#39;{}.jpg&#39;.format(item[&#39;NickName&#39;].replace(&#39;/&#39;, &#39;&#39;)))
    with open(path, &#39;wb&#39;) as f:
        f.write(img)
    print(&#39;{} å†™å…¥å®Œæˆ...&#39;.format(item[&#39;NickName&#39;]))</code></pre>
<ul>
<li>å®ç°æ•ˆæœ<br />
<img src="./images/ã€Pythonè¿˜èƒ½å¹²å˜›ã€‘çˆ¬å–å¾®ä¿¡å¥½å‹å¤´åƒå®Œæˆé©¬èµ›å…‹æ‹¼å›¾ï¼ˆåƒå›¾æˆåƒï¼‰ï½1.png" /></li>
</ul>
<h4 id="é©¬èµ›å…‹æ‹¼å›¾-1">é©¬èµ›å…‹æ‹¼å›¾</h4>
<h5 id="æ€è·¯æ¢³ç†">æ€è·¯æ¢³ç†</h5>
<ol>
<li>é€‰å¥½ä½ éœ€è¦æ‹¼å‡‘çš„å›¾ç‰‡ï¼Œå°†å…¶åˆ‡å‰²ä¸ºè‹¥å¹²å°å—ï¼Œåˆ‡å‰²çš„è¶Šç»†ç”Ÿæˆçš„å›¾ç‰‡æ•ˆæœä¼šæ›´å¥½ã€‚<br />
<strong><em>gayé‡Œgayæ°”çš„ç¤ºæ„å›¾ï¼š</em></strong><br />
<img src="./images/ã€Pythonè¿˜èƒ½å¹²å˜›ã€‘çˆ¬å–å¾®ä¿¡å¥½å‹å¤´åƒå®Œæˆé©¬èµ›å…‹æ‹¼å›¾ï¼ˆåƒå›¾æˆåƒï¼‰ï½2.png" /></li>
<li>åˆ†åˆ«å»æˆ‘ä»¬ä¹‹å‰ä¿å­˜çš„å›¾ç‰‡ä¸­æ‰¾ä¸ä¸ä¹‹æœ€ç›¸ä¼¼çš„ï¼Œæœ€åå°†å…¶æ‹¼æ¥å®Œæˆã€‚<br />
<img src="./images/ã€Pythonè¿˜èƒ½å¹²å˜›ã€‘çˆ¬å–å¾®ä¿¡å¥½å‹å¤´åƒå®Œæˆé©¬èµ›å…‹æ‹¼å›¾ï¼ˆåƒå›¾æˆåƒï¼‰ï½3.png" /></li>
</ol>
<p><strong><em>è¯´èµ·æ¥å¥½åƒå¾ˆç®€å•ï¼Œä½†å®é™…æ“ä½œèµ·æ¥åªèƒ½......</em></strong><br />
<img src="./images/ã€Pythonè¿˜èƒ½å¹²å˜›ã€‘çˆ¬å–å¾®ä¿¡å¥½å‹å¤´åƒå®Œæˆé©¬èµ›å…‹æ‹¼å›¾ï¼ˆåƒå›¾æˆåƒï¼‰ï½4.png" /></p>
<h5 id="æœ€ç›¸ä¼¼çš„å›¾ç‰‡">æœ€ç›¸ä¼¼çš„å›¾ç‰‡</h5>
<p>å…¶å®å›°éš¾çš„åœ°æ–¹å¾ˆæ˜æ˜¾ï¼Œé‚£å°±æ˜¯æˆ‘ä»¬å¦‚ä½•ä»ä¸€å †å›¾ç‰‡ä¸­æ‰¾å‡ºæœ€ç›¸ä¼¼çš„é‚£å¼ ã€‚<br />
æˆ‘ä»¬å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š</p>
<h6 id="é¢œè‰²ç›¸ä¼¼">é¢œè‰²ç›¸ä¼¼</h6>
<p>è¿™ä¸ªåº”è¯¥ä¸éš¾ç†è§£ï¼Œæˆ‘åœ¨ä»£ç ä¸­å®ç°äº†ç°åº¦å›¾åƒå’ŒRGBé€šé“å›¾åƒçš„ç­›é€‰æ–¹æ³•ï¼š</p>
<ul>
<li>ç°åº¦å›¾åƒï¼š<br />
ç›´æ¥è®¡ç®—æ‰€æœ‰åƒç´ ç°åº¦å€¼çš„å¹³å‡å€¼ï¼Œå–æœ€æ¥è¿‘nä¸ªå›¾åƒä¾›åæœŸå†æ¬¡ç­›é€‰ï¼›</li>
<li>RGBé€šé“ï¼š<br />
åˆ†åˆ«è®¡ç®—R,G,Bçš„å¹³å‡å€¼ï¼Œå¯¹äºä¸€ä¸ªå›¾åƒæˆ‘ä»¬å¾—åˆ°çš„æ˜¯ä¸€ä¸ªç±»ä¼¼ä¸[20, 30,40]çš„æ•°ç»„ï¼Œç„¶åæˆ‘ä»¬è®¡ç®—æ¬§å¼è·ç¦»ï¼Œå–æœ€æ¥è¿‘nä¸ªå›¾åƒä¾›åæœŸå†æ¬¡ç­›é€‰ã€‚</li>
</ul>
<h6 id="ç»“æ„ç›¸ä¼¼">ç»“æ„ç›¸ä¼¼</h6>
<p>ä¸ºä»€ä¹ˆè¿˜éœ€è¦ç»“æ„ç›¸ä¼¼ï¼Œä¸¾ä¸ªä¾‹å­ï¼š<br />
<img src="./images/ã€Pythonè¿˜èƒ½å¹²å˜›ã€‘çˆ¬å–å¾®ä¿¡å¥½å‹å¤´åƒå®Œæˆé©¬èµ›å…‹æ‹¼å›¾ï¼ˆåƒå›¾æˆåƒï¼‰ï½5.png" /><br />
å¦‚æœå•çº¯æŒ‰ç…§ä¸Šè¿°æ–¹æ³•å»åˆ¤å®šç›¸ä¼¼ï¼Œé‚£ä¸Šå›¾ä¸­çš„å›¾Aå’Œå›¾Bè‚¯å®šæ˜¯æœ€ç›¸ä¼¼çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½å•çº¯çš„å› ä¸ºä¸¤å¼ å›¾ç‰‡ä¸­åŒ…å«çš„é¢œè‰²å·®ä¸å¤šå°±å»åˆ¤æ–­ä¸ºæœ€ç›¸ä¼¼ï¼Œè¿˜éœ€è¦å»åˆ¤æ–­é¢œè‰²çš„â€œä½ç½®â€ä¹Ÿè¦ç›¸ä¼¼ã€‚<br />
è¿™éƒ¨åˆ†å®ç°æ–¹æ³•å‚è€ƒäº†<a href="http://www.ruanyifeng.com/blog/2011/07/principle_of_similar_image_search.html">é˜®ä¸€å³°</a>çš„åšå®¢ï¼Œå…·ä½“é€»è¾‘å¦‚ä¸‹ï¼š</p>
<ol>
<li>åªéœ€è¦æå–å›¾ç‰‡ç»“æ„ï¼Œé¢œè‰²æ„ä¹‰ä¸å¤§ï¼Œä¸ºè®¡ç®—ç®€ä¾¿ï¼Œæˆ‘ä»¬ç›´æ¥å°†æ‰€æœ‰å›¾ç‰‡è½¬ä¸ºç°åº¦é€šé“ï¼›</li>
<li>å°†æ¯å¼ å¤´åƒresizeä¸ºï¼ˆ8ï¼Œ8ï¼‰ï¼Œç„¶åè®¡ç®—æ‰€æœ‰åƒç´ å€¼çš„å¹³å‡å€¼ã€‚</li>
<li>æˆ‘ä»¬æ€»å…±æœ‰64ï¼ˆå³$8*8$ï¼‰ä¸ªåƒç´ ç‚¹ï¼Œåˆ†åˆ«å»ä¸å¹³å‡å€¼æ¯”è¾ƒå¤§å°ï¼Œé«˜äºå¹³å‡å€¼çš„è®°ä¸º1ï¼Œå°äºå¹³å‡å€¼çš„è®°ä¸º0ï¼Œè¿™æ ·æˆ‘ä»¬æ¯å¼ å›¾ç‰‡éƒ½ä¼šå¾—åˆ°ä¸€ä¸ªé•¿åº¦ä¸º64ç±»ä¼¼[0,1,1,0,1,0....0,1,1]çš„â€˜<strong>ç¼–ç </strong>â€™ã€‚</li>
<li>å¯¹äºåˆ‡å‰²çš„å°å›¾ç‰‡æˆ‘ä»¬ä¹Ÿè¿›è¡Œä¸Šè¿°æ“ä½œï¼Œæ³¨æ„è¦ä¿è¯æ˜¯åŒä¸€é¡ºåºï¼ˆè­¬å¦‚ä»å·¦ä¸Šè§’åˆ°å³ä¸‹è§’ï¼‰ï¼Œç„¶ååˆ†åˆ«å»ä¸æ¯ä¸ªå¤´åƒçš„â€˜<strong>ç¼–ç </strong>â€™è¿›è¡Œæ¯”è¾ƒï¼Œè¿™è¾¹åœ¨<a href="http://www.ruanyifeng.com/blog/2011/07/principle_of_similar_image_search.html">é˜®ä¸€å³°</a>çš„åšå®¢ä¸­æ˜¯é‡‡ç”¨çš„è®¡ç®—æ±‰æ˜è·ç¦»ï¼Œæˆ‘è¿™è¾¹ä½¿ç”¨çš„å°±ç›´æ¥é€šè¿‡<code>np.equal()</code>è®¡ç®—ç›¸åŒçš„ç‚¹äº†ï¼Œå–ç›¸åŒä½æ•°æœ€å¤šçš„é‚£å¼ å¤´åƒå³ä¸ºæœ€ç›¸ä¼¼çš„å›¾ç‰‡ã€‚</li>
</ol>
<p>æˆ‘åœ¨ä»£ç ä¸­æ˜¯å…ˆç­›é€‰é¢œè‰²æœ€æ¥è¿‘çš„50å¼ å›¾ç‰‡ï¼Œç„¶åå†åœ¨è¿™50ä¸­å›¾ç‰‡å»å¯»æ‰¾ç»“æ„æœ€ç›¸ä¼¼çš„å›¾ç‰‡ï¼Œæœ€åå®ç°æ•ˆæœå¦‚ä¸‹ï¼š</p>
<ul>
<li><p>RGBé€šé“<br />
å› ä¸ºå›¾ç‰‡æºåªæœ‰500æ¥å¼ ï¼Œæ•ˆæœåªèƒ½è¯´å‡‘åˆï¼Œå‹‰å¼ºèƒ½çœ‹å‡ºæ¥æ˜¯å•¥ã€‚<br />
<img src="./images/ã€Pythonè¿˜èƒ½å¹²å˜›ã€‘çˆ¬å–å¾®ä¿¡å¥½å‹å¤´åƒå®Œæˆé©¬èµ›å…‹æ‹¼å›¾ï¼ˆåƒå›¾æˆåƒï¼‰ï½6.png" /></p></li>
<li><p>ç°åº¦<br />
<img src="./images/ã€Pythonè¿˜èƒ½å¹²å˜›ã€‘çˆ¬å–å¾®ä¿¡å¥½å‹å¤´åƒå®Œæˆé©¬èµ›å…‹æ‹¼å›¾ï¼ˆåƒå›¾æˆåƒï¼‰ï½7.png" /></p></li>
<li><p>æ”¾å¤§ä¹‹åæ˜¯è¿™ä¸ªæ•ˆæœï¼š<br />
<img src="./images/ã€Pythonè¿˜èƒ½å¹²å˜›ã€‘çˆ¬å–å¾®ä¿¡å¥½å‹å¤´åƒå®Œæˆé©¬èµ›å…‹æ‹¼å›¾ï¼ˆåƒå›¾æˆåƒï¼‰ï½8.png" /></p></li>
</ul>
<p><strong>ç„¶åä¾¿èƒ½å»æœ‹å‹åœˆæ„‰å¿«çš„è£…é€¼äº†</strong>ğŸ˜ğŸ˜ğŸ˜<br />
<img src="./images/ã€Pythonè¿˜èƒ½å¹²å˜›ã€‘çˆ¬å–å¾®ä¿¡å¥½å‹å¤´åƒå®Œæˆé©¬èµ›å…‹æ‹¼å›¾ï¼ˆåƒå›¾æˆåƒï¼‰ï½9.png" /></p>
<ul>
<li><strong><em>Talk is cheap, show me the code.</em></strong></li>
</ul>
<pre><code><code>#!/usr/bin/env python
# -*- coding: utf-8 -*-
# @Author  : AwesomeTang
# @Version : Python 3.7
# @Time    : 2019-06-23 13:52


from PIL import Image
import os
import numpy as np
from tqdm import tqdm


class Config:
    corp_size = 40
    filter_size = 20
    num = 100


class PicMerge:

    def __init__(self, pic_path, mode=&#39;RGB&#39;, pic_folder=&#39;wechat&#39;):
        if mode.upper() not in (&#39;RGB&#39;, &#39;L&#39;):
            raise ValueError(&#39;Only accept &quot;RGB&quot; or &quot;L&quot; MODE, but we received &quot;{}&quot;.&#39;.format(self.mode))
        else:
            self.mode = mode.upper()
        print(&#39;Coding for every picture in folder &quot;{}&quot;.&#39;.format(pic_folder))
        self.mapping_table, self.pictures = self.mapping_table(pic_folder)
        self.picture = self.resize_pic(pic_path).convert(self.mode)

    @staticmethod
    def resize_pic(pic_path):
        picture = Image.open(pic_path)
        width, height = picture.size
        to_width = Config.corp_size * Config.num
        to_height = ((to_width / width) * height // Config.corp_size) * Config.corp_size
        picture = picture.resize((int(to_width), int(to_height)), Image.ANTIALIAS)
        return picture

    def merge(self):
        width, height = self.picture.size
        w_times, h_times = int(width / Config.corp_size), int(height / Config.corp_size)
        picture = np.array(self.picture)
        print(&#39;Corp &amp; Merge...&#39;)
        for i in tqdm(range(w_times), desc=&#39;CORP&#39;):
            for j in range(h_times):
                if self.mode == &#39;L&#39;:
                    section = picture[j * Config.corp_size:(j + 1) * Config.corp_size,
                                      i * Config.corp_size:(i + 1) * Config.corp_size]
                    section_mean = section.mean()
                    candidate = sorted([(key_, abs(np.array(value_).mean() - section_mean))
                                        for key_, value_ in self.pictures.items()],
                                       key=lambda item: item[1])[:Config.filter_size]
                    most_similar = self.structure_similarity(section, candidate)
                    picture[j * Config.corp_size:(j + 1) * Config.corp_size,
                            i * Config.corp_size:(i + 1) * Config.corp_size] = most_similar
                elif self.mode == &#39;RGB&#39;:
                    section = picture[j * Config.corp_size:(j + 1) * Config.corp_size,
                                      i * Config.corp_size:(i + 1) * Config.corp_size, :]
                    candidate = self.color_similarity(section)
                    most_similar = self.structure_similarity(section, candidate)
                    picture[j * Config.corp_size:(j + 1) * Config.corp_size,
                            i * Config.corp_size:(i + 1) * Config.corp_size, :] = most_similar

        picture = Image.fromarray(picture)
        picture.show()
        picture.save(&#39;result.jpg&#39;)
        print(&#39;Work Done...&#39;)

    def structure_similarity(self, section, candidate):
        section = Image.fromarray(section).convert(&#39;L&#39;)
        one_hot = self.pic_code(np.array(section.resize((8, 8), Image.ANTIALIAS)))
        candidate = [(key_, np.equal(one_hot, self.mapping_table[key_]).mean()) for key_, _ in candidate]
        most_similar = max(candidate, key=lambda item: item[1])
        return self.pictures[most_similar[0]]

    def color_similarity(self, pic_slice, top_n=Config.filter_size):
        slice_mean = self.rgb_mean(pic_slice)
        diff_list = [(key_, np.linalg.norm(slice_mean - self.rgb_mean(value_)))
                     for key_, value_ in self.pictures.items()]
        filter_ = sorted(diff_list, key=lambda item: item[1])[:top_n]
        return filter_

    @staticmethod
    def rgb_mean(rgb_pic):
        &quot;&quot;&quot;
        if picture is RGB channel, calculate average [R, G, B].
        &quot;&quot;&quot;
        r_mean = np.mean(rgb_pic[:, :, 0])
        g_mean = np.mean(rgb_pic[:, :, 1])
        b_mean = np.mean(rgb_pic[:, :, 2])
        val = np.array([r_mean, g_mean, b_mean])
        return val

    def mapping_table(self, pic_folder):
        &quot;&quot;&quot;
        What this function do?
        1. transverse every image in PIC_FOLDER;
        2. resize every image in (8, 8) and covert into GREY;
        3. CODE for every image, CODE like [1, 0, 1, 1, 0....1]
        4. build a dict to gather all image and its CODE.
        :param pic_folder: path of pictures folder.
        :return: a dict
        &quot;&quot;&quot;
        suffix = [&#39;jpg&#39;, &#39;jpeg&#39;, &#39;JPG&#39;, &#39;JPEG&#39;, &#39;gif&#39;, &#39;GIF&#39;, &#39;png&#39;, &#39;PNG&#39;]
        if not os.path.isdir(pic_folder):
            raise OSError(&#39;Folder [{}] is not exist, please check.&#39;.format(pic_folder))

        pic_list = os.listdir(pic_folder)
        results = {}
        pic_dic = {}
        for idx, pic in tqdm(enumerate(pic_list), desc=&#39;CODE&#39;):
            if pic.split(&#39;.&#39;)[-1] in suffix:
                path = os.path.join(pic_folder, pic)
                try:
                    img = Image.open(path).resize((Config.corp_size, Config.corp_size), Image.ANTIALIAS)
                    results[idx] = self.pic_code(np.array(img.convert(&#39;L&#39;).resize((8, 8), Image.ANTIALIAS)))
                    if self.mode == &#39;RGB&#39;:
                        pic_dic[idx] = np.array(img.convert(self.mode))
                    else:
                        pic_dic[idx] = np.array(img.convert(self.mode))
                except OSError:
                    pass
        return results, pic_dic

    @staticmethod
    def pic_code(image: np.ndarray):
        &quot;&quot;&quot;
        To make a one-hot code for IMAGE.
        AVG is mean of the array(IMAGE).
        Traverse every pixel of IMAGE, if the pixel value is more then AVG, make it 1, else 0.
        :param image: an array of picture
        :return: A sparse list with length [picture&#39;s width * picture&#39;s height].
        &quot;&quot;&quot;
        width, height = image.shape
        avg = image.mean()
        one_hot = np.array([1 if image[i, j] &gt; avg else 0 for i in range(width) for j in range(height)])
        return one_hot


if __name__ == &quot;__main__&quot;:
    P = PicMerge(pic_path=&#39;æµ·è´¼ç‹.jpeg&#39;, mode=&#39;RGB&#39;)
    P.merge()
</code></pre>
<hr />
<blockquote>
<p>å‚è€ƒèµ„æ–™</p>
<ol>
<li>ç›¸ä¼¼å›¾ç‰‡æœç´¢çš„åŸç† ï¼š<a href="http://www.ruanyifeng.com/blog/2011/07/principle_of_similar_image_search.html">ç‚¹æˆ‘è·³è½¬</a></li>
</ol>
</blockquote>
<p><strong><em>skr~~ skr~~~</em></strong></p>

</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>