<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修Django之ORM-model模型属性' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>Django之ORM-model模型属性</center></div><div class='banquan'>原文出处:本文由博客园博主YifChan提供。<br/>
原文连接:https://www.cnblogs.com/yifchan/p/python-1-25.html</div><br>
    <p>Django1.8.2中文文档：<a href="https://yiyibooks.cn/xx/django_182/index.html" target="_blank">Django1.8.2中文文档</a>&nbsp;或者 https://yiyibooks.cn/xx/django_182/index.html</p>
<h2>项目准备</h2>
<div class="cnblogs_code">
<pre><code>注释：关于项目准备，其实和后面的大部分内容都无关，或者说，可以不看，但为了自己和他人更好的体验，还是放上去。</pre>
</div>
<h3>创建项目</h3>
<p>1.创建项目test1000；</p>
<p>2.创建应用booktest；</p>
<p>注册应用：</p>
<div class="cnblogs_code">
<pre><code>INSTALLED_APPS =<span style="color: #000000;"> [
    </span><span style="color: #800000;">'</span><span style="color: #800000;">booktest.apps.BooktestConfig</span><span style="color: #800000;">'</span><span style="color: #000000;">,
]</span></pre>
</div>
<p>&nbsp;</p>
<p>3.创建数据库</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">create</span> <span style="color: #0000ff;">database</span> test1000 <span style="color: #0000ff;">default</span> charset utf8;</pre>
</div>
<p>在settings文件下配置数据库</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('5a74e246-d22a-4590-aba6-b4e47024b8c0')"><img id="code_img_closed_5a74e246-d22a-4590-aba6-b4e47024b8c0" class="code_img_closed" src="./images/Django之ORM-model模型属性0.png" alt="" /><img id="code_img_opened_5a74e246-d22a-4590-aba6-b4e47024b8c0" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('5a74e246-d22a-4590-aba6-b4e47024b8c0',event)" src="./images/Django之ORM-model模型属性1.png" alt="" />
<div id="cnblogs_code_open_5a74e246-d22a-4590-aba6-b4e47024b8c0" class="cnblogs_code_hide">
<pre><code>DATABASES =<span style="color: #000000;"> {
    </span><span style="color: #800000;">'</span><span style="color: #800000;">default</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
        </span><span style="color: #008000;">#</span><span style="color: #008000;"> 'ENGINE': 'django.db.backends.sqlite3',</span>
        <span style="color: #800000;">'</span><span style="color: #800000;">ENGINE</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">django.db.backends.mysql</span><span style="color: #800000;">'</span><span style="color: #000000;">,
        </span><span style="color: #008000;">#</span><span style="color: #008000;"> 'NAME': os.path.join(BASE_DIR, 'db.sqlite3'),</span>
        <span style="color: #800000;">'</span><span style="color: #800000;">NAME</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">test1000</span><span style="color: #800000;">'</span>,  <span style="color: #008000;">#</span><span style="color: #008000;"> 使用的数据库的名字，数据库必须手动创建</span>
        <span style="color: #800000;">'</span><span style="color: #800000;">USER</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">root</span><span style="color: #800000;">'</span>,  <span style="color: #008000;">#</span><span style="color: #008000;"> 链接mysql的用户名</span>
        <span style="color: #800000;">'</span><span style="color: #800000;">PASSWORD</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">root</span><span style="color: #800000;">'</span>,  <span style="color: #008000;">#</span><span style="color: #008000;"> 对应用户的密码</span>
        <span style="color: #800000;">'</span><span style="color: #800000;">HOST</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">127.0.0.1</span><span style="color: #800000;">'</span>,  <span style="color: #008000;">#</span><span style="color: #008000;"> 指定mysql数据库所在电脑ip</span>
        <span style="color: #800000;">'</span><span style="color: #800000;">PORT</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">3306</span><span style="color: #800000;">'</span>,  <span style="color: #008000;">#</span><span style="color: #008000;"> mysql服务的端口号</span>
<span style="color: #000000;">    }
}</span></pre>
</div>
<span class="cnblogs_code_collapse">数据库配置</span></div>
<p>&nbsp;</p>
<p>4.在test1000/__init__.py中加如下内容：<br />注意：如果没有pymysql需要先pip install</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">import</span><span style="color: #000000;"> pymysql
pymysql.install_as_MySQLdb()</span></pre>
</div>
<p>&nbsp;</p>
<p>5.定义模型类</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('6809a118-c25f-4374-9a05-8c991ce1474d')"><img id="code_img_closed_6809a118-c25f-4374-9a05-8c991ce1474d" class="code_img_closed" src="./images/Django之ORM-model模型属性0.png" alt="" /><img id="code_img_opened_6809a118-c25f-4374-9a05-8c991ce1474d" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('6809a118-c25f-4374-9a05-8c991ce1474d',event)" src="./images/Django之ORM-model模型属性1.png" alt="" />
<div id="cnblogs_code_open_6809a118-c25f-4374-9a05-8c991ce1474d" class="cnblogs_code_hide">
<pre><code><span style="color: #0000ff;">class</span><span style="color: #000000;"> BookInfo(models.Model):
    </span><span style="color: #800000;">"""</span><span style="color: #800000;">图书模型类</span><span style="color: #800000;">"""</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> 图书名称</span>
    btitle = models.CharField(max_length=20<span style="color: #000000;">)
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 出版日期</span>
    bpub_date =<span style="color: #000000;"> models.DateField()
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 阅读量</span>
    bread = models.IntegerField(default=<span style="color: #000000;">0)
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 评论量</span>
    bcomment = models.IntegerField(default=<span style="color: #000000;">0)
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 删除标记</span>
    isDelete = models.BooleanField(default=<span style="color: #000000;">False)


</span><span style="color: #0000ff;">class</span><span style="color: #000000;"> HeroInfo(models.Model):
    </span><span style="color: #800000;">"""</span><span style="color: #800000;">图书模型类</span><span style="color: #800000;">"""</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> 英雄名</span>
    hname = models.CharField(max_length=20<span style="color: #000000;">)
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 性别</span>
    hgender = models.BooleanField(default=<span style="color: #000000;">False)
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 备注</span>
    hcomment = models.CharField(max_length=200<span style="color: #000000;">)
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 关系属性</span>
    bhbook = models.ForeignKey(to=<span style="color: #800000;">"</span><span style="color: #800000;">BookInfo</span><span style="color: #800000;">"</span><span style="color: #000000;">)
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 删除标记</span>
    isDelete = models.BooleanField(default=False)</pre>
</div>
<span class="cnblogs_code_collapse">定义图书和英雄类</span></div>
<p>生成迁移数据</p>
<div class="cnblogs_code">
<pre><code><span style="color: #000000;">python manage.py makemigrations
python manage.py migrate</span></pre>
</div>
<p>插入数据</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('b592f16e-d985-4937-b9f7-9839a2447119')"><img id="code_img_closed_b592f16e-d985-4937-b9f7-9839a2447119" class="code_img_closed" src="./images/Django之ORM-model模型属性0.png" alt="" /><img id="code_img_opened_b592f16e-d985-4937-b9f7-9839a2447119" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('b592f16e-d985-4937-b9f7-9839a2447119',event)" src="./images/Django之ORM-model模型属性1.png" alt="" />
<div id="cnblogs_code_open_b592f16e-d985-4937-b9f7-9839a2447119" class="cnblogs_code_hide">
<pre><code><span style="color: #0000ff;">INSERT</span> <span style="color: #0000ff;">INTO</span> `test1000`.`booktest_bookinfo` (`btitle`, `bpub_date`, `bread`, `bcomment`, `isDelete`) <span style="color: #0000ff;">VALUES</span> (<span style="color: #ff0000;">'</span><span style="color: #ff0000;">射雕英雄传</span><span style="color: #ff0000;">'</span>, <span style="color: #ff0000;">'</span><span style="color: #ff0000;">1980-05-01</span><span style="color: #ff0000;">'</span>, <span style="color: #800000; font-weight: bold;">12</span>, <span style="color: #800000; font-weight: bold;">34</span>, <span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">INSERT</span> <span style="color: #0000ff;">INTO</span> `test1000`.`booktest_bookinfo` (`btitle`, `bpub_date`, `bread`, `bcomment`, `isDelete`) <span style="color: #0000ff;">VALUES</span> (<span style="color: #ff0000;">'</span><span style="color: #ff0000;">天龙八部</span><span style="color: #ff0000;">'</span>, <span style="color: #ff0000;">'</span><span style="color: #ff0000;">1986-07-24</span><span style="color: #ff0000;">'</span>, <span style="color: #800000; font-weight: bold;">36</span>, <span style="color: #800000; font-weight: bold;">40</span>, <span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">INSERT</span> <span style="color: #0000ff;">INTO</span> `test1000`.`booktest_bookinfo` (`btitle`, `bpub_date`, `bread`, `bcomment`, `isDelete`) <span style="color: #0000ff;">VALUES</span> (<span style="color: #ff0000;">'</span><span style="color: #ff0000;">笑傲江湖</span><span style="color: #ff0000;">'</span>, <span style="color: #ff0000;">'</span><span style="color: #ff0000;">1995-12-24</span><span style="color: #ff0000;">'</span>, <span style="color: #800000; font-weight: bold;">20</span>, <span style="color: #800000; font-weight: bold;">80</span>, <span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">INSERT</span> <span style="color: #0000ff;">INTO</span> `test1000`.`booktest_bookinfo` (`btitle`, `bpub_date`, `bread`, `bcomment`, `isDelete`) <span style="color: #0000ff;">VALUES</span> (<span style="color: #ff0000;">'</span><span style="color: #ff0000;">雪山飞狐</span><span style="color: #ff0000;">'</span>, <span style="color: #ff0000;">'</span><span style="color: #ff0000;">1987-11-11</span><span style="color: #ff0000;">'</span>, <span style="color: #800000; font-weight: bold;">58</span>, <span style="color: #800000; font-weight: bold;">24</span>, <span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">)


</span><span style="color: #0000ff;">INSERT</span> <span style="color: #0000ff;">INTO</span> `test1000`.`booktest_heroinfo` (`hname`, `hgender`, `hbook_id`, `hcomment`, `isDelete`) <span style="color: #0000ff;">VALUES</span><span style="color: #000000;">
(</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">郭靖</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">1</span>,<span style="color: #800000; font-weight: bold;">1</span>,<span style="color: #ff0000;">'</span><span style="color: #ff0000;">降龙十八掌</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">),
(</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">黄蓉</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span>,<span style="color: #800000; font-weight: bold;">1</span>,<span style="color: #ff0000;">'</span><span style="color: #ff0000;">打狗棍法</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">),
(</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">黄药师</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">1</span>,<span style="color: #800000; font-weight: bold;">1</span>,<span style="color: #ff0000;">'</span><span style="color: #ff0000;">弹指神通</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">),
(</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">欧阳锋</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">1</span>,<span style="color: #800000; font-weight: bold;">1</span>,<span style="color: #ff0000;">'</span><span style="color: #ff0000;">蛤蟆功</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">),
(</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">梅超风</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span>,<span style="color: #800000; font-weight: bold;">1</span>,<span style="color: #ff0000;">'</span><span style="color: #ff0000;">九阴白骨爪</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">),
(</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">乔峰</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">1</span>,<span style="color: #800000; font-weight: bold;">2</span>,<span style="color: #ff0000;">'</span><span style="color: #ff0000;">降龙十八掌</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">),
(</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">段誉</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">1</span>,<span style="color: #800000; font-weight: bold;">2</span>,<span style="color: #ff0000;">'</span><span style="color: #ff0000;">六脉神剑</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">),
(</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">虚竹</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">1</span>,<span style="color: #800000; font-weight: bold;">2</span>,<span style="color: #ff0000;">'</span><span style="color: #ff0000;">天山六阳掌</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">),
(</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">王语嫣</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span>,<span style="color: #800000; font-weight: bold;">2</span>,<span style="color: #ff0000;">'</span><span style="color: #ff0000;">神仙姐姐</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">),
(</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">令狐冲</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">1</span>,<span style="color: #800000; font-weight: bold;">3</span>,<span style="color: #ff0000;">'</span><span style="color: #ff0000;">独孤九剑</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">),
(</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">任盈盈</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span>,<span style="color: #800000; font-weight: bold;">3</span>,<span style="color: #ff0000;">'</span><span style="color: #ff0000;">弹琴</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">),
(</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">岳不群</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">1</span>,<span style="color: #800000; font-weight: bold;">3</span>,<span style="color: #ff0000;">'</span><span style="color: #ff0000;">华山剑法</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">),
(</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">东方不败</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span>,<span style="color: #800000; font-weight: bold;">3</span>,<span style="color: #ff0000;">'</span><span style="color: #ff0000;">葵花宝典</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">),
(</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">胡斐</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">1</span>,<span style="color: #800000; font-weight: bold;">4</span>,<span style="color: #ff0000;">'</span><span style="color: #ff0000;">胡家刀法</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">),
(</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">苗若兰</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span>,<span style="color: #800000; font-weight: bold;">4</span>,<span style="color: #ff0000;">'</span><span style="color: #ff0000;">黄衣</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">),
(</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">程灵素</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span>,<span style="color: #800000; font-weight: bold;">4</span>,<span style="color: #ff0000;">'</span><span style="color: #ff0000;">医术</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">),
(</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">袁紫衣</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span>,<span style="color: #800000; font-weight: bold;">4</span>,<span style="color: #ff0000;">'</span><span style="color: #ff0000;">六合拳</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">0</span>);</pre>
</div>
<span class="cnblogs_code_collapse">插入数据</span></div>
<p>&nbsp;</p>
<p>6.index页面显示书籍</p>
<p>创建模板templates文件夹；<br />去settings里面注册模板文件夹；<br />创建index页面；</p>
<p>编写index页面，使用ul渲染书籍数据；<br />给index添加a标签指向create路由；</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('5b3c605b-aa25-4699-b979-316fb8e00ebd')"><img id="code_img_closed_5b3c605b-aa25-4699-b979-316fb8e00ebd" class="code_img_closed" src="./images/Django之ORM-model模型属性0.png" alt="" /><img id="code_img_opened_5b3c605b-aa25-4699-b979-316fb8e00ebd" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('5b3c605b-aa25-4699-b979-316fb8e00ebd',event)" src="./images/Django之ORM-model模型属性1.png" alt="" />
<div id="cnblogs_code_open_5b3c605b-aa25-4699-b979-316fb8e00ebd" class="cnblogs_code_hide">
<pre><code>&lt;h2&gt;index页面&lt;/h2&gt;
&lt;a href=<span style="color: #800000;">"</span><span style="color: #800000;">/create</span><span style="color: #800000;">"</span>&gt;添加&lt;/a&gt;
&lt;ul&gt;<span style="color: #000000;">
    {</span>% <span style="color: #0000ff;">for</span> book <span style="color: #0000ff;">in</span> books %<span style="color: #000000;">}
        </span>&lt;li&gt;{{ book.btitle }}&lt;/li&gt;<span style="color: #000000;">
    {</span>% endfor %<span style="color: #000000;">}
</span>&lt;/ul&gt;</pre>
</div>
<span class="cnblogs_code_collapse">index.html</span></div>
<p>&nbsp;</p>
<p>编写函数，使用模板渲染显示书籍的页面<br />编写index函数，返回页面渲染；</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('1b478869-f07d-43be-b9d2-49e50ef92a5f')"><img id="code_img_closed_1b478869-f07d-43be-b9d2-49e50ef92a5f" class="code_img_closed" src="./images/Django之ORM-model模型属性0.png" alt="" /><img id="code_img_opened_1b478869-f07d-43be-b9d2-49e50ef92a5f" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('1b478869-f07d-43be-b9d2-49e50ef92a5f',event)" src="./images/Django之ORM-model模型属性1.png" alt="" />
<div id="cnblogs_code_open_1b478869-f07d-43be-b9d2-49e50ef92a5f" class="cnblogs_code_hide">
<pre><code><span style="color: #0000ff;">def</span><span style="color: #000000;"> index(request):
    </span><span style="color: #800000;">"""</span><span style="color: #800000;">显示书籍</span><span style="color: #800000;">"""</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> 获取所有书名</span>
    books =<span style="color: #000000;"> models.BookInfo.objects.all()
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 使用模板渲染书籍</span>
    <span style="color: #0000ff;">return</span> render(request, <span style="color: #800000;">"</span><span style="color: #800000;">booktest/index.html</span><span style="color: #800000;">"</span>, {<span style="color: #800000;">"</span><span style="color: #800000;">books</span><span style="color: #800000;">"</span>: books})</pre>
</div>
<span class="cnblogs_code_collapse">index函数</span></div>
<p>&nbsp;</p>
<p>进行url匹配；<br />将路由导向booktest里面的路由文件；</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('158667e0-7a9f-4f76-9fe5-bdc2623f9d75')"><img id="code_img_closed_158667e0-7a9f-4f76-9fe5-bdc2623f9d75" class="code_img_closed" src="./images/Django之ORM-model模型属性0.png" alt="" /><img id="code_img_opened_158667e0-7a9f-4f76-9fe5-bdc2623f9d75" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('158667e0-7a9f-4f76-9fe5-bdc2623f9d75',event)" src="./images/Django之ORM-model模型属性1.png" alt="" />
<div id="cnblogs_code_open_158667e0-7a9f-4f76-9fe5-bdc2623f9d75" class="cnblogs_code_hide">
<pre><code><span style="color: #0000ff;">from</span> django.conf.urls <span style="color: #0000ff;">import</span><span style="color: #000000;"> include, url
</span><span style="color: #0000ff;">from</span> django.contrib <span style="color: #0000ff;">import</span><span style="color: #000000;"> admin

urlpatterns </span>=<span style="color: #000000;"> [
    url(r</span><span style="color: #800000;">'</span><span style="color: #800000;">^admin/</span><span style="color: #800000;">'</span><span style="color: #000000;">, admin.site.urls),
    url(r</span><span style="color: #800000;">'</span><span style="color: #800000;">^</span><span style="color: #800000;">'</span>, include(<span style="color: #800000;">'</span><span style="color: #800000;">booktest.urls</span><span style="color: #800000;">'</span>)),  <span style="color: #008000;">#</span><span style="color: #008000;"> 包含booktest应用中的路由文件</span>
]</pre>
</div>
<span class="cnblogs_code_collapse">test1000/url.py</span></div>
<p>主要路由统一写在此处，不再重复写</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> booktest/url.py</span>

<span style="color: #0000ff;">from</span> django.conf.urls <span style="color: #0000ff;">import</span><span style="color: #000000;"> url
</span><span style="color: #0000ff;">from</span> booktest <span style="color: #0000ff;">import</span><span style="color: #000000;"> views

urlpatterns </span>=<span style="color: #000000;"> [
    url(r</span><span style="color: #800000;">'</span><span style="color: #800000;">^index/</span><span style="color: #800000;">'</span>, views.index),  <span style="color: #008000;">#</span><span style="color: #008000;"> 显示图书信息</span>
    url(r<span style="color: #800000;">'</span><span style="color: #800000;">^create/</span><span style="color: #800000;">'</span>, views.create),  <span style="color: #008000;">#</span><span style="color: #008000;"> 添加一本书籍</span>
    url(r<span style="color: #800000;">'</span><span style="color: #800000;">^delete(\d+)/</span><span style="color: #800000;">'</span>, views.delete),  <span style="color: #008000;">#</span><span style="color: #008000;"> 删除一本书籍</span>
    url(r<span style="color: #800000;">'</span><span style="color: #800000;">^areas/$</span><span style="color: #800000;">'</span>, views.areas),  <span style="color: #008000;">#</span><span style="color: #008000;"> 自关联案例</span>
]</pre>
</div>
<p>&nbsp;</p>
<p>7.进行书籍添加处理<br />编写create函数，创建bookinfo对象，保存数据，导入redirect，给create函数返回redirect到/index页面；</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('ba816a04-583a-40ad-856f-3e95aff95cae')"><img id="code_img_closed_ba816a04-583a-40ad-856f-3e95aff95cae" class="code_img_closed" src="./images/Django之ORM-model模型属性0.png" alt="" /><img id="code_img_opened_ba816a04-583a-40ad-856f-3e95aff95cae" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('ba816a04-583a-40ad-856f-3e95aff95cae',event)" src="./images/Django之ORM-model模型属性1.png" alt="" />
<div id="cnblogs_code_open_ba816a04-583a-40ad-856f-3e95aff95cae" class="cnblogs_code_hide">
<pre><code><span style="color: #0000ff;">def</span><span style="color: #000000;"> create(request):
    </span><span style="color: #800000;">"""</span><span style="color: #800000;">增加一本书籍</span><span style="color: #800000;">"""</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> 1.创建bookinfo对象</span>
    b =<span style="color: #000000;"> models.BookInfo()
    b.btitle </span>= <span style="color: #800000;">"</span><span style="color: #800000;">流星蝴蝶剑</span><span style="color: #800000;">"</span><span style="color: #000000;">
    b.bpub_date </span>= date(1990, 1, 1<span style="color: #000000;">)
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 2.保存进数据库</span>
<span style="color: #000000;">    b.save()
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 3.返回应答,让浏览器再访问首页</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> return HttpResponse("ok")</span>
    <span style="color: #0000ff;">return</span> redirect(<span style="color: #800000;">'</span><span style="color: #800000;">/index</span><span style="color: #800000;">'</span>)</pre>
</div>
<span class="cnblogs_code_collapse">create函数</span></div>
<p>给create函数进行路由匹配；</p>
<p>&nbsp;</p>
<p>8.进行删除书籍处理<br />给图书后面添加删除链接，链接应加上书籍id；</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">a </span><span style="color: #ff0000;">href</span><span style="color: #0000ff;">="/create"</span><span style="color: #0000ff;">&gt;</span>添加<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">a</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">ul</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
    {% for book in books %}
        </span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">li</span><span style="color: #0000ff;">&gt;</span>{{ book.btitle }}--<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">a </span><span style="color: #ff0000;">href</span><span style="color: #0000ff;">="/delete{{ book.id }}"</span><span style="color: #0000ff;">&gt;</span>删除<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">a</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">li</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
    {% endfor %}
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">ul</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>编写delete函数；</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('e9a44122-862a-480b-8f57-cfe173a23c8e')"><img id="code_img_closed_e9a44122-862a-480b-8f57-cfe173a23c8e" class="code_img_closed" src="./images/Django之ORM-model模型属性0.png" alt="" /><img id="code_img_opened_e9a44122-862a-480b-8f57-cfe173a23c8e" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('e9a44122-862a-480b-8f57-cfe173a23c8e',event)" src="./images/Django之ORM-model模型属性1.png" alt="" />
<div id="cnblogs_code_open_e9a44122-862a-480b-8f57-cfe173a23c8e" class="cnblogs_code_hide">
<pre><code><span style="color: #0000ff;">def</span><span style="color: #000000;"> delete(request, bid):
    </span><span style="color: #800000;">"""</span><span style="color: #800000;">删除一本书籍</span><span style="color: #800000;">"""</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> 1.获取书籍对象</span>
    book = models.BookInfo.objects.get(id=<span style="color: #000000;">bid)
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 2.删除书籍</span>
<span style="color: #000000;">    book.delete()
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 3.重定向</span>
    <span style="color: #0000ff;">return</span> redirect(<span style="color: #800000;">'</span><span style="color: #800000;">/index</span><span style="color: #800000;">'</span>)</pre>
</div>
<span class="cnblogs_code_collapse">delete函数</span></div>
<p>进行路由匹配，注意路由匹配时应接收书籍id；即：</p>
<div class="cnblogs_code">
<pre><code>url(r<span style="color: #800000;">'</span><span style="color: #800000;">^delete(\d+)/</span><span style="color: #800000;">'</span>, views.delete),  <span style="color: #008000;">#</span><span style="color: #008000;"> 删除一本书籍</span></pre>
</div>
<p>&nbsp;</p>
<h4>a标签中url的/</h4>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">a </span><span style="color: #ff0000;">href</span><span style="color: #0000ff;">="/create"</span><span style="color: #0000ff;">&gt;</span>添加<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">a</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>a标签记得前面统一加上/；<br />没加斜杠的，表示在当前的路由下进行拼接，比如现在在是http://127.0.0.1:8000/index，路由是create，那么就会拼接成/index/create;<br />而加了斜杠就不会出现这个问题，斜杠表示http://127.0.0.1:8000/，会直接拼接到根路由下；</p>
<p>&nbsp;</p>
<h4>Django ORM</h4>
<ul>
<li>O：(objects)-&gt;类和对象。</li>
<li>R：(Relation)-&gt;关系，关系数据库中的表格。</li>
<li>M：（Mapping）-&gt;映射。</li>






</ul>
<p>ORM框架的功能：</p>
<ul>
<li>a)能够允许我们通过面向对象的方式来操作数据库。</li>
<li>b)可以根据我们设计的模型类帮我们自动生成数据库中的表格。</li>
<li>c) 通过方便的配置就可以进行数据库的切换。</li>






</ul>
<p>&nbsp;</p>
<h2>字段属性和选项</h2>
<h3>模型类属性命名限制</h3>
<ul>
<li>1）不能是python的保留关键字。</li>
<li>2）不允许使用连续的下划线，这是由django的查询方式决定的。</li>
<li>3）定义属性时需要指定字段类型，通过字段类型的参数指定选项，语法如下：属性名=models.字段类型(选项)</li>






</ul>
<h3>字段类型</h3>
<p>使用时需要引入django.db.models包，字段类型如下：</p>
<table style="height: 617px; width: 706px;" border="0">
<tbody>
<tr>
<td>
<p>类型</p>






</td>
<td>
<p>描述</p>






</td>






</tr>
<tr>
<td>
<p>AutoField</p>






</td>
<td>自动增长的IntegerField，通常不用指定，不指定时Django会自动创建属性名为id的自动增长属性。</td>






</tr>
<tr>
<td>BooleanField</td>
<td>布尔字段，值为True或False。</td>






</tr>
<tr>
<td>NullBooleanField</td>
<td>支持Null、True、False三种值。</td>






</tr>
<tr>
<td>CharField(max_length=字符长度)</td>
<td>
<p>字符串。参数max_length表示最大字符个数。<br /><br /></p>






</td>






</tr>
<tr>
<td>TextField</td>
<td>大文本字段，一般超过4000个字符时使用。</td>






</tr>
<tr>
<td>IntegerField</td>
<td>整数。</td>






</tr>
<tr>
<td>DecimalField(max_digits=None, decimal_places=None)</td>
<td>
<p>十进制浮点数。</p>
<p>参数max_digits表示总位数。参数decimal_places表示小数位数。</p>






</td>






</tr>
<tr>
<td>FloatField</td>
<td>浮点数。参数同上，精确度不如上面的。</td>






</tr>
<tr>
<td>FileField</td>
<td>上传文件字段。</td>






</tr>
<tr>
<td>ImageField</td>
<td>继承于FileField，对上传的内容进行校验，确保是有效的图片。</td>






</tr>
<tr>
<td>DateField</td>
<td>
<p>日期。年月日<br />	参数auto_now表示每次保存对象时，自动设置该字段为当前时间，用于"最后一次修改"的时间戳，它总是使用当前日期，默认为false。  <br />	参数auto_now_add表示当对象第一次被创建时自动设置当前时间，用于创建的时间戳，它总是使用当前日期，默认为false。<br />	参数auto_now_add和auto_now是相互排斥的，组合将会发生错误。</p>






</td>






</tr>
<tr>
<td>TimeField</td>
<td>时间，参数同DateField。小时分秒</td>






</tr>
<tr>
<td>DateTimeField</td>
<td>日期时间，参数同DateField。年月日时分秒</td>






</tr>






</tbody>






</table>
<p>&nbsp;</p>
<h3>&nbsp;选项</h3>
<p>通过选项实现对字段的约束，选项如下：</p>
<table style="height: 184px; width: 690px;" border="0">
<tbody>
<tr>
<td>选项名</td>
<td>描述</td>





</tr>
<tr>
<td>default</td>
<td>默认值。</td>





</tr>
<tr>
<td>primary_key</td>
<td>若为True，则该字段会成为模型的主键字段，默认值是False，一般作为AutoField的选项使用。</td>





</tr>
<tr>
<td>unique</td>
<td>如果为True, 这个字段在表中必须有唯一值，默认值是False。</td>





</tr>
<tr>
<td>db_index</td>
<td>若值为True, 则在表中会为此字段创建索引，默认值是False。</td>





</tr>
<tr>
<td>db_column</td>
<td>字段的名称，如果未指定，则使用属性的名称。</td>





</tr>
<tr>
<td>null</td>
<td>如果为True，表示允许为空，默认值是False。</td>





</tr>
<tr>
<td>blank</td>
<td>如果为True，则该字段允许为空白，默认值是False。</td>





</tr>





</tbody>





</table>
<p>对比：null是数据库范畴的概念，blank是表单验证证范畴的。</p>
<p>经验：当修改模型类之后，如果添加的选项不影响表的结构，则不需要重新做迁移，例如商品的选项中default和blank不影响表的结构；</p>
<p>如果想要更深入的了解模型的选型和字段，建议看官方文档，百度Django1.8.2.中文文档即可。</p>
<p>&nbsp;</p>
<h2>单表查询</h2>
<h3>配置MySQL的日志文件</h3>
<p>让其产生mysql.log，即是mysql的日志文件，里面记录了对mysql数据库的操作记录。<br />1).使用下面的命令打开mysql的配置文件，取消68,69行的注释，然后保存。</p>
<div class="cnblogs_code">
<pre><code>sudo vi /etc/mysql/mysql.conf.d/mysqld.cnf</pre>
</div>
<p>2).重启mysql服务，就会产生mysql日志文件。</p>
<div class="cnblogs_code">
<pre><code>sudo service mysql restart</pre>
</div>
<p>3).打开mysql的日志文件</p>
<div class="cnblogs_code">
<pre><code>/var/log/mysql/mysql.log <span style="color: #008000;">#</span><span style="color: #008000;"> mysql日志文件所在位置</span></pre>
</div>
<p>4).使用下面命令实时查看mysql文件的内容</p>
<div class="cnblogs_code">
<pre><code>sudo tail -f /var/log/mysql/mysql.log</pre>
</div>
<p>&nbsp;</p>
<h3>查询函数</h3>
<p>通过模型类.object属性可以调用如下函数，实现对模型类对应的数据表的查询；<br />注意，查询集里面，还可以再次调用一下函数进行处理，即如果你通过filter等函数查询出来的数据，还可以调用filter等函数进行处理；</p>
<table style="height: 220px; width: 737px;" border="0">
<tbody>
<tr>
<td>函数名</td>
<td>功能</td>
<td>返回值</td>
<td>备注</td>





</tr>
<tr>
<td>get()</td>
<td>返回表中满足条件的一条且只能有一条数据</td>
<td>返回对象；</td>
<td>
<p>如果查到多条数据，则抛异常：MultipleObjectsReturned<br />	查询不到数据，则抛异常：DoesNotExist</p>





</td>





</tr>
<tr>
<td>all()</td>
<td>返回模型类对应表格中的所有数据。</td>
<td>QuerySet类型</td>
<td>查询集</td>





</tr>
<tr>
<td>filter()</td>
<td>返回满足条件的数据</td>
<td>QuerySet类型</td>
<td>
<p>参数写查询条件；</p>
<p>条件格式：模型类属性名__条件名=值。</p>





</td>





</tr>
<tr>
<td>exclude</td>
<td>返回不满足条件的数据</td>
<td>QuerySet类型</td>
<td>参数写查询条件；</td>





</tr>
<tr>
<td>order_by</td>
<td>对查询结果进行排序。</td>
<td>QuerySet类型</td>
<td>参数中写根据哪些字段进行排序。</td>





</tr>





</tbody>





</table>
<p>&nbsp;</p>
<p><strong>filter方法示例：</strong></p>
<p>1. 判等 exact。<br />例：查询编号为1的图书。</p>
<div class="cnblogs_code">
<pre><code>BookInfo.objects.get(id=1<span style="color: #000000;">)
BookInfo.objects.get(id__exact</span>=1)</pre>
</div>
<p>2. 模糊查询<br />例：查询书名包含'传'的图书。contains</p>
<div class="cnblogs_code">
<pre><code>BookInfo.objects.filter(btitle__contains=<span style="color: #800000;">'</span><span style="color: #800000;">传</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>例：查询书名以'部'结尾的图书 endswith 开头:startswith</p>
<div class="cnblogs_code">
<pre><code>BookInfo.objects.filter(btitle__endswith=<span style="color: #800000;">'</span><span style="color: #800000;">部</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>3. 空查询 isnull <br />select * from booktest_bookinfo where title is not null;<br />例：查询书名不为空的图书。isnull </p>
<div class="cnblogs_code">
<pre><code>BookInfo.objects.filter(btitle__isnull=False)</pre>
</div>
<p>4. 范围查询 in <br />select * from booktest_bookinfo where id in (1,3,5)<br />例：查询编号为1或3或5的图书。</p>
<div class="cnblogs_code">
<pre><code>BookInfo.objects.filter(id__in = [1,3,5])</pre>
</div>
<p>5. 比较查询</p>
<ul>
<li>gt(greate than) 大于</li>
<li>lt(less than) 小于</li>
<li>gte(equal) 大于等于</li>
<li>lte 小于等于</li>
</ul>
<p>例：查询编号大于3的图书。</p>
<div class="cnblogs_code">
<pre><code>BookInfo.objects.filter(id__gt = 3)</pre>
</div>
<p>6. 日期查询<br />例：查询1980年发表的图书。</p>
<div class="cnblogs_code">
<pre><code>BookInfo.objects.filter(bpub_date__year=1980)</pre>
</div>
<p>例：查询1980年1月1日后发表的图书。</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">from</span> datetime <span style="color: #0000ff;">import</span><span style="color: #000000;"> date
BookInfo.objects.filter(bpub_date__gt </span>= date(1980,1,1))</pre>
</div>
<p>&nbsp;</p>
<p><strong>exclude方法示例:</strong><br />例：查询id不为3的图书信息。<br />	BookInfo.objects.exclude(id=3)</p>
<p><strong>order_by示例方法：</strong><br />作用：进行查询结果进行排序<br />降序(.all()可以省略)</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> 例1：查询所有图书信息，按照id从小到大顺序进行排序；</span>
BookInfo.objects.all().order_by(<span style="color: #800000;">'</span><span style="color: #800000;">id</span><span style="color: #800000;">'</span>)    <span style="color: #008000;">#</span><span style="color: #008000;"> 按照升序排序</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 查询所有图书信息，按照id从大到小顺序进行排序；</span>
BookInfo.objects.all().order_by(<span style="color: #800000;">'</span><span style="color: #800000;">-id</span><span style="color: #800000;">'</span>) <span style="color: #008000;">#</span><span style="color: #008000;"> 按照降序排序</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 把id大于3的图书信息按阅读量从大到小排序显示。</span>
BookInfo.objects.filter(id__gt=3).order_by(<span style="color: #800000;">'</span><span style="color: #800000;">-bread</span><span style="color: #800000;">'</span>) <span style="color: #008000;">#</span><span style="color: #008000;"> 把id大于3的图书信息按阅读量从大到小排序显示。</span></pre>
</div>
<p>&nbsp;</p>
<h3>Q对象</h3>
<p>作用：用于查询时条件之间的逻辑关系。not and or，可以对Q对象进行&amp;|~操作。</p>
<p>使用之前需要先导入：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">from</span> django.db.models <span style="color: #0000ff;">import</span> Q</pre>
</div>
<p>例：查询id大于3且阅读量大于30的图书的信息。</p>
<div class="cnblogs_code">
<pre><code>BookInfo.objects.filter(id__gt=3, bread__gt=30<span style="color: #000000;">)
BookInfo.objects.filter(Q(id__gt</span>=3)&amp;Q(bread__gt=30))</pre>
</div>
<p>例：查询id大于3或者阅读量大于30的图书的信息。</p>
<div class="cnblogs_code">
<pre><code>BookInfo.objects.filter(Q(id__gt=3)|Q(bread__gt=30))</pre>
</div>
<p>例：查询id不等于3图书的信息。</p>
<div class="cnblogs_code">
<pre><code>BookInfo.objects.filter(~Q(id=3))</pre>
</div>
<p>&nbsp;</p>
<h3>F对象</h3>
<p>作用：用于类属性之间的比较。比如要查询评论量大于阅读量的文章书籍时就可以使用；</p>
<p>使用之前需要先导入：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">from</span> django.db.models <span style="color: #0000ff;">import</span> F</pre>
</div>
<p>例：查询图书阅读量大于评论量图书信息。</p>
<div class="cnblogs_code">
<pre><code>BookInfo.objects.filter(bread__gt=F(<span style="color: #800000;">'</span><span style="color: #800000;">bcomment</span><span style="color: #800000;">'</span>))</pre>
</div>
<p>例：查询图书阅读量大于2倍评论量图书信息。</p>
<div class="cnblogs_code">
<pre><code>BookInfo.objects.filter(bread__gt=F(<span style="color: #800000;">'</span><span style="color: #800000;">bcomment</span><span style="color: #800000;">'</span>)*2)</pre>
</div>
<p>&nbsp;</p>
<h3>聚合函数</h3>
<p>作用：对查询结果进行聚合操作。</p>
<ul>
<li>sum</li>
<li>count</li>
<li>avg</li>
<li>max</li>
<li>min</li>
</ul>
<p>aggregate：调用这个函数来使用聚合。 返回值是一个字典</p>
<p>使用前需先导入聚合类：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">from</span> django.db.models <span style="color: #0000ff;">import</span> Sum,Count,Max,Min,Avg</pre>
</div>
<p>例：查询所有图书的数目。</p>
<div class="cnblogs_code">
<pre><code>BookInfo.objects.all().aggregate(Count(<span style="color: #800000;">'</span><span style="color: #800000;">id</span><span style="color: #800000;">'</span><span style="color: #000000;">))
{</span><span style="color: #800000;">'</span><span style="color: #800000;">id__count</span><span style="color: #800000;">'</span>: 5}</pre>
</div>
<p>例：查询所有图书阅读量的总和。</p>
<div class="cnblogs_code">
<pre><code>BookInfo.objects.aggregate(Sum(<span style="color: #800000;">'</span><span style="color: #800000;">bread</span><span style="color: #800000;">'</span><span style="color: #000000;">))
{</span><span style="color: #800000;">'</span><span style="color: #800000;">bread__sum</span><span style="color: #800000;">'</span>: 126}</pre>
</div>
<p>&nbsp;</p>
<p><br /><strong>count函数</strong> </p>
<p>返回一个数字<br />作用：统计满足条件数据的数目。</p>
<p>例：统计所有图书的数目。</p>
<div class="cnblogs_code">
<pre><code><span style="color: #000000;">BookInfo.objects.all().count()
BookInfo.objects.count()
结果：</span>5</pre>
</div>
<p>例：统计id大于3的所有图书的数目。</p>
<div class="cnblogs_code">
<pre><code>BookInfo.objects.filter(id__gt=3).count()</pre>
</div>
<p>&nbsp;</p>
<p><strong>查询相关函数小结</strong></p>
<ul>
<li>get:返回一条且只能有一条数据，返回值是一个对象， 参数可以写查询条件。</li>
<li>all:返回模型类对应表的所有数据，返回值是QuerySet。</li>
<li>fiter:返回满足条件的数据，返回值是QuerySet,参数可以写查询条件。</li>
<li>exclude:返回不满足条件的数据，返回值是QuerySet,参数可以写查询条件。</li>
<li>order_ by:对查询结果进行排序，返回值是QuerySet, 参数中写排序的字段。</li>
</ul>
<p>注意:</p>
<ul>
<li>1. get, flter，exclude函数中可以写查询条件，如果传多个参数，条件之间代表且的关系。</li>
<li>2. all, fiter, exclude, order. by函数的返回值是QuerySet类的实例对象，叫做查询集。</li>
</ul>
<p>&nbsp;</p>
<p>from diango.db.models import F,Q Sum,Count Avg, Max,Min</p>
<ul>
<li>F对象:用于类属性之间的比较。</li>
<li>Q对象:用于条件之间的逻辑关系。</li>
<li>aggregate:进行聚合操作，返回值是一个字典，进行聚合的时候需要先导入聚合类。</li>
<li>count:返回结果集中数据的数目，返回值是一个数字。</li>
</ul>
<p>注意:<br /><strong>对一个QuerySet实例对象，可以继续调用上面的所有函数。</strong></p>
<p><br />参考文档：<br />	http://python.usyiyi.cn/translate/django_182/ref/models/querysets.html</p>
<p>&nbsp;</p>
<h3>查询集</h3>
<p>all, filter, exclude, order_by调用这些函数会产生一个查询集，QuerySet类对象可以继续调用上面的所有函数。</p>
<h4><strong>查询集特性</strong></h4>
<p>1）惰性查询：只有在实际使用查询集中的数据的时候才会发生对数据库的真正查询。<br />2）缓存：当使用的是同一个查询集时，第一次的时候会发生实际数据库的查询，然后把结果缓存起来，之后再使用这个查询集时，使用的是缓存中的结果。</p>
<h4>限制查询集</h4>
<p>可以对一个查询集进行取下标或者切片操作来限制查询集的结果。<br />对一个查询集进行切片操作会产生一个新的查询集，下标不允许为负数。</p>
<p>取出查询集第一条数据的两种方式:</p>
<p>&nbsp;</p>
<table style="height: 69px; width: 671px;" border="0">
<tbody>
<tr>
<td>方式&nbsp;</td>
<td>说明</td>





</tr>
<tr>
<td>b[0]&nbsp;</td>
<td>如果b[0]不存在，会抛出IndexError异常</td>





</tr>
<tr>
<td>b[0:1].get()&nbsp;</td>
<td>如果b[0:1].get()不存在，会抛出DoesNotExist异常。</td>





</tr>





</tbody>





</table>
<p>exists:判断一个查询集中是否有数据。True False</p>
<div class="cnblogs_code">
<pre><code>books =<span style="color: #000000;"> BookInfo.objects.all()
books1 </span>=<span style="color: #000000;"> books[0:0]
book.exists()
</span><span style="color: #008000;">#</span><span style="color: #008000;"> True</span>
<span style="color: #000000;">book1.exists()
</span><span style="color: #008000;">#</span><span style="color: #008000;"> False</span></pre>
</div>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>