<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修有哪些你不知道的Python小工具' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>有哪些你不知道的Python小工具</center></div><div class='banquan'>原文出处:本文由博客园博主python学习者0提供。<br/>
原文连接:https://www.cnblogs.com/xxpythonxx/p/11773868.html</div><br>
    <p>python作为越来越流行的一种编程语言，不仅仅是因为它语言简单，有许多现成的包可以直接调用。</p>
<p>python中还有大量的小工具，让你的python工作更有效率。</p>
<p><strong>1. 快速共享</strong></p>
<p>HTTP服务器</p>
<p>SimpleHTTPServer是python内置的web服务器，使用8000端口和HTTP协议共享。</p>
<p>能够在任意平台（Window，Linux，MacOS）快速搭建一个HTTP服务和共享服务，只需要搭建好python环境。</p>
<p>python2版本：</p>
<pre><code><code>python -m SimpleHTTPServer</code></pre>
<p>python3版本：</p>
<pre><code><code>python -m http.server</code></pre>
<p>FTP服务器</p>
<p>ftp共享需要第三方组件支持，安装命令：</p>
<pre><code><code>pip install pyftpdlib
python -m pyftpdlib-p端口号</code></pre>
<p>访问方式：<a href="ftp://IP:端口" class="uri">ftp://IP:端口</a>。</p>
<p><strong>2. 解压缩</strong></p>
<p>这里介绍利用python解压五种压缩文件：.gz .tar .zip .rar</p>
<p><strong>zip</strong></p>
<pre><code><code>import zipfile

# zipfile压缩
z = zipfile.ZipFile(&#39;x.zip&#39;, &#39;w&#39;, zipfile.ZIP_STORED) #打包，zipfile.ZIP_STORED是默认参数
# z = zipfile.ZipFile(&#39;ss.zip&#39;, &#39;w&#39;, zipfile.ZIP_DEFLATED) #压缩
z.write(&#39;x2&#39;)
z.write(&#39;x1&#39;)
z.close()

#zipfile解压
z = zipfile.ZipFile(&#39;x.zip&#39;, &#39;r&#39;)
z.extractall(path=r&quot;C:UsersAdministratorDesktop&quot;)
z.close()</code></pre>
<p><strong>tar</strong></p>
<pre><code><code>import tarfile

# 压缩
tar = tarfile.open(&#39;your.tar&#39;, &#39;w&#39;)
tar.add(&#39;/Users/wupeiqi/PycharmProjects/bbs2.log&#39;, arcname=&#39;bbs2.log&#39;)
tar.add(&#39;/Users/wupeiqi/PycharmProjects/cmdb.log&#39;, arcname=&#39;cmdb.log&#39;)
tar.close()

# 解压
tar = tarfile.open(&#39;your.tar&#39;, &#39;r&#39;)
tar.extractall()  # 可设置解压地址
tar.close()</code></pre>
<p><strong>gz</strong></p>
<p>gz一般仅仅压缩一个文件，全部常与其它打包工具一起工作。比方能够先用tar打包为X.tar,然后在压缩为X.tar.gz</p>
<p>解压gz，事实上就是读出当中的单一文件，Python方法例如以下：</p>
<pre><code><code>import gzip
import os
def un_gz(file_name):
&quot;&quot;&quot;ungz zip file&quot;&quot;&quot;
    f_name = file_name.replace(&quot;.gz&quot;, &quot;&quot;)
#获取文件的名称，去掉
g_file = gzip.GzipFile(file_name)
#创建gzip对象
open(f_name, &quot;w+&quot;).write(g_file.read())
#gzip对象用read()打开后，写入open()建立的文件里。
g_file.close()
#关闭gzip对象</code></pre>
<p><strong>rar</strong></p>
<p>由于rar通常为window下使用，须要额外的Python包rarfile。<br />
安装：</p>
<pre><code><code>Python setup.py install</code></pre>
<p>解压缩：</p>
<pre><code><code>import rarfile
import os
def un_rar(file_name):
&quot;&quot;&quot;unrar zip file&quot;&quot;&quot;
    rar = rarfile.RarFile(file_name)
if os.path.isdir(file_name + &quot;_files&quot;):
pass
else:
        os.mkdir(file_name + &quot;_files&quot;)
    os.chdir(file_name + &quot;_files&quot;):
    rar.extractall()
    rar.close()</code></pre>
<p><strong>3.pip常用操作</strong></p>
<p>pip 是 Python 著名的包管理工具，在 Python 开发中必不可少。</p>
<p>安装</p>
<p>在线安装</p>
<pre><code><code>pip install &lt;包名&gt; 或 pip install -r requirements.txt</code></pre>
<p>本地安装：</p>
<pre><code><code>pip install &lt;目录&gt;/&lt;文件名&gt; 或 pip install --use-wheel --no-index --find-links=wheelhouse/ &lt;包名&gt;</code></pre>
<p>查找包</p>
<pre><code><code>pip search &lt;包名&gt;</code></pre>
<p>删除包</p>
<pre><code><code>pip uninstall &lt;包名&gt; 或 pip uninstall -r requirements.txt</code></pre>
<p>查看包信息</p>
<pre><code><code>pip show &lt;包名&gt;</code></pre>
<p>检查包依赖是否完整</p>
<pre><code><code>pip check &lt;包名&gt;</code></pre>
<p>查看已安装包列表</p>
<pre><code><code>pip list</code></pre>
<p>导出所有已安装包</p>
<pre><code><code>pip freeze requirements.txt</code></pre>
<p><strong>4. 字符串与Json转换</strong></p>
<p>json转str</p>
<pre><code><code>import json
str = &#39;{&quot;name&quot;: &quot;zyl&quot;, &quot;age&quot;: &quot;two&quot;}&#39;
p = json.loads(str)
print(p)
print(type(p))</code></pre>
<p>json转str</p>
<p>使用json.dumps的方法，可以将json对象转化为字符串。</p>
<pre><code><code>s = {&#39;name&#39;:&#39;zyl&#39;,&#39;age&#39;:&#39;22&#39;}
s = json.dumps(s)</code></pre>
<p><strong>5. python读取excel</strong></p>
<p>步骤</p>
<ul>
<li><p>安装python官方Excel库--&gt;xlrd</p></li>
<li><p>获取Excel文件位置并读取</p></li>
<li><p>读取sheet</p></li>
<li><p>读取指定rows和cols内容</p></li>
</ul>
<p>示例</p>
<pre><code><code># -*- coding: utf-8 -*-
import xlrd
from datetime import date,datetime
def read_excel():

#文件位置

ExcelFile=xlrd.open_workbook(r&#39;C:UsersAdministratorDesktopTestData.xlsx&#39;)

#获取目标EXCEL文件sheet名

print ExcelFile.sheet_names()

#若有多个sheet，则需要指定读取目标sheet例如读取sheet2

#sheet2_name=ExcelFile.sheet_names()[1]

#获取sheet内容【1.根据sheet索引2.根据sheet名称】

#sheet=ExcelFile.sheet_by_index(1)

sheet=ExcelFile.sheet_by_name(&#39;TestCase002&#39;)

#打印sheet的名称，行数，列数

print sheet.name,sheet.nrows,sheet.ncols

#获取整行或者整列的值

rows=sheet.row_values(2)#第三行内容

cols=sheet.col_values(1)#第二列内容

print cols,rows

#获取单元格内容

print sheet.cell(1,0).value.encode(&#39;utf-8&#39;)

print sheet.cell_value(1,0).encode(&#39;utf-8&#39;)

print sheet.row(1)[0].value.encode(&#39;utf-8&#39;)

#打印单元格内容格式

print sheet.cell(1,0).ctype

if__name__ ==&#39;__main__&#39;:

read_excel()</code></pre>
<p><strong>6. python 截图</strong></p>
<p>python实现截图功能,windows环境下,需要用到PIL库。</p>
<p>安装：</p>
<pre><code><code>pip install Pillow</code></pre>
<p>示例：</p>
<pre><code><code>from PIL import ImageGrab
bbox = (x1, y1, x2,y2 )
# x1: 开始截图的x坐标;x2:开始截图的y坐标;x3:结束截图的x坐标;x4:结束截图的y坐标
im = ImageGrab.grab(bbox)
im.save(&#39;as.png&#39;)#保存截图文件的路径</code></pre>
<p><strong>7. ipython</strong></p>
<p>最后介绍的示一个强大的python工具——IPython 。</p>
<p>IPython 支持变量自动补全，自动缩进，支持 bash shell 命令，内置了许多实用功能和函数；</p>
<p>它是一个 for Humans 的 Python 交互式 shell，用了它之后你就不想再用自带的 Python shell 了。</p>

</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>