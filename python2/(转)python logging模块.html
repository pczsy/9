<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修(转)python logging模块' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>(转)python logging模块</center></div><div class='banquan'>原文出处:本文由博客园博主feiquan提供。<br/>
原文连接:https://www.cnblogs.com/feiquan/p/11381141.html</div><br>
    <h1 class="postTitle"><span style="font-size: 18px;">原文：http://www.cnblogs.com/dahu-daqing/p/7040764.html</span></h1>
<div class="postBody">
<div id="cnblogs_post_body" class="blogpost-body ">
<h1 id="logging模块简介">1 logging模块简介</h1>
<p>logging模块是Python内置的标准模块，主要用于输出运行日志，可以设置输出日志的等级、日志保存路径、日志文件回滚等；相比print，具备如下优点：</p>
<ol>
<li>可以通过设置不同的日志等级，在release版本中只输出重要信息，而不必显示大量的调试信息；</li>
<li>print将所有信息都输出到标准输出中，严重影响开发者从标准输出中查看其它数据；logging则可以由开发者决定将信息输出到什么地方，以及怎么输出；</li>
</ol>
<h1 id="logging模块使用">2 logging模块使用</h1>
<h2 id="基本使用">2.1 基本使用</h2>
<p>配置logging基本的设置，然后在控制台输出日志，</p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<pre><code>import logging
logging.basicConfig(level = logging.INFO,format = '%(asctime)s - %(name)s - %(levelname)s - %(message)s')
logger = logging.getLogger(__name__)

logger.info("Start print log")
logger.debug("Do something")
logger.warning("Something maybe fail.")
logger.info("Finish")</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
</div>
<p>运行时，控制台输出，</p>
<pre><code><code>2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 19<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:11<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:19,434 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- __<span class="hljs-selector-tag"><span class="hljs-selector-tag">main__ <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">INFO <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">Start <span class="hljs-selector-tag"><span class="hljs-selector-tag">print <span class="hljs-selector-tag"><span class="hljs-selector-tag">log
2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 19<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:11<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:19,434 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- __<span class="hljs-selector-tag"><span class="hljs-selector-tag">main__ <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">WARNING <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">Something <span class="hljs-selector-tag"><span class="hljs-selector-tag">maybe <span class="hljs-selector-tag"><span class="hljs-selector-tag">fail.
2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 19<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:11<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:19,434 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- __<span class="hljs-selector-tag"><span class="hljs-selector-tag">main__ <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">INFO <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">Finish</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<p>logging中可以选择很多消息级别，如debug、info、warning、error以及critical。通过赋予logger或者handler不同的级别，开发者就可以只输出错误信息到特定的记录文件，或者在调试时只记录调试信息。</p>
<p>例如，我们将logger的级别改为DEBUG，再观察一下输出结果，</p>
<div class="cnblogs_code">
<pre><code>logging.basicConfig(level = logging.DEBUG,format = '%(asctime)s - %(name)s - %(levelname)s - %(message)s')</pre>
</div>
<p>控制台输出，可以发现，输出了debug的信息。</p>
<pre><code><code>2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 19<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:12<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:08,289 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- __<span class="hljs-selector-tag"><span class="hljs-selector-tag">main__ <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">INFO <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">Start <span class="hljs-selector-tag"><span class="hljs-selector-tag">print <span class="hljs-selector-tag"><span class="hljs-selector-tag">log
2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 19<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:12<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:08,289 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- __<span class="hljs-selector-tag"><span class="hljs-selector-tag">main__ <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">DEBUG <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">Do <span class="hljs-selector-tag"><span class="hljs-selector-tag">something
2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 19<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:12<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:08,289 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- __<span class="hljs-selector-tag"><span class="hljs-selector-tag">main__ <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">WARNING <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">Something <span class="hljs-selector-tag"><span class="hljs-selector-tag">maybe <span class="hljs-selector-tag"><span class="hljs-selector-tag">fail.
2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 19<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:12<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:08,289 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- __<span class="hljs-selector-tag"><span class="hljs-selector-tag">main__ <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">INFO <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">Finish</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<p>logging.basicConfig函数各参数：</p>
<p>filename：指定日志文件名；</p>
<p>filemode：和file函数意义相同，指定日志文件的打开模式，'w'或者'a'；</p>
<p>format：指定输出的格式和内容，format可以输出很多有用的信息，</p>
<pre><code><code class="hljs matlab shell">参数：作用
<span class="hljs-meta">
<span class="hljs-comment"><span class="hljs-meta">%<span class="bash">(levelno)s：打印日志级别的数值
<span class="hljs-comment"><span class="hljs-meta">%<span class="bash">(levelname)s：打印日志级别的名称
<span class="hljs-comment"><span class="hljs-meta">%<span class="bash">(pathname)s：打印当前执行程序的路径，其实就是sys.argv[0]
<span class="hljs-comment"><span class="hljs-meta">%<span class="bash">(filename)s：打印当前执行程序名
<span class="hljs-comment"><span class="hljs-meta">%<span class="bash">(funcName)s：打印日志的当前函数
<span class="hljs-comment"><span class="hljs-meta">%<span class="bash">(lineno)d：打印日志的当前行号
<span class="hljs-comment"><span class="hljs-meta">%<span class="bash">(asctime)s：打印日志的时间
<span class="hljs-comment"><span class="hljs-meta">%<span class="bash">(thread)d：打印线程ID
<span class="hljs-comment"><span class="hljs-meta">%<span class="bash">(threadName)s：打印线程名称
<span class="hljs-comment"><span class="hljs-meta">%<span class="bash">(process)d：打印进程ID
<span class="hljs-comment"><span class="hljs-meta">%<span class="bash">(message)s：打印日志信息</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<p>datefmt：指定时间格式，同time.strftime()；</p>
<p>level：设置日志级别，默认为logging.WARNNING；</p>
<p>stream：指定将日志的输出流，可以指定输出到sys.stderr，sys.stdout或者文件，默认输出到sys.stderr，当stream和filename同时指定时，stream被忽略；</p>
<h2 id="将日志写入到文件">2.2 将日志写入到文件</h2>
<p><strong>2.2.1 将日志写入到文件</strong></p>
<p>设置logging，创建一个FileHandler，并对输出消息的格式进行设置，将其添加到logger，然后将日志写入到指定的文件中，</p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<pre><code>import logging
logger = logging.getLogger(__name__)
logger.setLevel(level = logging.INFO)
handler = logging.FileHandler("log.txt")
handler.setLevel(logging.INFO)
formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s')
handler.setFormatter(formatter)
logger.addHandler(handler)

logger.info("Start print log")
logger.debug("Do something")
logger.warning("Something maybe fail.")
logger.info("Finish")</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
</div>
<p>log.txt中日志数据为，</p>
<pre><code><code>2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 19<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:01<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:13,263 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- __<span class="hljs-selector-tag"><span class="hljs-selector-tag">main__ <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">INFO <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">Start <span class="hljs-selector-tag"><span class="hljs-selector-tag">print <span class="hljs-selector-tag"><span class="hljs-selector-tag">log
2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 19<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:01<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:13,263 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- __<span class="hljs-selector-tag"><span class="hljs-selector-tag">main__ <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">WARNING <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">Something <span class="hljs-selector-tag"><span class="hljs-selector-tag">maybe <span class="hljs-selector-tag"><span class="hljs-selector-tag">fail.
2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 19<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:01<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:13,263 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- __<span class="hljs-selector-tag"><span class="hljs-selector-tag">main__ <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">INFO <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">Finish</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<p><strong>2.2.2 将日志同时输出到屏幕和日志文件</strong></p>
<p>logger中添加StreamHandler，可以将日志输出到屏幕上，</p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<pre><code>import logging
logger = logging.getLogger(__name__)
logger.setLevel(level = logging.INFO)
handler = logging.FileHandler("log.txt")
handler.setLevel(logging.INFO)
formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s')
handler.setFormatter(formatter)

console = logging.StreamHandler()
console.setLevel(logging.INFO)

logger.addHandler(handler)
logger.addHandler(console)

logger.info("Start print log")
logger.debug("Do something")
logger.warning("Something maybe fail.")
logger.info("Finish")</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
</div>
<p>可以在log.txt文件和控制台中看到，</p>
<pre><code><code>2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 19<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:20<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:46,553 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- __<span class="hljs-selector-tag"><span class="hljs-selector-tag">main__ <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">INFO <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">Start <span class="hljs-selector-tag"><span class="hljs-selector-tag">print <span class="hljs-selector-tag"><span class="hljs-selector-tag">log
2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 19<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:20<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:46,553 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- __<span class="hljs-selector-tag"><span class="hljs-selector-tag">main__ <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">WARNING <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">Something <span class="hljs-selector-tag"><span class="hljs-selector-tag">maybe <span class="hljs-selector-tag"><span class="hljs-selector-tag">fail.
2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 19<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:20<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:46,553 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- __<span class="hljs-selector-tag"><span class="hljs-selector-tag">main__ <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">INFO <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">Finish</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<p>可以发现，logging有一个日志处理的主对象，其他处理方式都是通过addHandler添加进去，logging中包含的handler主要有如下几种，</p>
<pre><code><code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">handler名称：位置；作用

StreamHandler：<span class="hljs-keyword">logging.StreamHandler；日志输出到流，可以是<span class="hljs-keyword">sys.stderr，<span class="hljs-keyword">sys.stdout或者文件
FileHandler：<span class="hljs-keyword">logging.FileHandler；日志输出到文件
BaseRotatingHandler：<span class="hljs-keyword">logging.handlers.BaseRotatingHandler；基本的日志回滚方式
RotatingHandler：<span class="hljs-keyword">logging.handlers.RotatingHandler；日志回滚方式，支持日志文件最大数量和日志文件回滚
TimeRotatingHandler：<span class="hljs-keyword">logging.handlers.TimeRotatingHandler；日志回滚方式，在一定时间区域内回滚日志文件
SocketHandler：<span class="hljs-keyword">logging.handlers.SocketHandler；远程输出日志到TCP/IP sockets
DatagramHandler：<span class="hljs-keyword">logging.handlers.DatagramHandler；远程输出日志到UDP sockets
SMTPHandler：<span class="hljs-keyword">logging.handlers.SMTPHandler；远程输出日志到邮件地址
SysLogHandler：<span class="hljs-keyword">logging.handlers.SysLogHandler；日志输出到syslog
NTEventLogHandler：<span class="hljs-keyword">logging.handlers.NTEventLogHandler；远程输出日志到Windows NT/<span class="hljs-number"><span class="hljs-number">2000/XP的事件日志
MemoryHandler：<span class="hljs-keyword">logging.handlers.MemoryHandler；日志输出到内存中的指定buffer
HTTPHandler：<span class="hljs-keyword">logging.handlers.HTTPHandler；通过<span class="hljs-string"><span class="hljs-string">"GET"或者<span class="hljs-string"><span class="hljs-string">"POST"远程输出到<span class="hljs-keyword"><span class="hljs-keyword">HTTP服务器</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<p><strong>2.2.3 日志回滚</strong></p>
<p>使用RotatingFileHandler，可以实现日志回滚，</p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<pre><code>import logging
from logging.handlers import RotatingFileHandler
logger = logging.getLogger(__name__)
logger.setLevel(level = logging.INFO)
#定义一个RotatingFileHandler，最多备份3个日志文件，每个日志文件最大1K
rHandler = RotatingFileHandler("log.txt",maxBytes = 1*1024,backupCount = 3)
rHandler.setLevel(logging.INFO)
formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s')
rHandler.setFormatter(formatter)

console = logging.StreamHandler()
console.setLevel(logging.INFO)
console.setFormatter(formatter)

logger.addHandler(rHandler)
logger.addHandler(console)

logger.info("Start print log")
logger.debug("Do something")
logger.warning("Something maybe fail.")
logger.info("Finish")</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
</div>
<p>可以在工程目录中看到，备份的日志文件，</p>
<pre><code><code class="hljs cpp"><span class="hljs-number"><span class="hljs-number">2016/<span class="hljs-number"><span class="hljs-number">10/<span class="hljs-number"><span class="hljs-number">09  <span class="hljs-number"><span class="hljs-number">19:<span class="hljs-number"><span class="hljs-number">36               <span class="hljs-number"><span class="hljs-number">732 <span class="hljs-built_in"><span class="hljs-built_in">log.txt
<span class="hljs-number"><span class="hljs-number">2016/<span class="hljs-number"><span class="hljs-number">10/<span class="hljs-number"><span class="hljs-number">09  <span class="hljs-number"><span class="hljs-number">19:<span class="hljs-number"><span class="hljs-number">36               <span class="hljs-number"><span class="hljs-number">967 <span class="hljs-built_in"><span class="hljs-built_in">log.txt<span class="hljs-number"><span class="hljs-number">.1
<span class="hljs-number"><span class="hljs-number">2016/<span class="hljs-number"><span class="hljs-number">10/<span class="hljs-number"><span class="hljs-number">09  <span class="hljs-number"><span class="hljs-number">19:<span class="hljs-number"><span class="hljs-number">36               <span class="hljs-number"><span class="hljs-number">985 <span class="hljs-built_in"><span class="hljs-built_in">log.txt<span class="hljs-number"><span class="hljs-number">.2
<span class="hljs-number"><span class="hljs-number">2016/<span class="hljs-number"><span class="hljs-number">10/<span class="hljs-number"><span class="hljs-number">09  <span class="hljs-number"><span class="hljs-number">19:<span class="hljs-number"><span class="hljs-number">36               <span class="hljs-number"><span class="hljs-number">976 <span class="hljs-built_in"><span class="hljs-built_in">log.txt<span class="hljs-number"><span class="hljs-number">.3</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<h2 id="设置消息的等级">2.3 设置消息的等级</h2>
<p>可以设置不同的日志等级，用于控制日志的输出，</p>
<pre><code><code class="hljs objectivec">日志等级：使用范围

FATAL：致命错误
CRITI<span class="hljs-built_in">CAL：特别糟糕的事情，如内存耗尽、磁盘空间为空，一般很少使用
ERROR：发生错误时，如IO操作失败或者连接问题
WARNING：发生很重要的事件，但是并不是错误时，如用户登录密码错误
INFO：处理请求或者状态变化等日常事务
DEBUG：调试过程中使用DEBUG等级，如算法中每个循环的中间状态</span></code></pre>
<h2 id="捕获traceback">2.4 捕获traceback</h2>
<p>Python中的traceback模块被用于跟踪异常返回信息，可以在logging中记录下traceback，</p>
<p>代码，</p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<pre><code>import logging
logger = logging.getLogger(__name__)
logger.setLevel(level = logging.INFO)
handler = logging.FileHandler("log.txt")
handler.setLevel(logging.INFO)
formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s')
handler.setFormatter(formatter)

console = logging.StreamHandler()
console.setLevel(logging.INFO)

logger.addHandler(handler)
logger.addHandler(console)

logger.info("Start print log")
logger.debug("Do something")
logger.warning("Something maybe fail.")
try:
    open("sklearn.txt","rb")
except (SystemExit,KeyboardInterrupt):
    raise
except Exception:
    logger.error("Faild to open sklearn.txt from logger.error",exc_info = True)

logger.info("Finish")</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
</div>
<p>控制台和日志文件log.txt中输出，</p>
<pre><code><code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">Start print <span class="hljs-keyword"><span class="hljs-keyword">log
Something maybe fail.
Faild <span class="hljs-keyword"><span class="hljs-keyword">to <span class="hljs-keyword"><span class="hljs-keyword">open sklearn.txt <span class="hljs-keyword"><span class="hljs-keyword">from logger.<span class="hljs-keyword">error
Traceback (most recent <span class="hljs-keyword"><span class="hljs-keyword">call <span class="hljs-keyword"><span class="hljs-keyword">last):
  <span class="hljs-keyword"><span class="hljs-keyword">File <span class="hljs-string"><span class="hljs-string">"G:\zhb7627\Code\Eclipse WorkSpace\PythonTest\test.py", line <span class="hljs-number"><span class="hljs-number">23, <span class="hljs-keyword"><span class="hljs-keyword">in &lt;<span class="hljs-keyword"><span class="hljs-keyword">module&gt;
    <span class="hljs-keyword"><span class="hljs-keyword">open(<span class="hljs-string"><span class="hljs-string">"sklearn.txt",<span class="hljs-string"><span class="hljs-string">"rb")
IOError: [Errno <span class="hljs-number"><span class="hljs-number">2] <span class="hljs-keyword"><span class="hljs-keyword">No such <span class="hljs-keyword"><span class="hljs-keyword">file <span class="hljs-keyword"><span class="hljs-keyword">or <span class="hljs-keyword"><span class="hljs-keyword">directory: <span class="hljs-string"><span class="hljs-string">'sklearn.txt'
<span class="hljs-keyword"><span class="hljs-keyword">Finish</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<p>也可以使用logger.exception(msg,_args)，它等价于logger.error(msg,exc_info = True,_args)，</p>
<p>将</p>
<pre><code><code class="hljs vbnet">logger.<span class="hljs-keyword"><span class="hljs-keyword">error(<span class="hljs-string"><span class="hljs-string">"Faild to open sklearn.txt from logger.error",exc_info = <span class="hljs-literal"><span class="hljs-literal">True)</span></span></span></span></span></span></code></pre>
<p>替换为，</p>
<pre><code><code><span class="hljs-selector-tag"><span class="hljs-selector-tag">logger<span class="hljs-selector-class"><span class="hljs-selector-class">.exception("<span class="hljs-selector-tag"><span class="hljs-selector-tag">Failed <span class="hljs-selector-tag"><span class="hljs-selector-tag">to <span class="hljs-selector-tag"><span class="hljs-selector-tag">open <span class="hljs-selector-tag"><span class="hljs-selector-tag">sklearn<span class="hljs-selector-class"><span class="hljs-selector-class">.txt <span class="hljs-selector-tag"><span class="hljs-selector-tag">from <span class="hljs-selector-tag"><span class="hljs-selector-tag">logger<span class="hljs-selector-class"><span class="hljs-selector-class">.exception")</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<p>控制台和日志文件log.txt中输出，</p>
<pre><code><code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">Start print <span class="hljs-keyword"><span class="hljs-keyword">log
Something maybe fail.
<span class="hljs-keyword"><span class="hljs-keyword">Failed <span class="hljs-keyword"><span class="hljs-keyword">to <span class="hljs-keyword"><span class="hljs-keyword">open sklearn.txt <span class="hljs-keyword"><span class="hljs-keyword">from logger.<span class="hljs-keyword">exception
Traceback (most recent <span class="hljs-keyword"><span class="hljs-keyword">call <span class="hljs-keyword"><span class="hljs-keyword">last):
  <span class="hljs-keyword"><span class="hljs-keyword">File <span class="hljs-string"><span class="hljs-string">"G:\zhb7627\Code\Eclipse WorkSpace\PythonTest\test.py", line <span class="hljs-number"><span class="hljs-number">23, <span class="hljs-keyword"><span class="hljs-keyword">in &lt;<span class="hljs-keyword"><span class="hljs-keyword">module&gt;
    <span class="hljs-keyword"><span class="hljs-keyword">open(<span class="hljs-string"><span class="hljs-string">"sklearn.txt",<span class="hljs-string"><span class="hljs-string">"rb")
IOError: [Errno <span class="hljs-number"><span class="hljs-number">2] <span class="hljs-keyword"><span class="hljs-keyword">No such <span class="hljs-keyword"><span class="hljs-keyword">file <span class="hljs-keyword"><span class="hljs-keyword">or <span class="hljs-keyword"><span class="hljs-keyword">directory: <span class="hljs-string"><span class="hljs-string">'sklearn.txt'
<span class="hljs-keyword"><span class="hljs-keyword">Finish</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<h2 id="多模块使用logging">2.5 多模块使用logging</h2>
<p>主模块mainModule.py，</p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<pre><code>import logging
import subModule
logger = logging.getLogger("mainModule")
logger.setLevel(level = logging.INFO)
handler = logging.FileHandler("log.txt")
handler.setLevel(logging.INFO)
formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s')
handler.setFormatter(formatter)

console = logging.StreamHandler()
console.setLevel(logging.INFO)
console.setFormatter(formatter)

logger.addHandler(handler)
logger.addHandler(console)


logger.info("creating an instance of subModule.subModuleClass")
a = subModule.SubModuleClass()
logger.info("calling subModule.subModuleClass.doSomething")
a.doSomething()
logger.info("done with  subModule.subModuleClass.doSomething")
logger.info("calling subModule.some_function")
subModule.som_function()
logger.info("done with subModule.some_function")</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
</div>
<p>子模块subModule.py，</p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<pre><code>import logging

module_logger = logging.getLogger("mainModule.sub")
class SubModuleClass(object):
    def __init__(self):
        self.logger = logging.getLogger("mainModule.sub.module")
        self.logger.info("creating an instance in SubModuleClass")
    def doSomething(self):
        self.logger.info("do something in SubModule")
        a = []
        a.append(1)
        self.logger.debug("list a = " + str(a))
        self.logger.info("finish something in SubModuleClass")

def som_function():
    module_logger.info("call function some_function")</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
</div>
<p>执行之后，在控制和日志文件log.txt中输出，</p>
<pre><code><code>2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 20<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:25<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:42,276 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">mainModule <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">INFO <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">creating <span class="hljs-selector-tag"><span class="hljs-selector-tag">an <span class="hljs-selector-tag"><span class="hljs-selector-tag">instance <span class="hljs-selector-tag"><span class="hljs-selector-tag">of <span class="hljs-selector-tag"><span class="hljs-selector-tag">subModule<span class="hljs-selector-class"><span class="hljs-selector-class">.subModuleClass
2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 20<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:25<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:42,279 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">mainModule<span class="hljs-selector-class"><span class="hljs-selector-class">.sub<span class="hljs-selector-class"><span class="hljs-selector-class">.module <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">INFO <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">creating <span class="hljs-selector-tag"><span class="hljs-selector-tag">an <span class="hljs-selector-tag"><span class="hljs-selector-tag">instance <span class="hljs-selector-tag"><span class="hljs-selector-tag">in <span class="hljs-selector-tag"><span class="hljs-selector-tag">SubModuleClass
2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 20<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:25<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:42,279 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">mainModule <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">INFO <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">calling <span class="hljs-selector-tag"><span class="hljs-selector-tag">subModule<span class="hljs-selector-class"><span class="hljs-selector-class">.subModuleClass<span class="hljs-selector-class"><span class="hljs-selector-class">.doSomething
2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 20<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:25<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:42,279 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">mainModule<span class="hljs-selector-class"><span class="hljs-selector-class">.sub<span class="hljs-selector-class"><span class="hljs-selector-class">.module <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">INFO <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">do <span class="hljs-selector-tag"><span class="hljs-selector-tag">something <span class="hljs-selector-tag"><span class="hljs-selector-tag">in <span class="hljs-selector-tag"><span class="hljs-selector-tag">SubModule
2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 20<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:25<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:42,279 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">mainModule<span class="hljs-selector-class"><span class="hljs-selector-class">.sub<span class="hljs-selector-class"><span class="hljs-selector-class">.module <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">INFO <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">finish <span class="hljs-selector-tag"><span class="hljs-selector-tag">something <span class="hljs-selector-tag"><span class="hljs-selector-tag">in <span class="hljs-selector-tag"><span class="hljs-selector-tag">SubModuleClass
2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 20<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:25<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:42,279 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">mainModule <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">INFO <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">done <span class="hljs-selector-tag"><span class="hljs-selector-tag">with  <span class="hljs-selector-tag"><span class="hljs-selector-tag">subModule<span class="hljs-selector-class"><span class="hljs-selector-class">.subModuleClass<span class="hljs-selector-class"><span class="hljs-selector-class">.doSomething
2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 20<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:25<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:42,279 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">mainModule <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">INFO <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">calling <span class="hljs-selector-tag"><span class="hljs-selector-tag">subModule<span class="hljs-selector-class"><span class="hljs-selector-class">.some_function
2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 20<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:25<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:42,279 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">mainModule<span class="hljs-selector-class"><span class="hljs-selector-class">.sub <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">INFO <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">call <span class="hljs-selector-tag"><span class="hljs-selector-tag">function <span class="hljs-selector-tag"><span class="hljs-selector-tag">some_function
2016<span class="hljs-selector-tag"><span class="hljs-selector-tag">-10-09 20<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:25<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:42,279 <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">mainModule <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">INFO <span class="hljs-selector-tag"><span class="hljs-selector-tag">- <span class="hljs-selector-tag"><span class="hljs-selector-tag">done <span class="hljs-selector-tag"><span class="hljs-selector-tag">with <span class="hljs-selector-tag"><span class="hljs-selector-tag">subModule<span class="hljs-selector-class"><span class="hljs-selector-class">.some_function</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<p>首先在主模块定义了logger'mainModule'，并对它进行了配置，就可以在解释器进程里面的其他地方通过getLogger('mainModule')得到的对象都是一样的，不需要重新配置，可以直接使用。定义的该logger的子logger，都可以共享父logger的定义和配置，所谓的父子logger是通过命名来识别，任意以'mainModule'开头的logger都是它的子logger，例如'mainModule.sub'。</p>
<p>实际开发一个application，首先可以通过logging配置文件编写好这个application所对应的配置，可以生成一个根logger，如'PythonAPP'，然后在主函数中通过fileConfig加载logging配置，接着在application的其他地方、不同的模块中，可以使用根logger的子logger，如'PythonAPP.Core'，'PythonAPP.Web'来进行log，而不需要反复的定义和配置各个模块的logger。</p>
<h1 id="通过json或者yaml文件配置logging模块">3 通过JSON或者YAML文件配置logging模块</h1>
<p>尽管可以在Python代码中配置logging，但是这样并不够灵活，最好的方法是使用一个配置文件来配置。在Python 2.7及以后的版本中，可以从字典中加载logging配置，也就意味着可以通过JSON或者YAML文件加载日志的配置。</p>
<h2 id="通过json文件配置">3.1 通过JSON文件配置</h2>
<p>JSON配置文件，</p>
<pre><code><code class="hljs json">{
    <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">version":<span class="hljs-number"><span class="hljs-number">1,
    <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">disable_existing_loggers":<span class="hljs-literal"><span class="hljs-literal">false,
    <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">formatters":{
        <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">simple":{
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">format":<span class="hljs-string"><span class="hljs-string">"%(asctime)s - %(name)s - %(levelname)s - %(message)s"
        }
    },
    <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">handlers":{
        <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">console":{
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">class":<span class="hljs-string"><span class="hljs-string">"logging.StreamHandler",
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">level":<span class="hljs-string"><span class="hljs-string">"DEBUG",
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">formatter":<span class="hljs-string"><span class="hljs-string">"simple",
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">stream":<span class="hljs-string"><span class="hljs-string">"ext://sys.stdout"
        },
        <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">info_file_handler":{
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">class":<span class="hljs-string"><span class="hljs-string">"logging.handlers.RotatingFileHandler",
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">level":<span class="hljs-string"><span class="hljs-string">"INFO",
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">formatter":<span class="hljs-string"><span class="hljs-string">"simple",
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">filename":<span class="hljs-string"><span class="hljs-string">"info.log",
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">maxBytes":<span class="hljs-string"><span class="hljs-string">"10485760",
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">backupCount":<span class="hljs-number"><span class="hljs-number">20,
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">encoding":<span class="hljs-string"><span class="hljs-string">"utf8"
        },
        <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">error_file_handler":{
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">class":<span class="hljs-string"><span class="hljs-string">"logging.handlers.RotatingFileHandler",
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">level":<span class="hljs-string"><span class="hljs-string">"ERROR",
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">formatter":<span class="hljs-string"><span class="hljs-string">"simple",
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">filename":<span class="hljs-string"><span class="hljs-string">"errors.log",
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">maxBytes":<span class="hljs-number"><span class="hljs-number">10485760,
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">backupCount":<span class="hljs-number"><span class="hljs-number">20,
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">encoding":<span class="hljs-string"><span class="hljs-string">"utf8"
        }
    },
    <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">loggers":{
        <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">my_module":{
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">level":<span class="hljs-string"><span class="hljs-string">"ERROR",
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">handlers":[<span class="hljs-string"><span class="hljs-string">"info_file_handler"],
            <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">propagate":<span class="hljs-string"><span class="hljs-string">"no"
        }
    },
    <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">root":{
        <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">level":<span class="hljs-string"><span class="hljs-string">"INFO",
        <span class="hljs-attr">"<span class="hljs-attr"><span class="hljs-attr">handlers":[<span class="hljs-string"><span class="hljs-string">"console",<span class="hljs-string"><span class="hljs-string">"info_file_handler",<span class="hljs-string"><span class="hljs-string">"error_file_handler"]
    }
}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<p>通过JSON加载配置文件，然后通过logging.dictConfig配置logging，</p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<pre><code>import json
import logging.config
import os

def setup_logging(default_path = "logging.json",default_level = logging.INFO,env_key = "LOG_CFG"):
    path = default_path
    value = os.getenv(env_key,None)
    if value:
        path = value
    if os.path.exists(path):
        with open(path,"r") as f:
            config = json.load(f)
            logging.config.dictConfig(config)
    else:
        logging.basicConfig(level = default_level)

def func():
    logging.info("start func")

    logging.info("exec func")

    logging.info("end func")

if __name__ == "__main__":
    setup_logging(default_path = "logging.json")
    func()</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
</div>
<h2 id="通过yaml文件配置">3.2 通过YAML文件配置</h2>
<p>通过YAML文件进行配置，比JSON看起来更加简介明了，</p>
<pre><code><code class="hljs yaml"><span class="hljs-attr"><span class="hljs-attr">version: <span class="hljs-number"><span class="hljs-number">1
<span class="hljs-attr"><span class="hljs-attr">disable_existing_loggers: <span class="hljs-literal"><span class="hljs-literal">False
<span class="hljs-attr"><span class="hljs-attr">formatters:
<span class="hljs-attr"><span class="hljs-attr">        simple:
<span class="hljs-attr"><span class="hljs-attr">            format: <span class="hljs-string"><span class="hljs-string">"%(asctime)s - %(name)s - %(levelname)s - %(message)s"
<span class="hljs-attr"><span class="hljs-attr">handlers:
<span class="hljs-attr"><span class="hljs-attr">    console:
<span class="hljs-attr"><span class="hljs-attr">            class: <span class="hljs-string">logging.StreamHandler
<span class="hljs-attr"><span class="hljs-attr">            level: <span class="hljs-string">DEBUG
<span class="hljs-attr"><span class="hljs-attr">            formatter: <span class="hljs-string">simple
<span class="hljs-attr"><span class="hljs-attr">            stream: <span class="hljs-attr">ext://sys.stdout
<span class="hljs-attr"><span class="hljs-attr">    info_file_handler:
<span class="hljs-attr"><span class="hljs-attr">            class: <span class="hljs-string">logging.handlers.RotatingFileHandler
<span class="hljs-attr"><span class="hljs-attr">            level: <span class="hljs-string">INFO
<span class="hljs-attr"><span class="hljs-attr">            formatter: <span class="hljs-string">simple
<span class="hljs-attr"><span class="hljs-attr">            filename: <span class="hljs-string">info.log
<span class="hljs-attr"><span class="hljs-attr">            maxBytes: <span class="hljs-number"><span class="hljs-number">10485760
<span class="hljs-attr"><span class="hljs-attr">            backupCount: <span class="hljs-number"><span class="hljs-number">20
<span class="hljs-attr"><span class="hljs-attr">            encoding: <span class="hljs-string">utf8
<span class="hljs-attr"><span class="hljs-attr">    error_file_handler:
<span class="hljs-attr"><span class="hljs-attr">            class: <span class="hljs-string">logging.handlers.RotatingFileHandler
<span class="hljs-attr"><span class="hljs-attr">            level: <span class="hljs-string">ERROR
<span class="hljs-attr"><span class="hljs-attr">            formatter: <span class="hljs-string">simple
<span class="hljs-attr"><span class="hljs-attr">            filename: <span class="hljs-string">errors.log
<span class="hljs-attr"><span class="hljs-attr">            maxBytes: <span class="hljs-number"><span class="hljs-number">10485760
<span class="hljs-attr"><span class="hljs-attr">            backupCount: <span class="hljs-number"><span class="hljs-number">20
<span class="hljs-attr"><span class="hljs-attr">            encoding: <span class="hljs-string">utf8
<span class="hljs-attr"><span class="hljs-attr">loggers:
<span class="hljs-attr"><span class="hljs-attr">    my_module:
<span class="hljs-attr"><span class="hljs-attr">            level: <span class="hljs-string">ERROR
<span class="hljs-attr"><span class="hljs-attr">            handlers: <span class="hljs-string">[info_file_handler]
<span class="hljs-attr"><span class="hljs-attr">            propagate: <span class="hljs-literal"><span class="hljs-literal">no
<span class="hljs-attr"><span class="hljs-attr">root:
<span class="hljs-attr"><span class="hljs-attr">    level: <span class="hljs-string">INFO
<span class="hljs-attr"><span class="hljs-attr">    handlers: <span class="hljs-string">[console,info_file_handler,error_file_handler]</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<p>通过YAML加载配置文件，然后通过logging.dictConfig配置logging，</p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<pre><code>import yaml
import logging.config
import os

def setup_logging(default_path = "logging.yaml",default_level = logging.INFO,env_key = "LOG_CFG"):
    path = default_path
    value = os.getenv(env_key,None)
    if value:
        path = value
    if os.path.exists(path):
        with open(path,"r") as f:
            config = yaml.load(f)
            logging.config.dictConfig(config)
    else:
        logging.basicConfig(level = default_level)

def func():
    logging.info("start func")

    logging.info("exec func")

    logging.info("end func")

if __name__ == "__main__":
    setup_logging(default_path = "logging.yaml")
    func()
    </pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/(转)python logging模块0.png" alt="复制代码" /></a></span></div>
</div>
<h1 id="reference">4 Reference</h1>
<p><a href="http://dataunion.org/19906.html">每个 Python 程序员都要知道的日志实践</a></p>
<p><a href="http://blog.csdn.net/fxjtoday/article/details/6307285">Python标准模块logging</a></p>
<p><a href="http://www.cnblogs.com/dkblog/archive/2011/08/26/2155018.html">python 的日志logging模块学习</a></p>
</div>
</div>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>