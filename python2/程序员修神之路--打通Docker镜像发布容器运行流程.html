<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修程序员修神之路--打通Docker镜像发布容器运行流程' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>程序员修神之路--打通Docker镜像发布容器运行流程</center></div><div class='banquan'>原文出处:本文由博客园博主架构师修行之路提供。<br/>
原文连接:https://www.cnblogs.com/zhanlang/p/12013424.html</div><br>
    <section data-role="outer" label="Powered by 135editor.com" style="font-size: 15px;"><section data-role="outer" label="Powered by 135editor.com"><section><section data-tools="135编辑器" data-id="92771"><section style="padding: 5px 0px; box-sizing: border-box;"><section style="display:flex;justify-content:center;"><section style="width:25px;margin-right: 5px;"><br /></section></section></section></section><section data-tools="135编辑器" data-id="86375" style="border: 0px none; box-sizing: border-box;"><section style="margin-top:5px;"><section style="width:50%;display:inline-block;" data-width="50%"><section style="padding: 15px; text-align: center; box-sizing: border-box;"><p style="clear:none;margin:0 0;line-height:1.5em;"><span style="font-size: 14px;" data-brushtype="text">菜菜哥，我看了一下docker相关的内容，但是还是有点迷糊</span></p><section><section style="display:inline-block;width:16px;"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程0.png" data-ratio="1.75"  alt="" /></section></section><section><section style="width: 100px;display:inline-block;"><span data-role="width" style="display:inline-block;width:100px"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程1.png" style="margin: 0px 0px 15px; height: auto !important; width: 100px !important;" width="100" height="auto" border="0" mapurl="" title="张嘴女人.gif" alt="张嘴女人.gif" data-op="change" data-ratio="1.44" /></span></section></section></section></section><section style="width:50%;display:inline-block;" data-width="50%"><section style="padding: 15px; text-align: center; box-sizing: border-box;"><p style="clear:none;line-height:1.5em;"><span style="font-size: 14px;" data-brushtype="text">还有哪不明白呢？</span></p><section><section style="display:inline-block;width:16px;"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程2.png" data-ratio="1.75"  alt="" /></section></section><section><section style="width: 100px;display:inline-block;"><span data-role="width" style="display:inline-block;width:100px"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程3.png" style="margin: 0px 0px 15px; height: auto !important; width: 100px !important;" width="100" height="auto" border="0" mapurl="" title="张嘴男人.gif" alt="张嘴男人.gif" data-op="change" data-ratio="1.33" /></span></section></section></section></section></section></section><section data-tools="135编辑器" data-id="86375" style="border: 0px none; box-sizing: border-box;"><section style="margin-top:5px;"><section style="width:50%;display:inline-block;" data-width="50%"><section style="padding: 15px; text-align: center; box-sizing: border-box;"><p style="clear:none;margin:0 0;line-height:1.5em;"><span style="font-size: 14px;" data-brushtype="text">如果我想用docker实现所谓的云原生，我的项目该怎么发布呢？</span></p><section><section style="display:inline-block;width:16px;"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程0.png" data-ratio="1.75"  alt="" /></section></section><section><section style="width: 100px;display:inline-block;"><span data-role="width" style="display:inline-block;width:100px"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程1.png" style="margin: 0px 0px 15px; height: auto !important; width: 100px !important;" width="100" height="auto" border="0" mapurl="" title="张嘴女人.gif" alt="张嘴女人.gif" data-op="change" data-ratio="1.44" /></span></section></section></section></section><section style="width:50%;display:inline-block;" data-width="50%"><section style="padding: 15px; text-align: center; box-sizing: border-box;"><p style="clear:none;line-height:1.5em;"><span style="font-size: 14px;" data-brushtype="text">这还是要详细介绍一下docker了</span></p><section><section style="display:inline-block;width:16px;"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程2.png" data-ratio="1.75"  alt="" /></section></section><section><section style="width: 100px;display:inline-block;"><span data-role="width" style="display:inline-block;width:100px"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程3.png" style="margin: 0px 0px 15px; height: auto !important; width: 100px !important;" width="100" height="auto" border="0" mapurl="" title="张嘴男人.gif" alt="张嘴男人.gif" data-op="change" data-ratio="1.33" /></span></section></section></section></section></section></section><section data-tools="135编辑器" data-id="93073"><section><section style="width: 40px;margin-bottom:5px;display:flex;margin-left:85%;"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程8.png" alt="" data-ratio="0.175" /></section><section style="width: 90%; margin-left: 5%; margin-bottom: 10px; padding: 5px 0px; font-size: 14px; letter-spacing: 1.5px; line-height: 2em; color: #3f3f3f; box-sizing: border-box;" data-width="90%"><p>Docker 是一个开源的应用容器引擎，基于 Go 语言 并遵从 Apache2.0 协议开源。Docker 可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。</p><p>容器是完全使用沙箱机制，相互之间不会有任何接口（类似 iPhone 的 app）,更重要的是容器性能开销极低。Docker 从 17.03 版本之后分为 CE（Community Edition: 社区版） 和 EE（Enterprise Edition: 企业版），我们用社区版就可以了。</p><p>正如以上所说，Docker诞生的意义不仅仅实现了类似虚拟机的隔离性，最主要的是它可以把应用程序以及应用程序的运行环境整个打包在一起。注意：是整个环境哦，不仅仅是一些依赖库。这个划时代的进步，直接把docker镜像和宿主分离开来，使得docker镜像只要公布出来，就能使任何人在任何地方任何时间都可以随意运行，换句话说，docker镜像可以被分发到任何运行docker的服务器上。</p></section></section></section><section data-tools="135编辑器" data-id="86375" style="border: 0px none; box-sizing: border-box;"><section style="margin-top:5px;"><section style="width:50%;display:inline-block;" data-width="50%"><section style="padding: 15px; text-align: center; box-sizing: border-box;"><p style="clear:none;margin:0 0;line-height:1.5em;"><span style="font-size: 14px;" data-brushtype="text">说重点，架构呢？</span></p><section><section style="display:inline-block;width:16px;"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程0.png" data-ratio="1.75"  alt="" /></section></section><section><section style="width: 100px;display:inline-block;"><span data-role="width" style="display:inline-block;width:100px"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程1.png" style="margin: 0px 0px 15px; height: auto !important; width: 100px !important;" width="100" height="auto" border="0" mapurl="" title="张嘴女人.gif" alt="张嘴女人.gif" data-op="change" data-ratio="1.44" /></span></section></section></section></section><section style="width:50%;display:inline-block;" data-width="50%"><section style="padding: 15px; text-align: center; box-sizing: border-box;"><p style="clear:none;line-height:1.5em;"><span style="font-size: 14px;" data-brushtype="text">看你心急的和猴一样....</span></p><section><section style="display:inline-block;width:16px;"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程2.png" data-ratio="1.75"  alt="" /></section></section><section><section style="width: 100px;display:inline-block;"><span data-role="width" style="display:inline-block;width:100px"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程3.png" style="margin: 0px 0px 15px; height: auto !important; width: 100px !important;" width="100" height="auto" border="0" mapurl="" title="张嘴男人.gif" alt="张嘴男人.gif" data-op="change" data-ratio="1.33" /></span></section></section></section></section></section></section><section data-tools="135编辑器" data-id="96391"><section style="margin:15px auto;"><section style="text-align: center; font-size: 25px; letter-spacing: 2px; line-height: 1; padding: 0px; color: #ffffff; margin-top: -7px; margin-left: 4px; box-sizing: border-box;"><p><span style="text-shadow: #000000 1px 1px 0px, #000000 1px -1px 0px, #000000 -1px 1px 0px, #000000 -1px -1px 0px, #000000 0px 1.4px 0px, #000000 0px -1.4px 0px, #000000 -1.4px 0px 0px, #000000 1.4px 0px 0px, #e9be29 0px 3px 0px, #000000 1px 4px 0px, #000000 1px 2px 0px, #000000 -1px 4px 0px, #000000 -1px 2px 0px, #000000 0px 4.4px 0px, #000000 0px 1.6px 0px, #000000 -1.4px 3px 0px, #000000 1.4px 3px 0px;"><strong>Docker 架构</strong></span></p></section></section></section><section data-tools="135编辑器" data-id="93073"><section><section style="width: 40px;margin-bottom:5px;display:flex;margin-left:85%;"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程8.png" alt="" data-ratio="0.175" /></section><section style="width: 90%; margin-left: 5%; margin-bottom: 10px; padding: 5px 0px; font-size: 14px; letter-spacing: 1.5px; line-height: 2em; color: #3f3f3f; box-sizing: border-box;" data-width="90%"><p>在docker的架构中，主要有三个主要概念：</p></section></section></section><section data-tools="135编辑器" data-id="93408"><section style="text-align: center;margin: 15px 0% 10px;box-sizing: border-box;"><section style="display: inline-block;width: 90%;vertical-align: top;box-sizing: border-box;" data-width="90%"><section style="margin: 10px 0%;box-sizing: border-box;"><section style="display: inline-block;width: 100%;border-width: 0px 0px 0px 10px;border-style: solid;border-left-color: #f1d86d;border-right-color: #f1d86d;box-sizing: border-box;" data-width="100%"><section style="margin-right: 0%;margin-left: 0%;padding-right: 3px;padding-left: 3px;text-align: left;box-sizing: border-box;"><section style="display: inline-block;width: 100%;vertical-align: top;margin-bottom: -0.65em;margin-top: 0.95em;box-sizing: border-box;" data-width="100%"><section style="width: 100%;box-sizing: border-box;" data-width="100%"><section style="border-top: 1px solid #f1d86d;width: 99.9%;float: left;box-sizing: border-box;" data-width="99.9%"></section><section style="width: 6px;height: 6px;margin-top: -3px;border-radius: 100%;float: right;background-color: #ffdf6f;box-sizing: border-box;"></section></section><section style="display: inline-block; margin-top: -1em; vertical-align: top; background-color: #ffffff; padding: 3px 10px; color: #3f3f3f; box-sizing: border-box;" data-brushtype="text"><p style="box-sizing: border-box;">镜像</p></section></section></section></section></section></section></section></section><section data-tools="135编辑器" data-id="93073"><section><section style="width: 40px;margin-bottom:5px;display:flex;margin-left:85%;"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程8.png" alt="" data-ratio="0.175" /></section><section style="width: 90%; margin-left: 5%; margin-bottom: 10px; padding: 5px 0px; font-size: 14px; letter-spacing: 1.5px; line-height: 2em; color: #3f3f3f; box-sizing: border-box;" data-width="90%"><p>Docker 镜像可以看作是一个特殊的文件系统，除了提供容器运行时所需的程序、库、资源、配置等文件外，还包含了一些为运行时准备的一些配置参数（如匿名卷、环境变量、用户等）。镜像不包含任何动态数据，其内容在构建之后也不会被改变。</p><p>docker镜像由多层组成，不同的镜像都能使用相同的父镜像作为他们的基础镜像，这些相同的基础镜像在docker的角度来看就是完全相同的层。在docker镜像的传输过程中，当某些相同的层已经存在的时候，就完全不需要重新传输了，这大大提高了镜像在网络上的传输效率。</p><p>分层的设计不仅使镜像分发更高效，也有利于减少镜像的存储空间。每一层仅仅被存储一次，就算基于相同基础层的镜像被创建两个容器的时候，这两个容器也是互相隔离的，虽然他们能读到相同的文件，但是却看不到对方文件的修改。一个容器被创建的时候，会创建一个新的可写层，容器中的修改会反应到这个新的可写层中。就算了容器修改了底层的文件，此文件的修改内容会copy到顶层，底层依然不会发生变化。</p></section></section></section><section data-tools="135编辑器" data-id="93408"><section style="text-align: center;margin: 15px 0% 10px;box-sizing: border-box;"><section style="display: inline-block;width: 90%;vertical-align: top;box-sizing: border-box;" data-width="90%"><section style="margin: 10px 0%;box-sizing: border-box;"><section style="display: inline-block;width: 100%;border-width: 0px 0px 0px 10px;border-style: solid;border-left-color: #f1d86d;border-right-color: #f1d86d;box-sizing: border-box;" data-width="100%"><section style="margin-right: 0%;margin-left: 0%;padding-right: 3px;padding-left: 3px;text-align: left;box-sizing: border-box;"><section style="display: inline-block;width: 100%;vertical-align: top;margin-bottom: -0.65em;margin-top: 0.95em;box-sizing: border-box;" data-width="100%"><section style="width: 100%;box-sizing: border-box;" data-width="100%"><section style="border-top: 1px solid #f1d86d;width: 99.9%;float: left;box-sizing: border-box;" data-width="99.9%"></section><section style="width: 6px;height: 6px;margin-top: -3px;border-radius: 100%;float: right;background-color: #ffdf6f;box-sizing: border-box;"></section></section><section style="display: inline-block; margin-top: -1em; vertical-align: top; background-color: #ffffff; padding: 3px 10px; color: #3f3f3f; box-sizing: border-box;" data-brushtype="text"><p style="box-sizing: border-box;">容器</p></section></section></section></section></section></section></section></section><section data-tools="135编辑器" data-id="93073"><section><section style="width: 40px;margin-bottom:5px;display:flex;margin-left:85%;"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程8.png" alt="" data-ratio="0.175" /></section><section style="width: 90%; margin-left: 5%; margin-bottom: 10px; padding: 5px 0px; font-size: 14px; letter-spacing: 1.5px; line-height: 2em; color: #3f3f3f; box-sizing: border-box;" data-width="90%"><p>镜像（Image）和容器（Container）的关系，就像是面向对象程序设计中的类和实例一样，镜像是静态的定义，容器是镜像运行时的实体。容器可以被创建、启动、停止、删除、暂停等。docker的容器通常是一个linux容器，它是运行在宿主机上的一个进程，但是和其他宿主进程是隔离的，并且所用的资源是受限的（只能访问特定的资源，比如网络接口，文件系统）</p></section></section></section><section data-tools="135编辑器" data-id="93408"><section style="text-align: center;margin: 15px 0% 10px;box-sizing: border-box;"><section style="display: inline-block;width: 90%;vertical-align: top;box-sizing: border-box;" data-width="90%"><section style="margin: 10px 0%;box-sizing: border-box;"><section style="display: inline-block;width: 100%;border-width: 0px 0px 0px 10px;border-style: solid;border-left-color: #f1d86d;border-right-color: #f1d86d;box-sizing: border-box;" data-width="100%"><section style="margin-right: 0%;margin-left: 0%;padding-right: 3px;padding-left: 3px;text-align: left;box-sizing: border-box;"><section style="display: inline-block;width: 100%;vertical-align: top;margin-bottom: -0.65em;margin-top: 0.95em;box-sizing: border-box;" data-width="100%"><section style="width: 100%;box-sizing: border-box;" data-width="100%"><section style="border-top: 1px solid #f1d86d;width: 99.9%;float: left;box-sizing: border-box;" data-width="99.9%"></section><section style="width: 6px;height: 6px;margin-top: -3px;border-radius: 100%;float: right;background-color: #ffdf6f;box-sizing: border-box;"></section></section><section style="display: inline-block; margin-top: -1em; vertical-align: top; background-color: #ffffff; padding: 3px 10px; color: #3f3f3f; box-sizing: border-box;" data-brushtype="text"><p style="box-sizing: border-box;">镜像仓库</p></section></section></section></section></section></section></section></section><section data-tools="135编辑器" data-id="93073"><section><section style="width: 40px;margin-bottom:5px;display:flex;margin-left:85%;"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程8.png" alt="" data-ratio="0.175" /></section><section style="width: 90%; margin-left: 5%; margin-bottom: 10px; padding: 5px 0px; font-size: 14px; letter-spacing: 1.5px; line-height: 2em; color: #3f3f3f; box-sizing: border-box;" data-width="90%"><p>镜像仓库和它的字面意思一致，是很多镜像的集合，它的作用就是把镜像共享给每个人，当然这里顺便提一下，镜像仓库也可以有私人仓库。当你的应用程序被打包之后，如果想在另外一个机器上运行，你就可以把你的应用镜像上传到镜像仓库，然后开放这个仓库，这样网络上的任何机器都能够下载你的镜像，然后运行。</p><p>通常，一个仓库会包含同一个软件不同版本的镜像，而标签就常用于对应该软件的各个版本 。我们可以通过&lt;仓库名&gt;:&lt;标签&gt;的格式来指定具体是这个软件哪个版本的镜像。如果不给出标签，将以 latest 作为默认标签.。</p><p>仓库又可以分为两种形式：</p><p>public(公有仓库)</p><p>private(私有仓库)</p><p>Docker Registry 公有仓库是开放给用户使用、允许用户管理镜像的 Registry 服务。一般这类公开服务允许用户免费上传、下载公开的镜像，并可能提供收费服务供用户管理私有镜像。</p><p>除了使用公开服务外，用户还可以在本地搭建私有 Docker Registry 。Docker 官方提供了 Docker Registry镜像，可以直接使用做为私有 Registry 服务。当用户创建了自己的镜像之后就可以使用 push 命令将它上传到公有或者私有仓库，这样下次在另外一台机器上使用这个镜像时候，只需要从仓库上 pull 下来就可以了。</p></section></section></section><section data-tools="135编辑器" data-id="93408"><section style="text-align: center;margin: 15px 0% 10px;box-sizing: border-box;"><section style="display: inline-block;width: 90%;vertical-align: top;box-sizing: border-box;" data-width="90%"><section style="margin: 10px 0%;box-sizing: border-box;"><section style="display: inline-block;width: 100%;border-width: 0px 0px 0px 10px;border-style: solid;border-left-color: #f1d86d;border-right-color: #f1d86d;box-sizing: border-box;" data-width="100%"><section style="margin-right: 0%;margin-left: 0%;padding-right: 3px;padding-left: 3px;text-align: left;box-sizing: border-box;"><section style="display: inline-block;width: 100%;vertical-align: top;margin-bottom: -0.65em;margin-top: 0.95em;box-sizing: border-box;" data-width="100%"><section style="width: 100%;box-sizing: border-box;" data-width="100%"><section style="border-top: 1px solid #f1d86d;width: 99.9%;float: left;box-sizing: border-box;" data-width="99.9%"></section><section style="width: 6px;height: 6px;margin-top: -3px;border-radius: 100%;float: right;background-color: #ffdf6f;box-sizing: border-box;"></section></section><section style="display: inline-block; margin-top: -1em; vertical-align: top; background-color: #ffffff; padding: 3px 10px; color: #3f3f3f; box-sizing: border-box;" data-brushtype="text"><p style="box-sizing: border-box;">构建分发运行镜像</p></section></section></section></section></section></section></section></section><section data-tools="135编辑器" data-id="93073"><section><section style="width: 40px;margin-bottom:5px;display:flex;margin-left:85%;"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程8.png" alt="" data-ratio="0.175" /></section><section style="width: 90%; margin-left: 5%; margin-bottom: 10px; padding: 5px 0px; font-size: 14px; letter-spacing: 1.5px; line-height: 2em; color: #3f3f3f; box-sizing: border-box;" data-width="90%"><p>开发人员首先构建一个镜像，然后把镜像推到镜像仓库中。因此，任何可以访问镜像仓库的人都可以使用该镜像。然后，他们可以将镜像拉取到任何运行着Docker的机器上并运行镜像。Docker会基于镜像创建一个独立的容器，并运行二进制可执行文件指定其作为镜像的一部分。</p></section></section></section><section data-role="paragraph"><p style="text-align:center;" align="center"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程18.png" data-ratio="1"  alt="" /></p><p><br /></p></section><section data-tools="135编辑器" data-id="93408"><section style="text-align: center;margin: 15px 0% 10px;box-sizing: border-box;"><section style="display: inline-block;width: 90%;vertical-align: top;box-sizing: border-box;" data-width="90%"><section style="margin: 10px 0%;box-sizing: border-box;"><section style="display: inline-block;width: 100%;border-width: 0px 0px 0px 10px;border-style: solid;border-left-color: #f1d86d;border-right-color: #f1d86d;box-sizing: border-box;" data-width="100%"><section style="margin-right: 0%;margin-left: 0%;padding-right: 3px;padding-left: 3px;text-align: left;box-sizing: border-box;"><section style="display: inline-block;width: 100%;vertical-align: top;margin-bottom: -0.65em;margin-top: 0.95em;box-sizing: border-box;" data-width="100%"><section style="width: 100%;box-sizing: border-box;" data-width="100%"><section style="border-top: 1px solid #f1d86d;width: 99.9%;float: left;box-sizing: border-box;" data-width="99.9%"></section><section style="width: 6px;height: 6px;margin-top: -3px;border-radius: 100%;float: right;background-color: #ffdf6f;box-sizing: border-box;"></section></section><section style="display: inline-block; margin-top: -1em; vertical-align: top; background-color: #ffffff; padding: 3px 10px; color: #3f3f3f; box-sizing: border-box;" data-brushtype="text"><p style="box-sizing: border-box;">docker的缺陷</p></section></section></section></section></section></section></section></section><section data-tools="135编辑器" data-id="93073"><section><section style="width: 40px;margin-bottom:5px;display:flex;margin-left:85%;"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程8.png" alt="" data-ratio="0.175" /></section><section style="width: 90%; margin-left: 5%; margin-bottom: 10px; padding: 5px 0px; font-size: 14px; letter-spacing: 1.5px; line-height: 2em; color: #3f3f3f; box-sizing: border-box;" data-width="90%"><p>就像所有的技术解决方案，docker也不是完美的。docker的缺陷在于运行的内核，由于它直接运行在宿主机的内核之上，所以如果docker容器的运行内核版本和宿主机的内核不匹配就会出现问题。追根到底，还是硬件架构设计上的差异，不仅仅是docker容器，几乎所有的软件都会有内核架构不同而不能运行的问题。除此之外，由于docker是基于linux的容器技术，所以在windows下运行并不令人满意，虽然这些年docker在windows上也进步了很多。</p></section></section></section><section data-tools="135编辑器" data-id="86375" style="border: 0px none; box-sizing: border-box;"><section style="margin-top:5px;"><section style="width:50%;display:inline-block;" data-width="50%"><section style="padding: 15px; text-align: center; box-sizing: border-box;"><p style="clear:none;margin:0 0;line-height:1.5em;"><span style="font-size: 14px;" data-brushtype="text">来一个具体发布流程的例子呗？</span></p><section><section style="display:inline-block;width:16px;"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程0.png" data-ratio="1.75"  alt="" /></section></section><section><section style="width: 100px;display:inline-block;"><span data-role="width" style="display:inline-block;width:100px"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程1.png" style="margin: 0px 0px 15px; height: auto !important; width: 100px !important;" width="100" height="auto" border="0" mapurl="" title="张嘴女人.gif" alt="张嘴女人.gif" data-op="change" data-ratio="1.44" /></span></section></section></section></section><section style="width:50%;display:inline-block;" data-width="50%"><section style="padding: 15px; text-align: center; box-sizing: border-box;"><p style="clear:none;line-height:1.5em;"><span style="font-size: 14px;" data-brushtype="text">可以呀，那我就以netcore为例吧</span></p><section><section style="display:inline-block;width:16px;"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程2.png" data-ratio="1.75"  alt="" /></section></section><section><section style="width: 100px;display:inline-block;"><span data-role="width" style="display:inline-block;width:100px"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程3.png" style="margin: 0px 0px 15px; height: auto !important; width: 100px !important;" width="100" height="auto" border="0" mapurl="" title="张嘴男人.gif" alt="张嘴男人.gif" data-op="change" data-ratio="1.33" /></span></section></section></section></section></section></section><section data-tools="135编辑器" data-id="96391"><section style="margin:15px auto;"><section style="text-align: center; font-size: 25px; letter-spacing: 2px; line-height: 1; padding: 0px; color: #ffffff; margin-top: -7px; margin-left: 4px; box-sizing: border-box;"><p><span style="text-shadow: #000000 1px 1px 0px, #000000 1px -1px 0px, #000000 -1px 1px 0px, #000000 -1px -1px 0px, #000000 0px 1.4px 0px, #000000 0px -1.4px 0px, #000000 -1.4px 0px 0px, #000000 1.4px 0px 0px, #e9be29 0px 3px 0px, #000000 1px 4px 0px, #000000 1px 2px 0px, #000000 -1px 4px 0px, #000000 -1px 2px 0px, #000000 0px 4.4px 0px, #000000 0px 1.6px 0px, #000000 -1.4px 3px 0px, #000000 1.4px 3px 0px;"><strong>docker镜像发布</strong></span></p></section></section></section><section data-tools="135编辑器" data-id="93073"><section><section style="width: 40px;margin-bottom:5px;display:flex;margin-left:85%;"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程8.png" alt="" data-ratio="0.175" /></section><section style="width: 90%; margin-left: 5%; margin-bottom: 10px; padding: 5px 0px; font-size: 14px; letter-spacing: 1.5px; line-height: 2em; color: #3f3f3f; box-sizing: border-box;" data-width="90%"><p>docker镜像的仓库有很多，这里以官方网站https://hub.docker.com/ 为例，首先你要在官网创建一个账号，然后可以在Account Settings=》Security中设置一个AccessToken ，这里为了演示，没有在官网显示创建仓库。因为我是本身是C#出身，这里利用vs2019来做演示。</p><p>打开vs2019新建一个netcore的项目，我这里创建一个控制台程序，程序很简单</p></section></section></section><section data-role="paragraph"><section id="output_wrapper_id" style="font-size: 16px; color: #3e3e3e; line-height: 1.6; letter-spacing: 0px; font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><pre><code><code><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;"><span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #fcc28c; word-wrap: inherit !important; word-break: inherit !important;">static</span>&nbsp;<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #fcc28c; word-wrap: inherit !important; word-break: inherit !important;">void</span>&nbsp;<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #ffffaa; word-wrap: inherit !important; word-break: inherit !important;">Main</span><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">(<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #ffffaa; word-wrap: inherit !important; word-break: inherit !important;">string</span>[]&nbsp;args)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #a2fca2; word-wrap: inherit !important; word-break: inherit !important;">"Hello&nbsp;World!"</span>);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #fcc28c; word-wrap: inherit !important; word-break: inherit !important;">while</span>&nbsp;(<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #fcc28c; word-wrap: inherit !important; word-break: inherit !important;">true</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #a2fca2; word-wrap: inherit !important; word-break: inherit !important;">"Hello&nbsp;World22222!"</span>);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Threading.Thread.Sleep(<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #d36363; word-wrap: inherit !important; word-break: inherit !important;">1000</span>);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</code></pre></section></section><section data-tools="135编辑器" data-id="93073"><section><section style="width: 40px;margin-bottom:5px;display:flex;margin-left:85%;"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程8.png" alt="" data-ratio="0.175" /></section><section style="width: 90%; margin-left: 5%; margin-bottom: 10px; padding: 5px 0px; font-size: 14px; letter-spacing: 1.5px; line-height: 2em; color: #3f3f3f; box-sizing: border-box;" data-width="90%"><p>然后在项目右键 添加=》docker支持，会根据当前项目自动生成dockerfile文件。就算没有ide的支持，也可以自己手撸一个dockerfile文件，然后利用docker的命令打包，当然语法和以下是一样的</p><section id="output_wrapper_id" style="font-size: 16px; color: #3e3e3e; line-height: 1.6; letter-spacing: 0px; font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><pre><code><code sql"="" style="margin: 0px 2px; line-height: 18px; font-size: 14px; letter-spacing: 0px; border-radius: 0px; padding: 0.5em; background: #333333; color: white; font-family: Consolas, Inconsolata, Courier, monospace; overflow-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;">FROM&nbsp;mcr.microsoft.com/dotnet/core/runtime:3.0-buster-slim&nbsp;AS&nbsp;base<br />WORKDIR&nbsp;/app<br /><br />FROM&nbsp;mcr.microsoft.com/dotnet/core/sdk:3.0-buster&nbsp;AS&nbsp;build<br />WORKDIR&nbsp;/src<br />COPY&nbsp;["netcoretest/netcoretest.csproj",&nbsp;"netcoretest/"]<br />RUN&nbsp;dotnet&nbsp;<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #fcc28c; word-wrap: inherit !important; word-break: inherit !important;">restore</span>&nbsp;<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #a2fca2; word-wrap: inherit !important; word-break: inherit !important;">"netcoretest/netcoretest.csproj"</span><br />COPY&nbsp;.&nbsp;.<br />WORKDIR&nbsp;<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #a2fca2; word-wrap: inherit !important; word-break: inherit !important;">"/src/netcoretest"</span><br />RUN&nbsp;<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #fcc28c; word-wrap: inherit !important; word-break: inherit !important;">dotnet</span>&nbsp;<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #fcc28c; word-wrap: inherit !important; word-break: inherit !important;">build</span>&nbsp;<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #a2fca2; word-wrap: inherit !important; word-break: inherit !important;">"netcoretest.csproj"</span>&nbsp;-c&nbsp;<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #fcc28c; word-wrap: inherit !important; word-break: inherit !important;">Release</span>&nbsp;-o&nbsp;/app/<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #fcc28c; word-wrap: inherit !important; word-break: inherit !important;">build</span><br /><br /><span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #fcc28c; word-wrap: inherit !important; word-break: inherit !important;">FROM</span>&nbsp;<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #fcc28c; word-wrap: inherit !important; word-break: inherit !important;">build</span>&nbsp;<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #fcc28c; word-wrap: inherit !important; word-break: inherit !important;">AS</span>&nbsp;publish<br />RUN&nbsp;<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #fcc28c; word-wrap: inherit !important; word-break: inherit !important;">dotnet</span>&nbsp;publish&nbsp;<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #a2fca2; word-wrap: inherit !important; word-break: inherit !important;">"netcoretest.csproj"</span>&nbsp;-c&nbsp;<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #fcc28c; word-wrap: inherit !important; word-break: inherit !important;">Release</span>&nbsp;-o&nbsp;/app/publish<br /><br /><span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #fcc28c; word-wrap: inherit !important; word-break: inherit !important;">FROM</span>&nbsp;base&nbsp;<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #fcc28c; word-wrap: inherit !important; word-break: inherit !important;">AS</span>&nbsp;<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #fcc28c; word-wrap: inherit !important; word-break: inherit !important;">final</span><br />WORKDIR&nbsp;/app<br />COPY&nbsp;<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #888888; word-wrap: inherit !important; word-break: inherit !important;">--from=publish&nbsp;/app/publish&nbsp;.</span><br />ENTRYPOINT&nbsp;[<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #a2fca2; word-wrap: inherit !important; word-break: inherit !important;">"dotnet"</span>,&nbsp;<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #a2fca2; word-wrap: inherit !important; word-break: inherit !important;">"netcoretest.dll"</span>]<br /></code></pre></section><p><br /></p><p>然后项目右键 发布=》容器注册表=》docker hub 创建发布选项，会弹出输入docker hub账号密码弹窗，然后输入账号密码，最后点击发布按钮，本地必须要安装docker哦，我这里为了演示，在windows上安装的docker for windows。和以上类似，就算没有ide的支持，我们一样可以利用docker命令把镜像推送到指定仓库。这里只是演示流程，所以不要纠结。</p><p style="text-align:center;" align="center"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程26.png" data-ratio="1"  alt="" /></p><p>如果环境没有错误的话，发布过程中会弹出黑窗口</p><p style="text-align:center;" align="center"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程27.png" data-ratio="1"  alt="" /></p><p>发布完成，在docker hub中刷新页面回发现新仓库已经被创建好了</p><p style="text-align:center;" align="center"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程28.png" data-ratio="1"  alt="" /></p><p>接下来就是在装有docker的机器上，拉取进行并运行容器了，这里以我本地windows 和测试服务器linux为例，分别演示，但是其实在两个操作系统中命令是一模一样的</p><section id="output_wrapper_id" style="font-size: 16px; color: #3e3e3e; line-height: 1.6; letter-spacing: 0px; font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><pre><code><code nginx"="" style="margin: 0px 2px; line-height: 18px; font-size: 14px; letter-spacing: 0px; border-radius: 0px; padding: 0.5em; background: #333333; color: white; font-family: Consolas, Inconsolata, Courier, monospace; overflow-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;"><span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #ffffaa; word-wrap: inherit !important; word-break: inherit !important;">docker</span>&nbsp;run&nbsp;chenhongyu/netcoretest<br /></code></pre></section><p>无论是在windows上还是在linux上，容器成功被拉取运行</p><p style="text-align:center;" align="center"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程29.png" data-ratio="0.33014354066985646"  alt="" /></p><p style="text-align:center;" align="center"><img src="./images/程序员修神之路--打通Docker镜像发布容器运行流程30.png" data-ratio="1"  alt="" /></p><p>虽然只是一个小小的测试程序，确把业务程序之外的最大云原生流程撸了一遍，希望对大家有帮助。大家可以拉取以下镜像是否可以运行呢？</p></section></section></section><section data-role="paragraph"><p><br /></p></section></section></section></section>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>